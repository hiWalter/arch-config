"use strict";(self.webpackChunknotion_next=self.webpackChunknotion_next||[]).push([[8],{56877:(e,t,i)=>{i.r(t),i.d(t,{default:()=>f});var o=i(98135),n=i.n(o),s=i(59713),r=i.n(s),a=(i(33948),i(67294)),l=i.n(a),d=i(62727),c=i(33846),h=i(66832),p=i(3779),u=i(24677),m=i(98104),g=i(56109),b=i(87953),v=i(41101),y=i(5366);class S extends h.Z{constructor(...e){super(...e),r()(this,"storeTypes",{store:c.Z}),r()(this,"handleFocused",(()=>{u.ZH(this.environment),m.ZH(this.environment),this.stores.store.setState({...this.stores.store.state,focus:!0})})),r()(this,"handleBlurred",(()=>{this.stores.store.setState({...this.stores.store.state,focus:!1})})),r()(this,"handleSearchQueryChange",(e=>{this.props.onChange({searchQuery:e.target.value})}))}renderComponent(){const{searchQuery:e,intl:t}=this.props,{focus:i}=this.stores.store.state;return n()(g.Z,{capture:i},void 0,n()(b.Z,{capture:!0,render:o=>l().createElement("div",o,n()(d.Z,{style:this.getStyle(),format:d.B.Transparent,value:e,placeholder:t.formatMessage({defaultMessage:"Type to search…",id:"database.mobileSearch.placeholder"}),onChange:this.handleSearchQueryChange,autoComplete:"on",autoCorrect:"on",onFocus:this.handleFocused,onBlur:this.handleBlurred,showClearButton:!0,left:p.Z.searchThick(this.getSearchIconStyle())}),n()(v.Z,{show:i}))}))}getStyle(){return{boxShadow:this.theme.inputBoxShadow,background:this.theme.inputBackground,flexGrow:0,flexShrink:0,height:32,paddingLeft:8,paddingRight:12,borderRadius:3,fontSize:14,marginBottom:4}}getSearchIconStyle(){return{width:14,height:14,marginRight:6,flexGrow:0,flexShrink:0,fill:this.theme.mediumIconColor}}}const f=(0,y.XN)(S)},44299:(e,t,i)=>{i.r(t),i.d(t,{default:()=>q});var o=i(67154),n=i.n(o),s=i(98135),r=i.n(s),a=i(59713),l=i.n(a),d=(i(33948),i(67294)),c=i.n(d),h=i(96486),p=i.n(h),u=i(3779),m=i(44886),g=i(60165),b=i(24677),v=i(50906),y=i(82990),S=i(66832),f=i(40464),M=i(73383),Z=i(82945),k=i(16961),T=i(98104),w=i(39302),C=i(80935),I=i(27724),B=i(24666),x=i(68056),P=i(17903),A=i(14947),R=i(64131),_=i(5366),L=i(32404),U=i(17215),O=i(72653),H=i(85394),F=i(52533),E=i(67074),D=i(74350),N=i(69454),V=i(59488);class W extends S.Z{constructor(...e){super(...e),l()(this,"scrollerDiv",void 0),l()(this,"currentlyShownTimer",void 0),l()(this,"previouslyShownOnNative",!1),l()(this,"handleScrollerRef",(e=>{e&&(this.scrollerDiv=e)})),l()(this,"handleUnindent",(e=>{E.$$(this.environment)})),l()(this,"handleIndent",(e=>{E.O2(this.environment)})),l()(this,"handleMoveUp",(e=>{E.s0(this.environment)})),l()(this,"handleMoveDown",(e=>{E.rZ(this.environment)})),l()(this,"handleUndo",(()=>{E.i2(this.environment)})),l()(this,"handleRedo",(()=>{E.GH(this.environment)})),l()(this,"handleDismissKeyboard",(e=>{b.ZH(this.environment),this.props.stores.store.setState({...this.props.stores.store.state,isInsertOpen:!1}),this.trackItemTap("hide_keyboard"),T.sD()})),l()(this,"handleInsert",(e=>{this.props.stores.store.setState({...this.props.stores.store.state,isInsertOpen:!0}),this.trackItemTap("insert")})),l()(this,"handleTakePicture",(e=>{E.vs(this.environment)})),l()(this,"handleMention",(e=>{E.Z3(this.environment)})),l()(this,"handleComment",(e=>{E.ol(this.environment,!1)})),l()(this,"handleDelete",(e=>{E.fn(this.environment)})),l()(this,"handleActionsScroll",(()=>{v.FGU(this.environment)})),l()(this,"handleActionsScrollDebounced",p().debounce(this.handleActionsScroll,500)),l()(this,"handleMoreClick",(e=>{E.w1(this.environment,e.clientX,e.clientY)})),l()(this,"listenForPositionChanges",this.createComputedStore((()=>{const e=B.Z.state;if("editing"===e.mode){const t=e.multiSelection.end;return{scrollTop:P.Z.state.scrollTop,editing:!0,store:t.store.id,selection:t}}return{scrollTop:P.Z.state.scrollTop,editing:!1}}))),l()(this,"renderStore",this.createComputedStore((()=>{var e;return E.$3(this.environment,this.props.currentBlockStore,null===(e=this.pageContext)||void 0===e?void 0:e.publicEditModeStore.state)}))),l()(this,"shouldShowTextActions",this.createComputedStore((()=>E.oQ(this.props.stores.ignoreSelectionAreaStore,this.environment.TextSelectionCompositionStore)))),l()(this,"shouldShowBlockActions",this.createComputedStore((()=>!this.shouldShowTextActions.state))),l()(this,"canTriggerBlockActions",this.createComputedStore((()=>!!this.shouldShowBlockActions.state&&E.Bo(this.pageContext&&this.pageContext.publicEditModeStore.state)))),l()(this,"canTriggerTextActions",this.createComputedStore((()=>E.eQ(this.pageContext&&this.pageContext.publicEditModeStore.state,this.props.currentBlockStore)))),l()(this,"hasMultiBlockSelection",this.createComputedStore((()=>{const e=B.Z.state;return"editing"===e.mode&&!(0,x.qS)(e.multiSelection)})))}willMountOrUpdate(){const{device:e}=this.environment,t=this.renderStore.state.shouldShow;if(e.isMobileBrowser){const e=this.props.stores.store.state.isOpen;t?e?void 0!==this.currentlyShownTimer&&(window.clearTimeout(this.currentlyShownTimer),this.currentlyShownTimer=void 0):(this.props.stores.store.setState({...this.props.stores.store.state,isOpen:!0}),this.scrollerDiv&&(this.scrollerDiv.scrollLeft=0)):e&&void 0===this.currentlyShownTimer&&(this.currentlyShownTimer=window.setTimeout((()=>{this.currentlyShownTimer=void 0,this.props.stores.store.setState({...this.props.stores.store.state,isOpen:!1})}),200))}else t!==this.previouslyShownOnNative&&(this.previouslyShownOnNative=t,this.scrollerDiv&&(this.scrollerDiv.scrollLeft=0))}renderComponent(){const{device:e,WindowSizeStore:t}=this.environment,i=this.isOpen(),o=e.isMobile&&O.Z.state;if(this.props.position===F.n.Bottom){let e=0;return(0,V.de)()?e=N.Z.estimatedKeyboardWebViewOverlap():o&&(e=t.getSafePaddingBottomCSS(H.default.height)),r()("div",{style:{position:"absolute",bottom:e,left:0,height:W.height,width:"100%",pointerEvents:i?"auto":"none",opacity:i?1:0,transform:i?"translateY(0)":"translateY(".concat(W.height,"px)"),transition:"opacity 120ms ease-out, transform 120ms ease-out"}},void 0,this.renderActionButtons())}{this.listenForPositionChanges.state;const e=this.props.stores.ignoreSelectionAreaStore.state.savedTextSelectionRect||C.TJ();if(!e)return;const t=document.body.getBoundingClientRect(),o={...e,left:10,top:e.top+10-t.top},{device:n}=this.environment;return r()(w.ZP,{popupType:n.isMobileNative?w.ZP.PopupType.SlideUp:w.ZP.PopupType.Popup,open:i,preventBlockRenderQueueOnEnter:!0,placementToOrigin:w.ZP.Placement.Bottom,alignmentToOrigin:w.ZP.Alignment.Start,originRect:o,disableMouseCapture:!0,keepFocus:!0,render:()=>r()("div",{style:{height:W.height,width:"calc(80wv)",borderRadius:3,overflow:"hidden"}},void 0,this.renderActionButtons())})}}renderActionButtons(){const e=this.shouldShowTextActions.state,t=this.shouldShowBlockActions.state,i=E.Tz({environment:this.environment,store:this.props.currentBlockStore});return r()("div",{style:this.getActionButtonStyles()},void 0,i&&this.renderTemplatesButton(),!i&&t&&this.renderBlockActions(),!i&&e&&this.renderTextActions(),r()(A.Z,{mobileFeedback:!0,disabledFeedback:!0,style:{...this.getItemStyle(),borderLeft:this.getItemBorder(),borderRight:"none"},onClick:this.handleDismissKeyboard},void 0,W.keyboardIcon))}renderBlockActions(){const e=this.canTriggerBlockActions.state;let t=!1,i=!1;const o=this.props.currentBlockStore.getValue();o&&((0,U._T)(o)||(t=!0),(0,U.lQ)(o)||(i=!0));const{device:s}=this.environment;return c().createElement("div",{ref:this.handleScrollerRef,style:this.getActionMenuStyle(),onScroll:this.handleActionsScrollDebounced},r()(A.Z,{mobileFeedback:!0,disabledFeedback:!0,style:{...this.getItemStyle(),...!s.isSmallPhone&&{paddingLeft:12,paddingRight:12}},onClick:this.handleInsert,disabled:!e},void 0,W.plusIcon,this.renderChevronDown()),r()(A.Z,{mobileFeedback:!0,disabledFeedback:!0,style:{...this.getItemStyle(),fontWeight:y.Z.fontWeight.medium},onClick:e=>{this.props.stores.store.setState({...this.props.stores.store.state,isTurnIntoOpen:!0}),this.trackItemTap("turn_into")},disabled:!e},void 0,r()(_._H,{defaultMessage:"Turn into",id:"mobileActionBar.turnInto.buttonTitle"}),this.renderChevronDown()),r()(k.Z,{capture:!0,render:e=>c().createElement(A.Z,n()({mobileFeedback:!0,disabledFeedback:!0},e,{style:this.getItemStyle(),onClick:this.handleMention,disabled:!i}),r()("span",{style:{fontSize:19,lineHeight:1,fontWeight:y.Z.fontWeight.medium,marginBottom:s.isAndroid?4:0}},void 0,"@"))}),r()(A.Z,{mobileFeedback:!0,disabledFeedback:!0,style:this.getItemStyle(),onClick:this.handleComment,disabled:!t},void 0,W.discussionIcon),r()(A.Z,{mobileFeedback:!0,disabledFeedback:!0,style:this.getItemStyle(),onClick:this.handleTakePicture,disabled:!e},void 0,W.imageIcon),r()(A.Z,{mobileFeedback:!0,disabledFeedback:!0,style:this.getItemStyle(),onClick:this.handleDelete,disabled:!e},void 0,W.trashIcon),this.renderBlockMovementActions(),this.renderBlockUndoActions(),r()(A.Z,{mobileFeedback:!0,disabledFeedback:!0,style:{...this.getItemStyle(),fontWeight:y.Z.fontWeight.medium},onClick:e=>{this.props.stores.store.setState({...this.props.stores.store.state,isColorOpen:!0}),this.trackItemTap("color")},disabled:!e},void 0,r()(_._H,{defaultMessage:"Color",id:"mobileActionBar.color.buttonTitle"}),this.renderChevronDown()),r()(A.Z,{mobileFeedback:!0,disabledFeedback:!0,style:{...this.getItemStyle(),fontWeight:y.Z.fontWeight.medium},onClick:this.handleMoreClick,disabled:!e},void 0,r()(_._H,{defaultMessage:"More",id:"mobileActionBar.more.buttonTitle"}),this.renderChevronDown()))}renderBlockMovementActions(){const e=this.canTriggerBlockActions.state,t=I.Z.state.stores[0];return r()("div",{style:{...this.getItemStyle(),paddingLeft:6,paddingRight:6}},void 0,r()(A.Z,{mobileFeedback:!0,disabledFeedback:!0,style:W.minorItemStyle,disabled:!e||!m.gq(t),onClick:this.handleUnindent},void 0,W.unindentIcon),r()(A.Z,{mobileFeedback:!0,disabledFeedback:!0,style:W.minorItemStyle,disabled:!e||!m.nt(t),onClick:this.handleIndent},void 0,W.indentIcon),r()(A.Z,{mobileFeedback:!0,disabledFeedback:!0,style:W.minorItemStyle,disabled:!e,onClick:this.handleMoveUp},void 0,W.moveUpIcon),r()(A.Z,{mobileFeedback:!0,disabledFeedback:!0,style:W.minorItemStyle,disabled:!e,onClick:this.handleMoveDown},void 0,W.moveDownIcon))}renderBlockUndoActions(){return r()("div",{style:{...this.getItemStyle(),paddingLeft:6,paddingRight:6}},void 0,r()(A.Z,{mobileFeedback:!0,disabledFeedback:!0,style:W.minorItemStyle,disabled:!g.L0(),onClick:this.handleUndo},void 0,W.undoIcon),r()(A.Z,{mobileFeedback:!0,disabledFeedback:!0,style:W.minorItemStyle,disabled:!g.AZ(),onClick:this.handleRedo},void 0,W.redoIcon))}renderTextActions(){const e=this.canTriggerTextActions.state,t=this.hasMultiBlockSelection.state,i=this.props.currentBlockStore.canComment();return r()("div",{style:this.getActionMenuStyle(),onScroll:this.handleActionsScrollDebounced},void 0,r()(Z.Z,{style:this.getItemStyle(),blockStore:I.Z.state.stores[0],disabled:!i}),r()(f.Z,{type:"b",style:this.getItemStyle(),onClick:()=>this.trackItemTap("bold"),disabled:!e},void 0,r()("span",{style:{fontWeight:y.Z.fontWeight.semibold}},void 0,r()(_._H,{defaultMessage:"B",id:"mobileActionBar.bold.symbol",description:"Letter 'B' which represents 'bold' format option."}))),r()(f.Z,{type:"i",style:this.getItemStyle(),onClick:()=>this.trackItemTap("italic"),disabled:!e},void 0,r()("span",{style:{fontStyle:"italic",fontWeight:y.Z.fontWeight.semibold}},void 0,r()(_._H,{defaultMessage:"i",id:"mobileActionBar.italic.symbol",description:"Letter 'i' which represents 'italic' format option."}))),r()(f.Z,{type:"_",style:this.getItemStyle(),onClick:()=>this.trackItemTap("underline"),disabled:!e},void 0,r()("span",{style:{textDecoration:"underline"}},void 0,r()(_._H,{defaultMessage:"U",id:"mobileActionBar.underline.symbol",description:"Letter 'U' which represents 'underline' format option."}))),r()(f.Z,{type:"s",style:this.getItemStyle(),onClick:()=>this.trackItemTap("strike_through"),disabled:!e},void 0,r()("span",{style:{textDecoration:"line-through"}},void 0,r()(_._H,{defaultMessage:"S",id:"mobileActionBar.strikeThrough.symbol",description:"Letter 'S' which represents 'strike-through' format option."}))),r()(f.Z,{type:"c",style:this.getItemStyle(),onClick:()=>this.trackItemTap("code"),disabled:!e},void 0,r()("span",{style:{fontFamily:y.Z.getCompositeFontFamily(D.SP).githubMono}},void 0,r()(_._H,{defaultMessage:"Code",id:"mobileActionBar.code.symbol",description:"Word 'code' which represents 'code' format option."}))),r()(M.Z,{style:this.getItemStyle(),disabled:!e||t},void 0,r()("span",{style:{borderBottom:"1px solid ".concat(this.theme.linkDecorationColor)}},void 0,r()(_._H,{defaultMessage:"Link",id:"mobileActionBar.link.symbol",description:"Word 'link' which represents 'link' format option."}))),r()(L.Z,{onClick:()=>this.trackItemTap("equation"),disabled:!e||t,style:this.getItemStyle()},void 0,u.Z.equation({width:16,height:16})),r()(R.Z,{style:this.getItemStyle(),ignoreSelectionAreaStore:this.props.stores.ignoreSelectionAreaStore,disabled:!e}))}renderTemplatesButton(){return r()("div",{style:this.getActionMenuStyle()},void 0,r()(A.Z,{mobileFeedback:!0,disabledFeedback:!0,style:{...this.getItemStyle(),borderRight:"none",fontWeight:y.Z.fontWeight.medium},onClick:e=>{this.props.stores.store.setState({...this.props.stores.store.state,isTemplatesOpen:!0}),this.trackItemTap("templates")}},void 0,u.Z.templatesColor({width:20,marginRight:8}),r()(_._H,{defaultMessage:"Choose a template...",id:"mobileActionBar.templates.buttonTitle"}),this.renderChevronDown()))}renderChevronDown(){return u.Z.chevronDown({width:10,marginLeft:4,fill:this.theme.lightIconColor})}isOpen(){const{device:e}=this.environment;return e.isMobileBrowser?this.props.stores.store.state.isOpen:this.renderStore.state.shouldShow}trackItemTap(e){v.YOV(this.environment,{itemName:e})}getItemBorder(){return"1px solid ".concat(this.theme.regularDividerColor)}getActionButtonStyles(){const{device:e,WindowSizeStore:t}=this.environment;return{height:"100%",width:"100%",fontSize:15,display:"flex",boxShadow:this.props.position===F.n.Bottom?this.theme.bottomActionBarShadow:this.theme.mediumBoxShadow,backgroundColor:this.theme.keyboardActionBarBackground,paddingLeft:e.isMobileNative?t.state.paddingLeftCSS:0,paddingRight:e.isMobileNative?t.state.paddingRightCSS:0}}getActionMenuStyle(){return{flexGrow:1,flexShrink:1,marginRight:-1,display:"flex",overflowX:"auto",overflowY:"hidden",WebkitOverflowScrolling:"touch"}}getItemStyle(){const{device:e}=this.environment;return{display:"flex",alignItems:"center",justifyContent:"center",paddingLeft:e.isSmallPhone?8:10,paddingRight:e.isSmallPhone?8:10,borderRight:this.getItemBorder(),whiteSpace:"nowrap",height:W.height,flexShrink:0,flexGrow:0,flexBasis:"auto",color:this.theme.regularTextColor,minWidth:e.isSmallPhone?42:44}}}l()(W,"unindentIcon",u.Z.indentDown({width:18,height:18,transform:"rotate(90deg)",position:"relative",left:1})),l()(W,"indentIcon",u.Z.indentDown({width:18,height:18,transform:"rotate(-90deg)",position:"relative",left:-1})),l()(W,"moveUpIcon",u.Z.moveUp({width:18,height:18,position:"relative",left:2})),l()(W,"moveDownIcon",u.Z.moveUp({width:18,height:18,transform:"rotate(180deg)",position:"relative",left:2})),l()(W,"undoIcon",u.Z.undo({width:19,height:19})),l()(W,"redoIcon",u.Z.redo({width:19,height:19})),l()(W,"trashIcon",u.Z.trash({width:18,height:18})),l()(W,"discussionIcon",u.Z.speechBubbleThin({width:18,height:18})),l()(W,"plusIcon",u.Z.thinPlus({width:14,height:14})),l()(W,"keyboardIcon",u.Z.keyboard({width:18,height:18})),l()(W,"imageIcon",u.Z.image({width:18,height:18})),l()(W,"height",42),l()(W,"minorItemStyle",{width:34,justifyContent:"center"});const q=(0,_.XN)(W)},82043:(e,t,i)=>{i.r(t),i.d(t,{default:()=>F});var o=i(98135),n=i.n(o),s=i(67154),r=i.n(s),a=i(59713),l=i.n(a),d=(i(33948),i(67294)),c=i.n(d),h=i(50906),p=i(34277),u=i(52016);class m extends u.Z{getInitialState(){return{isOpen:!1,isInsertOpen:!1,isTurnIntoOpen:!1,isColorOpen:!1,isTemplatesOpen:!1}}}const g=m;var b=i(52858),v=i(95009),y=i(66832),S=i(52377),f=i(16961),M=i(51454),Z=i(39302),k=i(27724),T=i(24666),w=i(63334),C=i(5366),I=i(29798),B=i(25584),x=i(94006),P=i(94660),A=i(34574),R=i(70442),_=i(21325),L=i(83071),U=i(15282),O=i(67074);class H extends y.Z{constructor(...e){super(...e),l()(this,"storeTypes",{store:g,ignoreSelectionAreaStore:w.Z,templatePickerMenuListStore:I.Z}),l()(this,"renderMobileTemplatePreviewItem",(e=>({key:e.name,render:t=>c().createElement(A.Z,r()({},t,{key:e.name,title:e.name,type:"page_template",format:"phone-modal",emoji:e.emoji,locked:!1})),action:()=>{R.$7({environment:this.environment,item:e,createNewPage:!1,isPrivate:!1})}}))),l()(this,"renderPageTemplatePickerItem",(e=>{const t=this.props.currentBlockStore;return{key:e.name,render:t=>c().createElement(A.Z,r()({},t,{key:e.name,format:"phone-modal",title:e.name,type:e.type,icon:e.icon,locked:!1})),action:i=>{t&&(0,_.M_)(this.environment)&&(h.rNQ(this.environment,{name:e.name,is_keyboard:"keydown"===i.event.type}),e.onClick(this.environment,t))}}})),l()(this,"handleCloseColorPopup",(()=>{this.stores.store.setState({...this.stores.store.state,isColorOpen:!1})})),l()(this,"handleCloseInsertPopup",(()=>{this.stores.store.setState({...this.stores.store.state,isInsertOpen:!1})})),l()(this,"handleCloseTurnIntoPopup",(()=>{this.stores.store.setState({...this.stores.store.state,isTurnIntoOpen:!1})})),l()(this,"handleCloseTemplatesPopup",(()=>{this.stores.store.setState({...this.stores.store.state,isTemplatesOpen:!1})})),l()(this,"renderStore",this.createComputedStore((()=>{var e;return O.$3(this.environment,this.props.currentBlockStore,null===(e=this.pageContext)||void 0===e?void 0:e.publicEditModeStore.state)})))}renderComponent(){const{device:e,WindowSizeStore:t}=this.environment,i=this.isOpen(),{makeActionBarComponent:o}=this.props;return n()(d.Fragment,{},void 0,n()(f.Z,{capture:!0,render:e=>c().createElement("div",r()({},e,{style:{position:"relative",width:"100%",height:0,zIndex:M.Eo}}),o(this.stores),this.renderNativeMenuIgnoreSelectionArea(),this.renderInsertPopup(),this.renderTurnIntoPopup(),this.renderColorPopup(),this.renderTemplatesPopup())}),!i&&e.isIPhoneX&&e.isNative&&n()("div",{style:{position:"absolute",bottom:0,background:"transparent",height:t.state.paddingBottomCSS,width:"100%",pointerEvents:"none",WebkitUserSelect:"none"}}))}renderNativeMenuIgnoreSelectionArea(){const e=this.environment.NativeMobileActionBarStore;return e?n()(S.Z,{store:this.stores.ignoreSelectionAreaStore,capture:O.y6(this.environment),ignoreBlockSelection:!1,focusOffscreenInput:!1,restoreSelection:"editing"!==T.Z.state.mode&&e.state.shouldRestoreSelectionForMenu,render:e=>null}):null}renderInsertPopup(){const{device:e}=this.environment;return n()(S.Z,{capture:this.stores.store.state.isInsertOpen,ignoreBlockSelection:!1,focusOffscreenInput:!1,restoreSelection:!1,render:t=>n()(Z.ZP,{popupType:e.isMobile?Z.ZP.PopupType.SlideUp:Z.ZP.PopupType.Popup,preventBlockRenderQueueOnEnter:!0,open:this.stores.store.state.isInsertOpen,keepFocus:!0,onDismiss:()=>{t(),this.handleCloseInsertPopup()},render:()=>n()(v.ZP,{menuType:v.ZP.MenuType.Modal,title:n()(C._H,{defaultMessage:"Insert block",id:"mobileActionBar.insertBlock.modalTitle"}),right:n()(U.CancelMenuText,{}),onClickRight:()=>{t(),this.handleCloseInsertPopup()}},void 0,n()(b.Z,{sections:p.kR,context:{environment:this.environment,blocks:k.Z.state.stores,publicEditMode:void 0},onAccept:this.handleCloseInsertPopup}))})})}renderTurnIntoPopup(){const{device:e}=this.environment;return n()(S.Z,{capture:this.stores.store.state.isTurnIntoOpen,ignoreBlockSelection:!1,focusOffscreenInput:!1,restoreSelection:!0,render:()=>n()(Z.ZP,{popupType:e.isMobile?Z.ZP.PopupType.SlideUp:Z.ZP.PopupType.Popup,open:this.stores.store.state.isTurnIntoOpen,keepFocus:!0,onDismiss:this.handleCloseTurnIntoPopup,preventBlockRenderQueueOnEnter:!0,render:()=>n()(v.ZP,{menuType:v.ZP.MenuType.Modal,title:n()(C._H,{defaultMessage:"Turn into",id:"mobileActionBar.turnInto.modalTitle"}),right:n()(U.CancelMenuText,{}),onClickRight:this.handleCloseTurnIntoPopup},void 0,n()(b.Z,{sections:[{...p.gH,title:""}],context:{environment:this.environment,blocks:k.Z.state.stores,publicEditMode:void 0},onAccept:this.handleCloseTurnIntoPopup}))})})}renderColorPopup(){const{device:e}=this.environment;return n()(S.Z,{capture:this.stores.store.state.isColorOpen,ignoreBlockSelection:!1,focusOffscreenInput:!1,restoreSelection:!0,render:()=>n()(Z.ZP,{popupType:e.isMobile?Z.ZP.PopupType.SlideUp:Z.ZP.PopupType.Popup,open:this.stores.store.state.isColorOpen,keepFocus:!0,onDismiss:this.handleCloseColorPopup,preventBlockRenderQueueOnEnter:!0,render:()=>n()(v.ZP,{menuType:v.ZP.MenuType.Modal,title:n()(C._H,{defaultMessage:"Block color",id:"mobileActionBar.blockColor.modalTitle"}),right:n()(U.CancelMenuText,{}),onClickRight:this.handleCloseColorPopup},void 0,n()(b.Z,{sections:[p.te,p.rz,p.Vm],context:{environment:this.environment,blocks:k.Z.state.stores,publicEditMode:void 0},onAccept:this.handleCloseColorPopup}))})})}renderTemplatesPopup(){const{device:e}=this.environment;return n()(S.Z,{capture:this.stores.store.state.isTemplatesOpen,ignoreBlockSelection:!1,focusOffscreenInput:!1,restoreSelection:!1,render:()=>n()(Z.ZP,{popupType:e.isMobile?Z.ZP.PopupType.SlideUp:Z.ZP.PopupType.Popup,open:this.stores.store.state.isTemplatesOpen,keepFocus:!0,render:()=>n()(v.ZP,{menuType:v.ZP.MenuType.Modal,title:n()(C._H,{defaultMessage:"Templates",id:"mobileActionBar.templates.modalTitle"}),right:n()(U.CancelMenuText,{}),onClickRight:this.handleCloseTemplatesPopup},void 0,n()(B.Z,{type:B.Z.Type.Vertical,store:this.stores.templatePickerMenuListStore,initialFocus:void 0,disableInitialScroll:!0,disableCommandEnter:!0,onAccept:this.handleCloseTemplatesPopup,sections:[{key:"Basic",render:e=>n()(L.Z,{},void 0,e.children),items:x.ss.map(this.renderPageTemplatePickerItem)},{key:"Database",render:e=>n()(L.Z,{title:n()(C._H,{defaultMessage:"Database",id:"mobileActionBar.databaseSection.title"})},void 0,e.children),items:x.Im.filter((e=>e.shouldShow(this.environment))).map(this.renderPageTemplatePickerItem)},...P.I(this.props.intl).map((e=>({key:e.name,render:t=>n()(L.Z,{title:e.name},e.name,t.children),items:e.items.map(this.renderMobileTemplatePreviewItem)})))]}))})})}isOpen(){const{device:e}=this.environment;return e.isMobileBrowser?this.stores.store.state.isOpen:this.renderStore.state.shouldShow}}const F=(0,C.XN)(H)},85394:(e,t,i)=>{i.r(t),i.d(t,{default:()=>Z});var o=i(98135),n=i.n(o),s=i(59713),r=i.n(s),a=(i(33948),i(67294)),l=i(66832),d=i(14947),c=i(76668),h=i(3779),p=i(27832),u=i(51454),m=i(87531),g=i(70951),b=i(50906),v=i(60165),y=i(72653),S=i(43250),f=i(59488);class M extends l.Z{constructor(...e){super(...e),r()(this,"handleClickFind",(()=>{m.Kf({environment:this.environment,analyticsFrom:"mobile-bottom-bar"}),b.nBz(this.environment,{itemName:"search"})})),r()(this,"handleClickQuickAdd",(()=>{c.hU({environment:this.environment,from:"mobile_bottom_bar"}),b.nBz(this.environment,{itemName:"add_page"})})),r()(this,"handleUndo",(()=>{v.Yw(this.environment,!0),b.nBz(this.environment,{itemName:"undo"})})),r()(this,"handleRedo",(()=>{v.KX(this.environment,!0),b.nBz(this.environment,{itemName:"redo"})})),r()(this,"canQuickAdd",this.createComputedStore((()=>Boolean(p.Z.state.currentSpaceStore&&p.Z.state.currentSpaceStore.canEdit()))))}renderComponent(){const e=y.Z.state,t=f.qG(),{isTablet:i}=this.environment.device;if(e)return t?n()("div",{className:S.al},void 0,this.renderUpdatesButton()):n()("div",{style:this.getWrapStyle(e),className:S.rK},void 0,i?this.renderTabletButtons():this.renderPhoneButtons())}renderPhoneButtons(){return n()(a.Fragment,{},void 0,this.renderSearchButton(),this.renderUpdatesButton(),this.renderQuickAddPageButton())}renderTabletButtons(){return n()(a.Fragment,{},void 0,this.renderSearchButton(),this.renderUpdatesButton(),this.renderQuickAddPageButton(),this.renderUndoRedoButtons())}renderSearchButton(){return n()(d.Z,{style:this.getSearchButtonStyle(),onClick:this.handleClickFind,mobileFeedback:!0},void 0,h.Z.mobileBottomBarSearch(this.getIconStyle()))}renderUpdatesButton(){const{isTablet:e}=this.environment.device;return n()(g.Z,{format:e?g.Z.Format.MobileBottomBarTablet:g.Z.Format.MobileBottomBarPhone})}renderQuickAddPageButton(){return n()(d.Z,{style:this.getQuickAddButtonStyle(),onClick:this.handleClickQuickAdd,mobileFeedback:!0,disabled:!this.canQuickAdd.state,disabledFeedback:!0},void 0,h.Z.mobileBottomBarAddPage(this.getIconStyle()))}renderUndoRedoButtons(){return n()(a.Fragment,{},void 0,n()(d.Z,{style:this.getUndoButtonStyle(),onClick:this.handleUndo,mobileFeedback:!0,disabled:!v.L0(),disabledFeedback:!0},void 0,h.Z.mobileBottomBarUndo(this.getIconStyle())),n()(d.Z,{style:this.getRedoButtonStyle(),onClick:this.handleRedo,mobileFeedback:!0,disabled:!v.AZ(),disabledFeedback:!0},void 0,h.Z.mobileBottomBarRedo(this.getIconStyle())))}getWrapStyle(e){const{WindowSizeStore:t}=this.environment,{isTablet:i}=this.environment.device;return{position:"absolute",left:0,right:0,bottom:0,display:"flex",justifyContent:i?"flex-start":"space-around",height:t.getSafePaddingBottomCSS(M.height),paddingBottom:t.state.paddingBottomCSS,background:this.theme.contentBackground,borderTop:"1px ".concat(this.theme.darkDividerColor," solid"),zIndex:u.D_,pointerEvents:e?"auto":"none",cursor:"pointer"}}getSearchButtonStyle(){const{WindowSizeStore:e}=this.environment,{isTablet:t}=this.environment.device;return{display:"flex",alignItems:"center",justifyContent:"flex-start",flex:1,paddingLeft:e.getSafePaddingLeftCSS(18),...t&&{flex:"none",paddingLeft:2,width:M.tabletButtonWidth,justifyContent:"center"}}}getQuickAddButtonStyle(){const{WindowSizeStore:e}=this.environment,{isTablet:t}=this.environment.device;return{display:"flex",alignItems:"center",justifyContent:"flex-end",flex:1,paddingRight:e.getSafePaddingRightCSS(18),...t&&{justifyContent:"center",flex:"none",paddingRight:0,width:M.tabletButtonWidth,marginRight:"auto"}}}getUndoButtonStyle(){const{WindowSizeStore:e}=this.environment;return{display:"flex",alignItems:"center",justifyContent:"flex-start",flex:"none",paddingLeft:e.getSafePaddingLeftCSS(18),width:M.tabletButtonWidth}}getRedoButtonStyle(){return{display:"flex",alignItems:"center",justifyContent:"center",flex:"none",width:M.tabletButtonWidth,paddingRight:4}}getIconStyle(){return{width:26,fill:this.theme.regularTextColor}}}r()(M,"height",44),r()(M,"tabletButtonWidth",54);const Z=M},56140:(e,t,i)=>{i.r(t),i.d(t,{default:()=>j});var o=i(98135),n=i.n(o),s=i(59713),r=i.n(s),a=(i(33948),i(96486)),l=i.n(a),d=i(67294),c=i(17256),h=i(66832),p=i(3779),u=i(52016);class m extends u.Z{getInitialState(){return{}}}const g=m;var b=i(82990),v=i(84210),y=i(40039),S=i(79029),f=i(6695),M=i(42285),Z=i(32918),k=i(65598),T=i(86512),w=i(48762),C=i(33929);class I extends h.Z{constructor(...e){super(...e),r()(this,"renderProperty",(e=>{const{schema:t,store:i,blockPropertyValueOverlayStore:o}=this.props;if(t[e])return n()(M.Z,{store:i,property:e,schema:t,disabled:!0,locked:!1,format:M.Z.Format.Calendar,tableWrap:!1,blockPropertyValueOverlayStore:o},e)}))}renderComponent(){const{time:e,store:t}=this.props,i=t.hasIcon()||!t.isEmptyPage(),o=(0,v.Z)({store:t,fullyQualified:!1}),s=k.Xp(t,{recursivelyLoadAllDiscussions:!1});return n()(T.Z,{href:o},void 0,n()(w.Z,{focused:!1,title:n()(d.Fragment,{},void 0,e&&n()("div",{style:{display:"flex",color:this.theme.mediumTextColor,fontSize:14,marginTop:8,marginBottom:6}},void 0,e),n()("div",{style:{display:"flex",alignItems:"center",...e&&{marginBottom:8}}},void 0,i&&n()(y.Z,{disabled:!0,icon:t.getIcon(),isEmptyPage:t.isEmptyPage(),size:24,style:{flexShrink:0,marginRight:8}}),n()(S.Z,{store:t,style:{fontWeight:b.Z.fontWeight.semibold}}),s>0&&n()("div",{style:{display:"flex",alignItems:"center",color:this.theme.regularDividerColor,fontSize:12,marginLeft:4,flexShrink:0}},void 0,p.Z.speechBubble({width:12,height:12,marginRight:4,fill:this.theme.mediumIconColor}),s))),caption:this.renderProperties()}))}renderProperties(){const{format:e,schema:t,store:i}=this.props,o=(e.calendar_properties?e.calendar_properties.filter((e=>e.visible)).map((e=>e.property)):[]).filter((e=>f.XU({blockValue:i.getValue(),property:e,schema:t,getRecordValue:i.getRecordValue,userTimeZone:Z.x7,intl:C.Z.getIntl()})));if(o.length>0)return n()("div",{style:{marginTop:8}},void 0,o.map(this.renderProperty))}}const B=I;var x=i(9714),P=i(26797),A=i(8646),R=i(95009),_=i(83071),L=i(13401),U=i(78948),O=i(16328),H=i(80527),F=i(2107),E=i(57269),D=i(68718),N=i(5366),V=i(15282),W=i(40863),q=i(75498),z=i(12318),G=i(21202);class K extends h.Z{constructor(...e){super(...e),r()(this,"storeTypes",{store:g,resultStore:z.Z.of(void 0)}),r()(this,"renderResults",(()=>{const{disabled:e,collectionStore:t}=this.props,i=this.getCurrentStartOfDay(),o=i.clone().endOf("day"),s=this.getCurrentResults();return n()(R.ZP,{menuType:R.ZP.MenuType.Modal,title:n()("div",{style:K.headerStyle},void 0,n()(H.Z,{onClick:this.handleLeftClick,icon:p.Z.chevronLeft,style:{marginRight:8,marginTop:2},mobileFeedback:!0}),n()("div",{},void 0,i.format("MMMM Do")),n()(H.Z,{onClick:this.handleRightClick,icon:p.Z.chevronRight,style:{marginLeft:8,marginTop:2},mobileFeedback:!0})),right:n()(V.DoneMenuText,{}),onClickRight:this.props.onDismiss},void 0,!s&&n()(_.Z,{},void 0,n()(U.Z,{})),s&&0===s.length&&n()(_.Z,{},void 0,n()(O.Z,{title:n()(N._H,{defaultMessage:"No items",id:"mobileCalendarDayMenu.noResults.message"})})),s&&s.length>0&&n()(_.Z,{},void 0,s.map((e=>{const n=x.Z.createChildStore(t,{id:e.id,table:G.iU});return this.renderItem(n,e,i,o)}))),!e&&n()(_.Z,{topBorder:!0},void 0,n()(L.Z,{focused:!1,onClick:this.handleAddItemClick,title:n()(N._H,{defaultMessage:"New item",id:"mobileCalendarDayMenu.newItemButton.label"})})))})),r()(this,"handleLeftClick",(()=>{const e=this.getCurrentStartOfDay();this.stores.store.setState({...this.stores.store.state,currentStartOfDay:e.clone().add(-1,"day").valueOf()})})),r()(this,"handleRightClick",(()=>{const e=this.getCurrentStartOfDay();this.stores.store.setState({...this.stores.store.state,currentStartOfDay:e.clone().add(1,"day").valueOf()})})),r()(this,"handleAddItemClick",(()=>{const{collectionViewLocalStore:e,collectionStore:t,calendarBy:i,resultsStore:o}=this.props,n=this.getCurrentStartOfDay(),s=A.H5(this.environment,(s=>P.uV({environment:this.environment,collectionStore:t,collectionViewLocalStore:e,calendarBy:i,startOfDay:n.valueOf(),results:o.state,transaction:s}))),r=(0,v.Z)({store:s});this.navigate(r)})),r()(this,"reducerStore",this.createComputedStore((()=>{const{collectionViewLocalStore:e}=this.props;return(0,W.YG)({collectionViewLocalStore:e,startOfDay:this.getCurrentStartOfDay().valueOf()})}),!0)),r()(this,"getRecordValue",this.props.collectionStore.getRecordValue)}navigate(e){this.context.overrideLinkClick?this.context.overrideLinkClick(e):F.c4({environment:this.environment,url:e})}renderComponent(){const{collectionViewLocalStore:e}=this.props,t=this.reducerStore.state;if(t)return n()(q.Z,{id:"calendar_day_results",reducer:t,collectionViewLocalStore:e,render:this.renderResults,resultStore:this.stores.resultStore})}renderItem(e,t,i,o){const{disabled:s,blockPropertyValueOverlayStore:r}=this.props;return n()(B,{store:e,time:t.includeTime?this.renderTime(t,i,o):void 0,disabled:s,format:this.props.format,schema:this.props.schema,blockPropertyValueOverlayStore:r},t.id)}renderTime(e,t,i){const{schema:o,calendarBy:n,intl:s}=this.props,r=o[n];if(!r||"date"!==r.type)return;const a=r.date_format||Z.sF,l=r.time_format||Z.c_,d=(0,c.Z)(e.start),h=e.end?(0,c.Z)(e.end):void 0,p=Boolean(!d.isBetween(t,i)||h&&!h.isBetween(t,i));if(e.end){const t=Z.iC(e.start.valueOf(),e.end?e.end.valueOf():e.start.valueOf(),e.timeZone);return p?(0,E.ZV)({value:t,date_format:a,time_format:l,userTimeZone:e.timeZone,allowRelativeDates:!0,intl:s}):(0,E.ns)({start_time:t.start_time,end_time:t.end_time,time_format:l,humanReadable:!0,intl:s})}return(0,E.mr)({start_time:Z.CQ(e.start.valueOf(),e.timeZone).start_time,time_format:l,humanReadable:!0,intl:s})}getCurrentStartOfDay(){const{currentStartOfDay:e}=this.stores.store.state;return e?(0,c.Z)(e):(0,c.Z)(this.props.initialStartOfDay)}getCurrentResults(){const{collectionStore:e,collectionViewLocalStore:t}=this.props,i=this.stores.resultStore.state,o=t.normalizedQueryStore.state,n=t.normalizedSchemaStore.state,s=o?o.calendar_by:void 0;if(!(i&&o&&s&&n))return;let r=l().compact(i.blockIds.map((t=>{const i=x.Z.createChildStore(e,{id:t,table:G.iU});return(0,W.BO)({blockStore:i,calendarBy:s,schema:n,getRecordValue:this.getRecordValue,intl:this.props.intl})})));return o.sort||(r=l().sortBy(r,(e=>e.start))),r}}r()(K,"contextTypes",D.u),r()(K,"headerStyle",{display:"flex",alignItems:"center",height:"100%"});const j=(0,N.XN)(K)},61208:(e,t,i)=>{i.d(t,{Z:()=>a});var o=i(98135),n=i.n(o),s=(i(67294),i(3779)),r=i(64215);function a(e){const{message:t,title:i}=e,o=(0,r.y)((e=>({wrapper:{textAlign:"center",paddingLeft:20,paddingRight:20,height:"100%",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",overflow:"hidden",minHeight:220},icon:{width:48,fill:e.lightIconColor},message:{fontSize:14,color:e.mediumTextColor,marginTop:2,marginBottom:4,maxWidth:380},title:{fontSize:14,fontWeight:500,color:e.mediumTextColor,maxWidth:380}})),[]);return n()("div",{style:o.wrapper},void 0,n()("div",{style:{paddingBottom:12}},void 0,s.Z.inbox(o.icon)),n()("div",{style:o.title},void 0,i),n()("div",{style:o.message},void 0,t))}},75873:(e,t,i)=>{i.r(t),i.d(t,{default:()=>qo});var o=i(98135),n=i.n(o),s=i(67154),r=i.n(s),a=i(59713),l=i.n(a),d=(i(33948),i(85827),i(67294)),c=i.n(d),h=i(66832),p=i(41432),u=i(3779),m=i(52315),g=i(9714),b=i(4122),v=i(6404),y=i(89858),S=i(84210),f=i(81997),M=i(52016);class Z extends M.Z{getInitialState(){return{open:!1,focused:!1}}}const k=Z;var T=i(28452),w=i(28240),C=i(40039),I=i(66094),B=i(14694),x=i(37235),P=i(79029),A=i(27832),R=i(82990),_=i(5366),L=i(45669);class U extends h.Z{constructor(...e){super(...e),l()(this,"handleClick",(()=>{const{onNavigate:e,store:t}=this.props;e&&e(t)}))}renderComponent(){const{store:e,collectionViewStore:t}=this.props,i=(0,S.Z)({store:e,fullyQualified:!1,collectionViewId:t.id}),o=t.getValue();if(o)return n()(w.Z,{href:i,style:{width:"100%"},onClick:this.handleClick},void 0,n()(B.Z,{icon:this.renderIcon(),style:this.getSidebarItemStyle(),isMobile:this.props.isMobile},void 0,n()(L.Z,{collectionViewName:o.name,collectionViewType:o.type})))}renderIcon(){return n()("div",{style:{...this.getInitialIconStyle()}},void 0,"•")}getInitialIconStyle(){return{fontSize:12,fontWeight:500,color:this.theme.mediumTextColor}}getSidebarItemStyle(){const{device:e}=this.environment;return{...this.isCurrentPage()&&{background:this.theme.buttonHoveredBackground,color:this.theme.regularTextColor,fontWeight:R.Z.fontWeight.semibold,...e.isMobile&&{boxShadow:"\n\t\t\t\t\t\t0 1px 0 ".concat(this.theme.buttonHoveredBackground,"\n\t\t\t\t\t")}},...this.props.style}}isCurrentPage(){const{store:e,collectionViewStore:t}=this.props,{currentBlockStore:i,currentCollectionViewStore:o}=A.Z.state;return i&&e.id===i.id&&o&&o.id===t.id}}const O=(0,_.XN)(U);var H=i(12534);class F extends h.Z{constructor(...e){super(...e),l()(this,"renderCollectionView",(e=>{const{store:t}=this.props;return n()(O,{store:t,collectionViewStore:e,style:this.props.itemStyle,isMobile:this.props.isMobile,onNavigate:this.props.onNavigate},e.id)})),l()(this,"handleContextMenu",(e=>{e.preventDefault(),(0,H.ZP)({event:e,context:H.Af.EditorContextMenu,callback:()=>{}})}))}renderComponent(){const{store:e}=this.props,t=e.getCollectionViewStores();return n()("div",{onContextMenu:this.handleContextMenu},void 0,t.map(this.renderCollectionView))}}const E=F;var D=i(9953),N=i(8646),V=i(50906),W=i(68932),q=i(24677),z=i(21325),G=i(34277),K=i(5210),j=i(14947),Y=i(81844),Q=i(80796),X=i(15157),J=i(63328),$=i(2107),ee=i(22889),te=i(42330),ie=i(94419),oe=i(92251);class ne extends T.Z{constructor(...e){super(...e),l()(this,"showAsLoadingSpinner",!1),l()(this,"storeTypes",{outlinerItemStore:k}),l()(this,"toggleOpen",(e=>{this.stores.outlinerItemStore.setState({...this.stores.outlinerItemStore.state,open:e}),this.shouldPersistToggleState()&&X.Z.set({userId:this.environment.currentUser.id,key:this.getLocalStoreKey(),value:e})})),l()(this,"isCurrentPage",this.createComputedStore((()=>{const{store:e}=this.props,{currentBlockStore:t}=A.Z.state;return t&&e.id===t.id}))),l()(this,"handleLinkClick",(()=>{const{store:e}=this.props;V.Yg1(this.environment,{type:this.props.isTopLevelItem?"top_level":"nested"}),this.props.onNavigate&&this.props.onNavigate(e)})),l()(this,"handleMouseMove",(e=>{Q.Z.state.isDragging||this.stores.outlinerItemStore.setState({...this.stores.outlinerItemStore.state,focused:!0})})),l()(this,"handleMouseLeave",(e=>{this.stores.outlinerItemStore.setState({...this.stores.outlinerItemStore.state,focused:!1})})),l()(this,"handleDrop",(async e=>{const{droppedDirection:t,droppedStores:i,duplicate:o}=e,{store:n,type:s,isTopLevelItem:r,parentStore:a}=this.props;await y.Ar({type:s,droppedStores:i,droppedDirection:t})&&a&&N.H5(this.environment,(e=>{y.LQ({environment:this.environment,type:s,targetParentStore:a,targetStore:n,isTopLevelItem:r,droppedDirection:t,droppedStores:i,duplicate:o,transaction:e})}))})),l()(this,"handleShowMenuButtonClick",(e=>{const{store:t}=this.props;q.Ys({environment:this.environment,store:t}),v.Qn({environment:this.environment,stores:[this.props.store],left:e.clientX,top:e.clientY,showInput:!1,actions:G.Oq,analyticsFrom:"sidebar_more_menu"})})),l()(this,"handleToggleClick",(()=>{const{outlinerItemStore:e}=this.stores,t=!e.state.open;V.t8_(this.environment,{type:this.props.isTopLevelItem?"top_level":"nested",is_toggled:t}),this.toggleOpen(t)})),l()(this,"handleInsertBefore",(e=>{const{store:t,type:i}=this.props;return y.LR({environment:this.environment,store:t,insertStores:e.insertStores,parentStore:e.parentStore,before:!0,transaction:e.transaction,type:i})})),l()(this,"handleInsertAfter",(e=>{const{store:t,type:i}=this.props;return y.LR({environment:this.environment,store:t,insertStores:e.insertStores,parentStore:e.parentStore,before:!1,transaction:e.transaction,type:i})})),l()(this,"handleRemove",(e=>{const{store:t}=this.props,i=t.recordStoreParent();i&&ie.Od({remove:t,parent:i,transaction:e.transaction})})),l()(this,"handleRecordIconChange",(e=>{const t=this.getTargetStore();if(!t)return;const i=t.getIconStore();i&&N.H5(this.environment,(t=>{D.sO({store:i,value:e,transaction:t})}))})),l()(this,"handleAddPageButtonClick",(e=>{const{device:t}=this.environment;if((0,z.M_)(this.environment)){this.props.onCreatePage&&this.props.onCreatePage();const e=N.H5(this.environment,(e=>y.D0({environment:this.environment,store:this.props.store,transaction:e})));te.Z.setState({...te.Z.state,lastPageId:A.Z.state.currentBlockStore?A.Z.state.currentBlockStore.id:void 0}),t.isMobile?$._c({environment:this.environment,store:e,showMoveTo:!1,saveParent:!1,visitType:ee.vu.Link}):$.II({environment:this.environment,store:e,showMoveTo:!0,saveParent:!1}),this.props.store.isCollectionView()||this.toggleOpen(!0)}}))}toggleStore(){return this.stores.outlinerItemStore}get registries(){return[Y.Z]}didMount(){if(super.didMount(),this.shouldPersistToggleState()){const e=X.Z.get({userId:this.environment.currentUser.id,key:this.getLocalStoreKey()});this.stores.outlinerItemStore.setState({...this.stores.outlinerItemStore.state,open:e})}const{store:e}=this.props;this.showAsLoadingSpinner="copy_indicator"===e.getType()&&J.n.isPendingTransactionForRecord(e.pointer)}renderPersisted(){const{store:e,isFirstItem:t,type:i,parentStore:o}=this.props,n=e.canRead()&&"copy_indicator"!==e.getType()&&"offline"!==i,s=this.canEdit(),a=n&&o?{onInsertAfter:e=>this.handleInsertAfter({...e,parentStore:o}),onInsertBefore:e=>this.handleInsertBefore({...e,parentStore:o})}:{};return c().createElement(I.Z,r()({analyticsName:"outliner_item",blockMenuActions:G.Oq,canDrag:n,canDropAbove:t,canDropBelow:n,canDropOnto:s,canInsertAfter:n,canInsertBefore:n,canSelect:n,canTriggerContextMenu:!0,onRemove:this.handleRemove,onSelectableDrop:this.handleDrop,shouldShowDropZone:!0,showBlockMenuInput:!1,store:e},a),this.renderItem(),this.shouldShowChildren()&&this.renderOutliner())}renderOutliner(){const{disabled:e}=this.props,t=this.getTargetStore();if(t)return t.isCollectionView()?n()(E,{store:t,itemStyle:this.getSubOutlinerStyle(),isMobile:this.props.isMobile,onNavigate:this.props.onNavigate}):n()(ce,{isMobile:this.props.isMobile,type:this.props.type,isTopLevel:!1,spaceStore:this.props.spaceStore,spaceViewStore:this.props.spaceViewStore,parentStore:t.getContentStore(),itemStyle:this.getSubOutlinerStyle(),itemToggleStyle:this.props.toggleStyle,onCreatePage:this.props.onCreatePage,onNavigate:this.props.onNavigate,disabled:e})}renderItem(){const{store:e}=this.props;if("copy_indicator"===e.getType())return this.showAsLoadingSpinner?n()(B.Z,{style:this.getSidebarItemStyle(),childrenStyle:ne.sidebarChildrenStyle,onMouseMove:this.handleMouseMove,onMouseLeave:this.handleMouseLeave,isMobile:this.props.isMobile},void 0,n()(W.Z,{})):void 0;{let e=n()(B.Z,{style:this.getSidebarItemStyle(),childrenStyle:ne.sidebarChildrenStyle,left:this.renderLeftToggleButton(),icon:this.renderIcon(),right:this.renderRightIcons(),onMouseMove:this.handleMouseMove,onMouseLeave:this.handleMouseLeave,isMobile:this.props.isMobile,isAlias:this.isAlias()},void 0,this.renderTitle());const t=this.getURL();return t&&(e=n()(w.Z,{style:{width:"100%"},href:t,onClick:this.handleLinkClick},void 0,e)),e}}renderRightIcons(){const{isMobile:e,store:t}=this.props;if(e||this.stores.outlinerItemStore.state.focused){const e=t.getType()&&this.canEdit();return n()("div",{style:{display:"flex",paddingLeft:3}},void 0,this.renderMenuButton(),e&&this.renderAddPageButton())}}renderLeftToggleButton(){return n()(K.Z,{isSidebar:!0,fill:!0,icon:(0,oe.bq)(this.environment)?"chevron":"triangle",open:Boolean(this.stores.outlinerItemStore.state.open),color:this.theme.mediumIconColor,onClick:this.handleToggleClick})}renderAddPageButton(){const{isMobile:e}=this.props;return n()(x.Z,{renderTooltip:()=>n()(_._H,{defaultMessage:"Quickly add a page inside",id:"sidebarItem.addAPageInside.tooltip"}),placement:x.Z.Placement.Bottom,render:t=>c().createElement(j.Z,r()({mobileFeedback:e,style:{...this.getButtonStyle(),marginLeft:e?0:4,...!e&&{border:"1px solid ".concat(this.theme.outlineButtonBorder)}},onClick:this.handleAddPageButtonClick},t),u.Z.plus(this.getButtonIconStyle()))})}renderMenuButton(){const{isMobile:e}=this.props;return n()(x.Z,{renderTooltip:()=>"bookmarks"===this.props.type?n()(_._H,{defaultMessage:"Remove, rename, and more…",id:"sidebarItem.favoritedPageMenuButton.tooltip"}):n()(_._H,{defaultMessage:"Delete, duplicate, and more…",id:"sidebarItem.pageMenuButton.tooltip"}),placement:x.Z.Placement.Bottom,render:t=>c().createElement(j.Z,r()({mobileFeedback:e,style:this.getButtonStyle(),onClick:this.handleShowMenuButtonClick},t),u.Z.dots({...this.getButtonIconStyle(),width:e?18:14}))})}renderIcon(){const e=this.getTargetStore();if(!e)return;const t=e.getIcon(),i=!this.props.isMobile&&this.canEdit()&&!e.isLocked();return n()(x.Z,{renderTooltip:()=>n()(_._H,{defaultMessage:"Change icon",id:"sidebarItem.changeIconButton.tooltip"}),placement:x.Z.Placement.Bottom,render:o=>i?c().createElement(C.Z,r()({bucket:"secure",disabled:!1,icon:t,store:e,title:void 0,isEmptyPage:e.isEmptyPage(),size:this.props.isMobile?24:20,onChange:this.handleRecordIconChange,pageIconStyle:{fill:this.theme.mediumIconColor}},o)):n()(C.Z,{disabled:!0,icon:t,title:void 0,isEmptyPage:e.isEmptyPage(),size:this.props.isMobile?24:20,pageIconStyle:{fill:this.theme.mediumIconColor}})})}renderTitle(){const{store:e}=this.props;return n()(P.Z,{store:e})}shouldPersistToggleState(){return this.props.isTopLevelItem}shouldShowChildren(){return this.stores.outlinerItemStore.state.open}getURL(){const e=this.getTargetStore();if(e){if(e.isNavigableBlock())return(0,S.Z)({store:e,fullyQualified:!1});{const t=f.Dg(e);if(t)return(0,S.Z)({store:t,scrollToBlockId:e.id,fullyQualified:!1})}}}getLocalStoreKey(){const{store:e}=this.props;return"Outliner-".concat(e.id)}isAlias(){const{store:e,parentStore:t,isTopLevelItem:i}=this.props,o=e.getValue();return e.isCollectionView()?!e.getCollectionViewSourceCollectionStore():!(!o||o.type!==p.ZP.alias)||!i&&(!!t&&(!!o&&o.parent_id!==t.id))}getTargetStore(){const{store:e}=this.props;return e.getType()===p.ZP.alias?e.getAliasTargetStore():e}getPaddingLeftUnit(){return this.props.isMobile?22:14}getSidebarItemStyle(){const{device:e}=this.environment;return{...this.isCurrentPage.state&&{background:this.theme.buttonHoveredBackground,color:this.theme.regularTextColor,fontWeight:R.Z.fontWeight.semibold,...e.isMobile&&{boxShadow:"\n\t\t\t\t\t\t0 1px 0 ".concat(this.theme.buttonHoveredBackground,"\n\t\t\t\t\t")}},...this.props.style}}getSubOutlinerStyle(){const e={...this.props.style},t=this.getSidebarItemStyle(),i="number"==typeof t.paddingLeft?t.paddingLeft:this.getInitialPaddingLeft();return e.paddingLeft=i+this.getPaddingLeftUnit(),e}getInitialPaddingLeft(){return this.props.isMobile?6:14}getButtonStyle(){const{isMobile:e}=this.props;return{display:"flex",alignItems:"center",justifyContent:"center",width:e?32:20,height:e?32:20,borderRadius:3}}getButtonIconStyle(){const{isMobile:e}=this.props;return{fill:e?this.theme.lightIconColor:this.theme.sidebarTextColor,width:e?18:12}}}l()(ne,"sidebarChildrenStyle",{display:"flex",alignItems:"center"});const se=ne;var re=i(43250),ae=i(21202),le=i(35026);class de extends h.Z{constructor(...e){super(...e),l()(this,"outlinerItemTree",this.createComputedStore((()=>{const{parentStore:e}=this.props;if(e){const t=g.Z.createChildStore(e,{table:ae.iU,id:e.id});return this.getOutlinerItemsInSubtree(t,t)}return[]}))),l()(this,"handleCreatePageClick",(async()=>{const{spaceStore:e,spaceViewStore:t,type:i,onCreatePage:o}=this.props;await y.kC({environment:this.environment,spaceStore:e,spaceViewStore:t,type:i,prepend:!1})&&o&&o()})),l()(this,"handleEmptyDrop",(async e=>{const{droppedDirection:t,droppedStores:i,duplicate:o}=e,{type:n,isTopLevel:s,parentStore:r}=this.props;if(r){await y.Ar({type:n,droppedStores:i,droppedDirection:t})&&N.H5(this.environment,(e=>{y.LQ({environment:this.environment,type:n,targetParentStore:r,isTopLevelItem:s,droppedDirection:t,droppedStores:i,duplicate:o,transaction:e})}))}}))}renderComponent(){const{device:e}=this.environment,{parentStore:t,isTopLevel:i,childStores:o,disabled:s}=this.props;let r=[],a=!1;if(o)r=o.map(((e,i)=>this.renderPageItem(e,!0,i,t))),a=!0;else if(t){const e=g.Z.createChildStore(t,{table:ae.iU,id:t.id});r=this.outlinerItemTree.state,a=m.b(e)}const l=0===r.length,d=(l||this.props.isHeaderless||e.isMobile)&&this.props.showAddPageButton&&!s,c=l&&!d&&!i,h={offline:re.bl,bookmarks:re.fe,workspace:re.BE,shared:re.Jk,private:re.q1}[this.props.type];return n()(b.Z,{style:this.props.style,className:h,loaded:a,showSpinnerTimeout:3e3,spinnerSize:"1em"},void 0,r,l&&i&&this.renderEmptyDroppable(),d&&this.renderAddPageButton(),c&&this.renderEmptyChildrenPlaceholder())}renderEmptyChildrenPlaceholder(){const{device:e}=this.environment;return n()(B.Z,{style:this.props.itemStyle,isMobile:this.props.isMobile},void 0,n()("div",{style:{color:this.theme.lightTextColor,paddingLeft:12,...e.isMobile&&{display:"flex",alignItems:"center",height:32}}},void 0,n()(_._H,{defaultMessage:"No pages inside",id:"outliner.NoPagesInside.placeholder"})))}renderAddPageButton(){return n()(j.Z,{mobileFeedback:this.props.isMobile,onClick:this.handleCreatePageClick},void 0,n()(B.Z,{style:{color:this.theme.mediumTextColor},left:this.getPlusIcon(),isMobile:this.props.isMobile,disableMobileBorder:!0},void 0,this.props.addPageTitle))}renderPageItem(e,t,i,o){return n()(se,{isMobile:this.props.isMobile,type:this.props.type,spaceStore:this.props.spaceStore,spaceViewStore:this.props.spaceViewStore,store:e,style:this.props.itemStyle,toggleStyle:this.props.itemToggleStyle,isFirstItem:0===i,isTopLevelItem:t,parentStore:o,onNavigate:this.props.onNavigate,onCreatePage:this.props.onCreatePage,disabled:this.props.disabled},e.id)}renderEmptyDroppable(){const{currentBlockStore:e}=A.Z.state;if(e){const t=g.Z.createChildStore(this.props.spaceStore,e.pointer);return n()(I.Z,{store:t,canDropBelow:!0,onSelectableDrop:this.handleEmptyDrop,analyticsName:"outliner_item",shouldShowDropZone:!0})}}getPlusIcon(){return n()("div",{style:{display:"flex",alignItems:"center",justifyContent:"center"}},void 0,u.Z.plus({fill:this.theme.mediumIconColor,width:16,height:16}))}getOutlinerItemsInSubtree(e,t){return(0,le.Q2)(e,t,de.shouldSkipItemTypes,de.shouldShowItemTypes).map(((e,t)=>this.renderPageItem(e,!1,t,e.recordStoreParent())))}}l()(de,"shouldShowItemTypes",new Set([p.ZP.page,p.ZP.collectionView,p.ZP.collectionViewPage,p.ZP.alias])),l()(de,"shouldSkipItemTypes",new Set([p.ZP.factory]));const ce=de;var he=i(87531),pe=i(592),ue=i(96486),me=i.n(ue),ge=i(39634),be=i(95477),ve=i(46167),ye=i(98742),Se=i(25584),fe=i(83071),Me=i(48762),Ze=i(95009),ke=i(84908),Te=i(89101),we=i(475),Ce=i(58455);class Ie extends M.Z{getInitialState(){return{showUpdateInfo:!1}}}const Be=Ie;var xe=i(57491),Pe=i(11342),Ae=i(86646),Re=i(17256);class _e extends h.Z{constructor(...e){super(...e),l()(this,"storeTypes",{store:Be}),l()(this,"renderUpdateInfo",(()=>{const{AppUpdateStore:e}=this.environment,t=e.state.appUpdate?this.renderUpdateState("App.js - ",e.state.appUpdate):n()(_._H,{defaultMessage:"App.js - Waiting…",id:"appVersionMenuItem.waitingForAppJsUpdate.message"}),i=e.state.electronUpdate&&this.renderUpdateState("Electron - ",e.state.electronUpdate);return n()("div",{},void 0,t,i)})),l()(this,"handleResetCache",(()=>{const{AppUpdateStore:e,mobileNative:t}=this.environment;e.setState({appUpdate:void 0,electronUpdate:e.state.electronUpdate}),t&&t.resetAssetCache()})),l()(this,"handleShowUpdateInfo",(()=>{this.stores.store.setState({showUpdateInfo:!0})}))}renderComponent(){const{device:e}=this.environment,t="Notion 2.14.".concat(be.Z.version),i=n()(_._H,{id:"appVersionMenuItem.lastUpdatedTime.menuItem",defaultMessage:"Updated {lastUpdatedTime}",description:"Message to tell the user when their current version of the Notion app was last updated.",values:{lastUpdatedTime:(0,Re.Z)(be.Z.lastUpdatedTime).fromNow()}});let o=n()(c().Fragment,{},void 0,t,n()("br",{}),i);if(e.isMobileNative){const e=xe.c0(),s=n()(_._H,{defaultMessage:"Mobile {reactNativeVersionFormatted}",values:{reactNativeVersionFormatted:(0,Pe.ko)(e)},id:"appVersionMenuItem.lastUpdatedReactNativeVersion.menuItem"});o=n()(c().Fragment,{},void 0,t,n()("br",{}),s,n()("br",{}),i)}if(e.isElectron){const e=ke.zF(),s=n()(_._H,{defaultMessage:"Desktop {desktopVersionFormatted}",values:{desktopVersionFormatted:(0,Pe.ko)(e)},id:"appVersionMenuItem.desktopVersion.menuItem"});o=n()(c().Fragment,{},void 0,t,n()("br",{}),s,n()("br",{}),i)}const s=be.Z.isLocalhost||"local"===be.Z.env||"development"===be.Z.env;if(e.isMobile){const e=s&&this.stores.store.state.showUpdateInfo&&n()("div",{},void 0,this.renderUpdateInfo(),n()(j.Z,{style:{paddingTop:4},onClick:this.handleResetCache},void 0,n()(_._H,{defaultMessage:"Clear cache",id:"appVersionMenuItem.mobile.clearCache.message"})));return n()(Ae.Z,{caption:n()("div",{style:{color:this.theme.lightTextColor}},void 0,n()("div",{style:{userSelect:"none",WebkitUserSelect:"none"}},void 0,o),e),onClick:s?this.handleShowUpdateInfo:void 0})}return s?n()(x.Z,{renderTooltip:this.renderUpdateInfo,placement:x.Z.Placement.Left,render:e=>c().createElement(Ae.Z,r()({caption:n()("div",{style:{color:this.theme.lightTextColor}},void 0,o)},e))}):n()(Ae.Z,{caption:n()("div",{style:{color:this.theme.lightTextColor}},void 0,o)})}renderUpdateState(e,t){return"checking"===t.state?n()("div",{},void 0,e," ",n()(_._H,{defaultMessage:"Checking for updates…",id:"appVersionMenuItem.updateStateForApp.checking.message"})):"no-update"===t.state?n()("div",{},void 0,e," ",n()(_._H,{defaultMessage:"No update {timeFromNow}",id:"appVersionMenuItem.noUpdatesForApp.message",description:"timeFromNow is a translated message like '2 hours ago' that refers to the time of the last update.",values:{timeFromNow:(0,Re.Z)(t.timestamp).fromNow()}})):"downloading"===t.state?n()("div",{},void 0,e," ",n()(_._H,{defaultMessage:"Downloading {version} {percentComplete}",id:"appVersionMenuItem.downloadingUpdate.message",values:{percentComplete:this.props.intl.formatNumber(t.progress,{style:"percent",maximumFractionDigits:0}),version:(0,Pe.ko)(t.version)}})):"ready"===t.state?n()("div",{},void 0,e," ",n()(_._H,{defaultMessage:"Update ready {version}",id:"appVersionMenuItem.updateReady.message",values:{version:(0,Pe.ko)(t.version)}})):"error"===t.state?n()("div",{},void 0,e," ",n()(_._H,{defaultMessage:"Update error {errorMessage}",id:"appVersionMenuitem.updateError.message",values:{errorMessage:t.error&&t.error.message}})):void 0}}const Le=(0,_.XN)(_e);var Ue=i(95155),Oe=i(1643),He=i(33665),Fe=i(74350);const Ee=function(e){const{locale:t,children:i}=e;return t===Fe.SP?n()(c().Fragment,{},void 0,i):null};var De=i(5188),Ne=i(73409),Ve=i(66205),We=i(19889),qe=i(45094),ze=i(51454),Ge=i(71802),Ke=i(76248),je=i(4926);function Ye(e,t){const{theme:i,rightEdgeDistance:o}=t,n=(0,qe.TO)(e);return{position:"absolute",display:"flex",alignItems:"center",justifyContent:"center",background:i.buttonBackground,bottom:16+je.Z.state,right:o+je.Z.state,width:36,height:36,borderRadius:"100%",fontSize:20,boxShadow:i.lightBoxShadow,zIndex:ze.hT,opacity:Ge.tu.state?0:1,transform:"translateX(-".concat(n,"px) translateZ(0)"),transition:"\n\t\t\topacity ".concat(Ke.Z.transitionDuration,"ms,\n\t\t\tcolor ").concat(Ke.Z.transitionDuration,"ms,\n\t\t\ttransform 200ms\n\t\t")}}var Qe=i(74148),Xe=i(4708),Je=i(37181),$e=i(8848);var et=i(64875),tt=i(29450);class it extends h.Z{constructor(...e){super(...e),l()(this,"renderOrigin",(e=>this.props.isMobile?c().createElement(j.Z,r()({hovered:we.Z.state.open,mobileFeedback:this.props.isMobile},e),n()(B.Z,{isMobile:this.props.isMobile,left:u.Z.help({fill:this.theme.mediumIconColor,width:16,height:16}),disableMobileBorder:!0},void 0,n()(_._H,{defaultMessage:"Help & feedback",id:"helpButton.mobileHelpFeedbackButton.label"}))):c().createElement(c().Fragment,null,n()(x.Z,{renderTooltip:()=>n()("span",{},void 0,n()(_._H,{defaultMessage:"Help, feedback, and {br}keyboard shortcuts",id:"helpButton.desktopHelpButton.tooltip",values:{br:n()("br",{})}})),render:t=>c().createElement(j.Z,r()({className:"notion-help-button",style:Ye(this.environment,{theme:this.theme,rightEdgeDistance:16}),hoveredStyle:{background:this.theme.whiteButtonHoveredBackground},pressedStyle:{background:this.theme.whiteButtonPressedBackground}},(0,ye.Z)(e,t)),"?")})))),l()(this,"renderMessageItem",(e=>{const{device:t}=this.environment;return t.isElectron?this.renderMessageButton(e):n()(x.Z,{renderTooltip:()=>this.renderIntercomTooltip(),delayThreshold:0,placement:x.Z.Placement.Right,render:t=>this.renderMessageButton((0,ye.Z)(e,t))},e.key)})),l()(this,"renderSalesItem",(e=>{const{device:t}=this.environment;return t.isElectron?this.renderSalesButton(e):n()(x.Z,{renderTooltip:()=>this.renderIntercomTooltip(),delayThreshold:0,placement:x.Z.Placement.Right,render:t=>this.renderSalesButton((0,ye.Z)(e,t))},e.key)})),l()(this,"renderGuideItem",(e=>c().createElement(Me.Z,r()({},e,{isTokenTitle:!0,icon:u.Z.helpButtonGuide(this.getIconStyle()),title:n()(_._H,{defaultMessage:"Help & support guide",id:"helpButton.helpSupportGuide.menuItem"})})))),l()(this,"renderMessageButton",(e=>c().createElement(Me.Z,r()({},e,{isTokenTitle:!0,icon:u.Z.helpButtonMessage(this.getIconStyle()),title:n()(_._H,{defaultMessage:"Send us a message",id:"helpButton.sendMessage.menuItem"}),disabled:!(0,tt.qW)("preference")})))),l()(this,"renderCsatButton",(e=>c().createElement(Me.Z,r()({},e,{isTokenTitle:!0,icon:u.Z.feedback(this.getIconStyle()),title:n()(_._H,{defaultMessage:"Give feedback",id:"helpButton.giveFeedback.menuItem"})})))),l()(this,"renderOnboardingChecklistItem",(e=>{var t,i,o;const s=null===(t=A.Z.state.currentUserSettingsStore)||void 0===t||null===(i=t.getSettings())||void 0===i||null===(o=i.onboarding_checklist_settings)||void 0===o?void 0:o.highlight_in_help_center;return c().createElement(Me.Z,r()({},e,{isTokenTitle:!0,icon:u.Z.graduationCap(this.getIconStyle()),title:n()(_._H,{defaultMessage:"Notion basics",id:"helpButton.onboardingChecklist.menuItem"}),right:s&&n()("span",{style:this.getRedDotStyle()})}))})),l()(this,"renderSalesButton",(e=>c().createElement(Me.Z,r()({},e,{isTokenTitle:!0,icon:u.Z.helpButtonSales(this.getIconStyle()),title:n()(_._H,{defaultMessage:"Chat with sales",id:"helpButton.salesChat.menuItem"})})))),l()(this,"renderJoinUsItem",(e=>n()(Ee,{locale:"en-US"},void 0,c().createElement(Me.Z,r()({},e,{title:n()(_._H,{defaultMessage:"Join us",id:"helpButton.joinUs.menuItem"})}))))),l()(this,"renderKeyboardShortcutsItem",(e=>c().createElement(Me.Z,r()({},e,{title:n()(_._H,{defaultMessage:"Keyboard shortcuts",id:"helpButton.keyboardShortcuts.menuItem"})})))),l()(this,"renderNewsItem",(e=>c().createElement(Me.Z,r()({},e,{title:n()(_._H,{defaultMessage:"What's new?",id:"helpButton.whatsNew.menuItem"})})))),l()(this,"renderTermsItem",(e=>{const{device:t}=this.environment;return t.isMobile?c().createElement(Me.Z,r()({},e,{title:"Terms & privacy"})):c().createElement(Me.Z,r()({},e,{caption:"Terms & privacy"}))})),l()(this,"renderTwitterItem",(e=>{const{device:t}=this.environment;return t.isMobile?c().createElement(Me.Z,r()({},e,{title:n()(_._H,{defaultMessage:"Twitter – @{notionHandle}",id:"helpButton.mobileTwitter.menuItem",values:{notionHandle:"NotionHQ"}})})):c().createElement(Me.Z,r()({},e,{caption:n()(_._H,{defaultMessage:"Twitter – @{notionHandle}",id:"helpButton.twitter.menuItem",values:{notionHandle:"NotionHQ"}})}))})),l()(this,"renderStatusItem",(e=>{const{device:t}=this.environment;return t.isMobile?c().createElement(Me.Z,r()({},e,{title:"Status"})):c().createElement(Me.Z,r()({},e,{caption:"Status"}))})),l()(this,"acceptMessageItem",(()=>{this.analyticsTrackClickItem("help_feedback"),ge.O({environment:this.environment,from:"help_button"}),this.closePopup()})),l()(this,"acceptSalesItem",(()=>{this.analyticsTrackClickItem("sales_chat");const{currentUserStore:e}=A.Z.state,t=e&&e.getValue();Ve.Z.setState({open:!0,email:t&&t.email,name:t&&(0,We.Nz)(this.props.intl,t)}),this.closePopup()})),l()(this,"acceptCsatItem",(()=>{this.analyticsTrackClickItem("csat"),De.Z.setState({open:!0,type:Ne.og}),this.closePopup()})),l()(this,"acceptOnboardingChecklistItem",(()=>{var e;const{currentUserSettingsStore:t}=A.Z.state;if(this.analyticsTrackClickItem("onboarding-checklist"),!t)return;if(!(null==t||null===(e=t.getSettings())||void 0===e?void 0:e.onboarding_checklist_settings)){const e=N.Ue(this.environment);return Je.FK(this.environment,e,"existing"),this.closePopup(),void et.cM({level:"error",from:"helpButton",type:"acceptOnboardingChecklistItem",error:{message:"User without onboarding checklist settings initialized has access to the help button item."},data:{userId:t.id}})}Je.Y$(this.environment,{currentUserSettingsStore:t,updatedChecklistSettings:{onboarding_checklist_visibility:"visible"}}),(0,Qe.pj)(this.environment),this.closePopup()})),l()(this,"acceptGuideItem",(()=>{this.analyticsTrackClickItem("guides"),$.Db({environment:this.environment,url:(0,He.UY)("guides.guides")}),this.closePopup()})),l()(this,"acceptKeyboardShortcutsItem",(()=>{this.analyticsTrackClickItem("keyboard_shortcuts"),$.Db({environment:this.environment,url:(0,He.UY)("guides.keyboardShortcuts")}),this.closePopup()})),l()(this,"acceptTwitterItem",(()=>{this.analyticsTrackClickItem("twitter"),$.Db({environment:this.environment,url:Te._j.notionTwitter}),this.closePopup()})),l()(this,"acceptStatusItem",(()=>{this.analyticsTrackClickItem("status"),$.Db({environment:this.environment,url:Te._j.statusPage}),this.closePopup()})),l()(this,"acceptJoinUsItem",(()=>{this.analyticsTrackClickItem("join_us"),$.Db({environment:this.environment,url:Te._j.careers}),this.closePopup()})),l()(this,"acceptNewsItem",(()=>{$.Db({environment:this.environment,url:Te._j.whatsNew}),this.analyticsTrackClickItem("whats_new"),this.closePopup()})),l()(this,"acceptTermsItem",(()=>{$.Db({environment:this.environment,url:Te._j.termsAndPrivacy}),this.analyticsTrackClickItem("terms"),this.closePopup()})),l()(this,"trackClickHelp",(()=>{V.Ar6(this.environment)}))}renderComponent(){const{device:e}=this.environment,t=this.props.isMobile;return n()(ve.Z,{popupType:e.isMobile?ve.Z.PopupType.SlideUp:ve.Z.PopupType.Popup,renderOrigin:this.renderOrigin,originGap:t?0:12,placementToOrigin:t?ve.Z.Placement.Right:ve.Z.Placement.Top,alignmentToOrigin:t?ve.Z.Alignment.Center:ve.Z.Alignment.End,buttonPopupStore:we.Z,onClick:this.trackClickHelp,render:()=>{const t=this.getSections();let i;return i=e.isMobile?{menuType:Ze.ZP.MenuType.ActionSheet}:{menuType:Ze.ZP.MenuType.Popup,minWidth:208},c().createElement(Ze.ZP,i,n()(Se.Z,{type:Se.Z.Type.Vertical,initialFocus:void 0,sections:t}))}})}getSections(){const{device:e}=this.environment,t=(0,Oe.CM)(this.environment),i="team"===t||"team_free"===t||"enterprise"===t,o=!Ce.Z.state.isIntercomEnabled||(0,Oe.t)(this.environment)&&"on"===Ue.Z.getGroup("hazelnut"),n="on"===Ue.Z.getGroup("csat")&&!this.environment.device.isMobile,s=(0,Xe.GK)(this.environment)&&!e.isMobile&&function(){var e;const{currentUserSettingsStore:t}=A.Z.state;return Boolean(null==t||null===(e=t.getSettings())||void 0===e?void 0:e.onboarding_checklist_settings)}();return me().compact([{key:"guide",render:e=>c().createElement(fe.Z,e),items:me().compact([{key:"guide",action:this.acceptGuideItem,render:this.renderGuideItem},o?void 0:{key:"message",action:this.acceptMessageItem,render:this.renderMessageItem},i?{key:"sales",action:this.acceptSalesItem,render:this.renderSalesItem}:void 0,n?{key:"csat",action:this.acceptCsatItem,render:this.renderCsatButton}:void 0,s?{key:"onboarding-checklist",action:this.acceptOnboardingChecklistItem,render:this.renderOnboardingChecklistItem}:void 0])},{key:"middle section",render:e=>c().createElement(fe.Z,r()({},e,{topBorder:!0})),items:me().compact([{key:"keyboardshortcut",action:this.acceptKeyboardShortcutsItem,render:this.renderKeyboardShortcutsItem},{key:"news",action:this.acceptNewsItem,render:this.renderNewsItem},{key:"join-us",action:this.acceptJoinUsItem,render:this.renderJoinUsItem}])},{key:"botttom section",render:e=>c().createElement(fe.Z,r()({},e,{topBorder:!0})),items:me().compact([{key:"twitter",action:this.acceptTwitterItem,render:this.renderTwitterItem},{key:"terms",action:this.acceptTermsItem,render:this.renderTermsItem},{key:"status",action:this.acceptStatusItem,render:this.renderStatusItem},e.isElectron&&"production"!==be.Z.env?{key:"devtools",action:ke.d8,render:e=>c().createElement(Me.Z,r()({},e,{caption:"Open Dev Tools"}))}:void 0])},{key:"version",render:e=>c().createElement(fe.Z,r()({},e,{topBorder:!0})),items:me().compact([{key:"version",action:()=>{},render:e=>c().createElement(Le,e)}])}])}renderIntercomTooltip(){return n()("span",{},void 0,(0,tt.qW)("preference")?n()(_._H,{defaultMessage:"We use Intercom for messaging.{br}Make sure it's not blocked by your browser.",values:{br:n()("br",{})},id:"helpButton.sendUsAMessage.tooltip"}):n()(_._H,{defaultMessage:"To enable messaging, please make sure you have accepted functional cookies.{br}You can update your cookies in your Notion settings.{br}You can also contact us via email at team@makenotion.com.",values:{br:n()("br",{})},id:"helpButton.sendUsAMessage.tooltip.intercom.disabled"}))}analyticsTrackClickItem(e){V.Vaw(this.environment,{item:e})}closePopup(){var e,t;we.Z.setState({...we.Z.state,open:!1});const i=A.Z.state.currentUserSettingsStore;if(!i)return;(null===(e=A.Z.state.currentUserSettingsStore)||void 0===e||null===(t=e.getSettings().onboarding_checklist_settings)||void 0===t?void 0:t.highlight_in_help_center)&&Je.Y$(this.environment,{currentUserSettingsStore:i,updatedChecklistSettings:{highlight_in_help_center:!1}})}getIconStyle(){return{width:16,height:16,color:this.theme.regularTextColor,fill:this.theme.regularTextColor}}getRedDotStyle(){return{height:"8px",width:"8px",backgroundColor:$e.ZP.red,borderRadius:"50%",display:"inline-block"}}}const ot=(0,_.XN)(it);var nt=i(31792),st=i(70704),rt=i(97880),at=i(19522),lt=i(89940),dt=i(64215),ct=i(1533),ht=i(99064),pt=i(89733),ut=i(96650),mt=i(58879),gt=i(47307),bt=i(76668);function vt(e){const{teamStore:t}=e,[,,i]=(0,lt.oR)(t),o=(0,dt.F)(),s=(0,mt.Fy)(),a=(0,mt.O7)();return n()(x.Z,{style:Zt.tooltipStyle,textWrap:!0,renderTooltip:()=>c().createElement(c().Fragment,null,n()(_._H,{defaultMessage:"Add a page",id:"sidebar.addAPageButtonTeamToggle.tooltip"}),n()("br",{}),n()("span",{style:{color:o.mediumInvertedTextColor}},void 0,n()(_._H,{defaultMessage:"This page will be added to your team.",id:"sidebar.addAPageButtonTeamToggle.caption"}))),placement:x.Z.Placement.Right,render:e=>c().createElement(j.Z,r()({style:{height:20,width:20,marginRight:14,borderRadius:3},onClick:()=>{const{currentSpaceStore:e,currentSpaceViewStore:t}=A.Z.state;e&&t&&(y.mv({environment:a,spaceStore:e,spaceViewStore:t,teamStore:i}),s.isMobile&&bt.xv())}},e),n()("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",color:o.legacyRedSelectColor,height:20,width:20,border:"1px solid ".concat(o.outlineButtonBorder),borderRadius:3}},void 0,u.Z.plus({fill:o.mediumIconColor,width:14,height:14})))})}function yt(e){const{teamStore:t}=e,[,,i]=(0,lt.oR)(t),o=(0,dt.y)((()=>({buttonStyle:{display:"flex",alignItems:"center",justifyContent:"center",borderRadius:3,height:20,width:20,marginRight:5}})),[]),s=(0,dt.F)(),a=(0,mt.O7)(),l=(0,_.YB)();return n()(x.Z,{style:Zt.tooltipStyle,textWrap:!0,renderTooltip:()=>c().createElement(c().Fragment,null,n()(_._H,{defaultMessage:"View team and add members",id:"sidebar.outlinerTeamToggleButton.tooltip"})),placement:x.Z.Placement.Right,render:e=>n()(ve.Z,{popupType:ve.Z.PopupType.Popup,placementToOrigin:ve.Z.Placement.Right,renderOrigin:t=>c().createElement(j.Z,r()({style:o.buttonStyle,mobileFeedback:!1},e,t),u.Z.dots({fill:s.mediumIconColor,width:12,height:12})),render:e=>{const t={menuType:Ze.ZP.MenuType.Popup,width:75},o=["view","add","leave"].map((t=>({key:t,action:async()=>{switch(t){case"view":(0,oe.RF)({teamId:i.id});break;case"add":ut.ZP.setState({...ut.ZP.state,open:!0,tab:ut.aj.People,selectedTeamId:i.id});break;case"leave":await(0,oe.s)(a,{teamStore:i,currentUserId:a.currentUser.id,onLastTeamOwnerLeft:()=>{gt.PV({message:l.formatMessage({id:"teamBrowser.teamCard.LeaveTeamLast.prompt",defaultMessage:"You can’t leave this team because you’re the only team owner. Invite another team owner to leave."})})}})}e.close()},render:e=>{const{message:i,icon:o}=(()=>{switch(t){case"view":return{message:n()(_._H,{defaultMessage:"Team settings",id:"sidebar.outlinerTeamToggleButton.viewLabel"}),icon:u.Z.info({fill:s.regularIconColor,width:17})};case"add":return{message:n()(_._H,{defaultMessage:"Add members",id:"sidebar.outlinerTeamToggleButton.addLabel"}),icon:u.Z.addPerson({fill:s.regularIconColor,width:17})};case"leave":return{message:n()(_._H,{defaultMessage:"Leave team",id:"sidebar.outlinerTeamToggleButton.leaveLabel"}),color:"red",icon:u.Z.leaveArrow({fill:s.regularIconColor,width:17})};default:return(0,rt.t1)(t)}})();return c().createElement(Me.Z,r()({},e,{title:i,icon:o}))}})));return c().createElement(Ze.ZP,t,n()(Se.Z,{type:Se.Z.Type.Vertical,sections:[{key:"team section",render:e=>c().createElement(fe.Z,e),items:o}],initialFocus:void 0}))}})})}function St(e){const{teamStore:t,label:i,showDragHandle:o}=e,{icon:s,name:r}=(0,lt.VK)((()=>({icon:t.getIcon(),name:t.getName()})),[t]),[{currentSpaceViewStore:a}]=(0,lt.oR)(A.Z),l=(0,lt.VK)((()=>{var e;return a&&(null===(e=a.getValue())||void 0===e?void 0:e.joined_teams)||[]}),[a]),[d,,c]=(0,lt.oR)(void 0,ct.Z),h=(0,mt.Fy)(),p=(0,dt.y)((e=>({container:{display:"flex",alignItems:"center",width:"100%",color:e.regularTextColor,minHeight:27,paddingLeft:14},overflow:{alignSelf:"flex-end",height:22,display:"flex"}})),[]);return r?n()("div",{style:p.container,onMouseEnter:e=>{pt.Bd({store:c,event:e,disabled:!1})},onMouseMove:e=>{pt.Js({store:c,event:e,disabled:!1})},onMouseLeave:e=>{pt.iV({store:c,event:e,disabled:!1})}},void 0,!h.isMobile&&l.length>1&&(o||d.hovered)?n()(ht.Z,{iconSize:10,style:{marginRight:4,height:18}}):n()(C.Z,{disabled:!0,title:r,icon:s,size:18,isEmptyPage:!1,bucket:"public",onChange:me().identity,style:{marginRight:4},onMouseDown:e=>{e.stopPropagation()}}),n()("div",{style:{fontSize:14,fontWeight:R.Z.fontWeight.regular,width:"100%"}},void 0,i),!h.isMobile&&d.hovered&&n()("div",{style:p.overflow},void 0,n()(yt,{teamStore:e.teamStore}),n()(vt,{teamStore:e.teamStore})),h.isMobile&&n()("div",{style:p.overflow},void 0,n()(vt,{teamStore:e.teamStore}))):null}var ft=i(7755);class Mt extends h.Z{constructor(...e){super(...e),l()(this,"storeTypes",{mouseStore:nt.Z,labelMouseStore:nt.Z,outlinerToggleButtonStore:st.Z}),l()(this,"headerRef",c().createRef()),l()(this,"handleOpenModal",(e=>{const{spaceStore:t}=this.props;switch(e){case"browse":oe.tn(this.environment,{spaceStore:t});break;case"create":at.Z.setState({...at.Z.state,open:!0})}})),l()(this,"handleShowTeamModal",(e=>{oe.RF({teamId:e})})),l()(this,"handleHideClick",(()=>{const{isHidden:e}=this.stores.outlinerToggleButtonStore.state,t=!e;y.Eo({spaceViewStore:this.props.spaceViewStore,type:this.props.type,outlinerToggleButtonStore:this.stores.outlinerToggleButtonStore,newValue:t})})),l()(this,"handleCreatePageClick",(()=>{const{type:e,spaceStore:t,spaceViewStore:i}=this.props,{outlinerToggleButtonStore:o}=this.stores;y.kC({environment:this.environment,spaceStore:t,spaceViewStore:i,type:e,outlinerToggleButtonStore:o,prepend:!0})}))}willMount(e){super.willMount(e);const t=X.Z.get({userId:this.environment.currentUser.id,key:y.B8(e.spaceViewStore,e.type)});t&&this.stores.outlinerToggleButtonStore.setState({...this.stores.outlinerToggleButtonStore.state,isHidden:t})}renderComponent(){const{renderSidebar:e}=this.props,{isHidden:t}=this.stores.outlinerToggleButtonStore.state;return c().createElement("div",{ref:this.headerRef,onMouseMove:()=>this.stores.mouseStore.setState({...this.stores.mouseStore.state,mouseEntered:!0}),onMouseLeave:()=>this.stores.mouseStore.setState({...this.stores.mouseStore.state,mouseEntered:!1}),style:{marginBottom:t?0:Mt.marginBottom}},this.renderLabel(),!t&&e(this.headerRef))}renderRightLabel(){const{showAddPageButton:e,showAddTeamButton:t}=this.props;return e?this.renderAddPageButton():t?this.renderAddTeamButton():void 0}renderAddTeamButton(){return n()(x.Z,{style:Mt.tooltipStyle,textWrap:!0,renderTooltip:()=>n()(d.Fragment,{},void 0,n()(_._H,{defaultMessage:"Browse or create a team",id:"sidebar.addATeamButton.tooltip"}),n()("br",{}),n()("span",{style:{color:this.theme.mediumInvertedTextColor}},void 0,this.props.labelTooltip)),placement:x.Z.Placement.Right,render:e=>n()(ve.Z,{popupType:ve.Z.PopupType.Popup,placementToOrigin:ve.Z.Placement.Right,renderOrigin:t=>c().createElement(j.Z,r()({style:this.getPlusButtonStyle(),mobileFeedback:!1,className:re.Ji},e,t),u.Z.dots({fill:this.theme.mediumIconColor,width:12,height:12})),render:e=>{const t={menuType:Ze.ZP.MenuType.Popup,width:75},{currentSpaceStore:i}=A.Z.state;if(!i)return;const o=(i.getDisableTeamCreation()?["browse"]:["create","browse"]).map((t=>({key:t,action:()=>{this.handleOpenModal(t),e.close()},render:e=>{const i=n()(_._H,"browse"===t?{defaultMessage:"Browse teams",id:"sidebar.menuListTeam.browseLabel"}:{defaultMessage:"Create team",id:"sidebar.menuListTeam.createLabel"}),o="browse"===t?u.Z.browse({fill:this.theme.regularIconColor,width:13}):u.Z.plus({fill:this.theme.regularIconColor,width:13,height:13});return c().createElement(Me.Z,r()({},e,{title:i,icon:o}))}})));return c().createElement(Ze.ZP,t,n()(Se.Z,{type:Se.Z.Type.Vertical,sections:[{key:"team section",render:e=>c().createElement(fe.Z,e),items:o}],initialFocus:void 0}))}})})}renderLabel(){const{isHidden:e}=this.stores.outlinerToggleButtonStore.state,{labelMouseStore:t}=this.stores,{mouseEntered:i}=t.state,o={bookmarks:re.F4,workspace:re.j3,shared:re.MU,private:re.aL,offline:re.yN,team_section:re.Bd}[this.props.type],s=n()(_._H,e?{defaultMessage:"Click to show section",id:"sidebar.sectionHeaderShow.tooltip"}:{defaultMessage:"Click to hide section",id:"sidebar.sectionHeaderHide.tooltip"}),a={...this.props.isMobile?this.getMobileSectionLabelStyle():this.getSectionLabelStyle(),transition:"color 100ms ease-out",..."team"===this.props.type?{width:"100%"}:{}};i&&Object.assign(a,this.getSectionLabelHoverStyles());const l="team"===this.props.type?{width:"100%",display:"flex",alignItems:"center"}:this.getLabelButtonStyle();return n()(B.Z,{className:o,isMobile:this.props.isMobile,disableMobileBorder:e,shouldShowMobileMarginBottom:e,style:"team"===this.props.type?this.getSectionTeamItemStyle():this.getSectionSidebarItemStyle(),childrenStyle:{overflow:"visible"},right:this.renderRightLabel()},void 0,n()("div",{style:{display:"flex",alignItems:"center"}},void 0,n()(x.Z,{style:Mt.tooltipStyle,textWrap:!0,disableTooltip:"team"===this.props.type,renderTooltip:()=>n()("div",{},void 0,n()("div",{},void 0,s),n()("span",{style:{color:this.theme.mediumInvertedTextColor,whiteSpace:"nowrap"}},void 0,this.props.labelTooltip)),placement:x.Z.Placement.Top,render:e=>c().createElement(j.Z,r()({mobileFeedback:this.props.isMobile,style:l,onClick:()=>"team"===this.props.type&&this.props.isMobile?this.handleShowTeamModal(this.props.teamStore.id):(()=>{ft.Z3.set(null),this.handleHideClick()})()},(0,ye.Z)(e,{onMouseMove:()=>t.setState({...t.state,mouseEntered:!0}),onMouseLeave:()=>t.setState({...t.state,mouseEntered:!1})})),n()("span",{style:a},void 0,this.renderLabelContent()))})))}renderAddPageButton(){return n()(x.Z,{style:Mt.tooltipStyle,textWrap:!0,renderTooltip:()=>n()(d.Fragment,{},void 0,n()(_._H,{defaultMessage:"Add a page",id:"sidebar.addAPageButton.tooltip"}),n()("br",{}),n()("span",{style:{color:this.theme.mediumInvertedTextColor}},void 0,this.props.labelTooltip)),placement:x.Z.Placement.Right,render:e=>c().createElement(j.Z,r()({style:this.getPlusButtonStyle(),mobileFeedback:this.props.isMobile,onClick:this.handleCreatePageClick,className:re.Ji},e),u.Z.plus({fill:this.theme.mediumIconColor,width:12,height:12}))})}renderLabelContent(){const{type:e}=this.props;switch(e){case"bookmarks":return n()(_._H,{defaultMessage:"Favorites",id:"sidebar.favoritesSection.header"});case"workspace":return n()(_._H,{defaultMessage:"Workspace",id:"sidebar.workspaceSection.header"});case"private":return n()(_._H,{defaultMessage:"Private",id:"sidebar.privateSection.header"});case"shared":return n()(_._H,{defaultMessage:"Shared",id:"sidebar.sharedSection.header"});case"offline":return n()(_._H,{defaultMessage:"Offline",id:"sidebar.offlineSection.header"});case"team_section":return n()(_._H,{defaultMessage:"Teams",id:"sidebar.teamSection.header"});case"team":if("team"===this.props.type&&this.props.teamHeaderLabel)return n()(St,{teamStore:this.props.teamStore,showDragHandle:this.props.showDragHandle,label:this.props.teamHeaderLabel});break;default:(0,rt.t1)(e)}}getSectionSidebarItemStyle(){return{paddingTop:0,paddingBottom:0,paddingRight:14,paddingLeft:15,minHeight:24,..."team_section"===this.props.type?{marginBottom:7}:{}}}getSectionTeamItemStyle(){return{padding:0,margin:0,borderRadius:0}}getSectionLabelStyle(){return{...oe.bq(this.environment)?{textTransform:"initial",fontSize:12.5}:{textTransform:"uppercase",fontSize:11.5,letterSpacing:"0.03em"},lineHeight:1,marginBottom:1,color:this.theme.lightTextColor,fontWeight:R.Z.fontWeight.semibold}}getMobileSectionLabelStyle(){return{textTransform:oe.bq(this.environment)?"initial":"uppercase",fontSize:13,lineHeight:1,color:this.theme.lightTextColor,fontWeight:R.Z.fontWeight.semibold}}getSectionLabelHoverStyles(){return{color:this.theme.mediumTextColor}}getLabelButtonStyle(){return{display:"flex",alignItems:"center",borderRadius:3,padding:"2px 4px",marginLeft:-4,...this.props.isMobile&&{marginBottom:8}}}getPlusButtonStyle(){return{display:"flex",alignItems:"center",justifyContent:"center",borderRadius:3,height:20,width:20,border:"1px solid ".concat(this.theme.outlineButtonBorder)}}}l()(Mt,"tooltipStyle",{minWidth:200}),l()(Mt,"marginBottom",20);const Zt=Mt;var kt=i(43339),Tt=i(72087),wt=i(7765),Ct=i(12235),It=i(92166),Bt=i(73581),xt=i(66957),Pt=i(46034),At=i(16328),Rt=i(24042),_t=i(39865),Lt=i(1800),Ut=i(31299),Ot=i(88632),Ht=i(11689),Ft=i(42001),Et=i(83182),Dt=i(46247),Nt=i(33929),Vt=i(15282),Wt=i(17215);const qt=(0,_.vU)({filterByPlaceholder:{id:"sidebarTrash.filterBy.placeholder",defaultMessage:"Filter by page title…"}});class zt extends h.Z{constructor(...e){super(...e),l()(this,"storeTypes",{requestStore:Tt.Z}),l()(this,"renderTrashPages",((e,t)=>{const{device:i}=this.environment,o=t?t.results:[],{currentBlockStore:s}=A.Z.state;if(!s)return;const a=o.map((e=>g.Z.createChildStore(s,{table:ae.iU,id:e}))).filter((e=>e.getValue()&&!kt.Z.state.excludePages.has(e.id))).map((e=>({key:e.id,action:({event:t})=>{if(t.metaKey){const t=(0,Lt.Z)({baseUrl:be.Z.domainBaseUrl,pageId:e.id});$.Db({environment:this.environment,url:t})}else $._c({environment:this.environment,store:e}),Ht.Z.setState({...Ht.Z.state,open:!1});i.isMobile&&bt.xv()},render:t=>c().createElement(Rt.Z,r()({},t,{dontShrinkRight:!0,store:e,right:n()("div",{style:{display:"flex"}},void 0,n()(x.Z,{placement:x.Z.Placement.Bottom,renderTooltip:()=>n()(_._H,{defaultMessage:"Restore",id:"sidebarTrash.restorePageButton.tooltip"}),render:t=>c().createElement(Ft.Z,r()({isGray:!0,onClick:()=>this.handleRestoreClick(e)},t),u.Z.undo({width:18,height:18}))}),n()(x.Z,{placement:x.Z.Placement.Bottom,renderTooltip:()=>n()(_._H,{defaultMessage:"Delete permanently",id:"sidebarTrash.deletePagePermanentlyButton.tooltip"}),render:t=>c().createElement(Ft.Z,r()({isGray:!0,onClick:()=>this.handleDeleteClick(e)},t),u.Z.trash({width:18,height:18}))}))}))})));return 0===a.length?n()(fe.Z,{},void 0,i.isMobile?n()(At.Z,{title:n()(_._H,{defaultMessage:"No matches found.",id:"sidebarTrash.mobileFilterBy.noMatchesPrompt"})}):n()("div",{style:{fontSize:14,color:this.theme.mediumTextColor,textAlign:"center"}},void 0,n()(_._H,{defaultMessage:"No matches found.",id:"sidebarTrash.filterBy.noMatchesPrompt"}))):n()(d.Fragment,{},void 0,n()(Se.Z,{type:Se.Z.Type.Vertical,initialFocus:void 0,sections:[{key:0,items:a,render:e=>c().createElement(fe.Z,e)}]}),n()(It.Z,{show:this.stores.requestStore.state.loading,showDelay:500,showHold:200,render:e=>{if(e)return n()("div",{style:{height:44,display:"flex",flex:1,alignItems:"center",justifyContent:"center"}},void 0,n()(W.Z,{}))}}),n()(Ct.Z,{onChange:this.handleScrollOffsetChange}))})),l()(this,"handleSwipeLeft",(()=>{const e=zt.tabs.indexOf(kt.Z.state.currentTab)+1,t=zt.tabs[e];void 0!==t&&this.changeTab(t)})),l()(this,"handleSwipeRight",(()=>{const e=zt.tabs.indexOf(kt.Z.state.currentTab)-1,t=zt.tabs[e];void 0!==t&&this.changeTab(t)})),l()(this,"handleTabChange",(e=>{const t=zt.tabs[e];this.changeTab(t)})),l()(this,"handleRestoreClick",(e=>{const{currentSpaceStore:t}=A.Z.state;t&&_t.cB({environment:this.environment,block:e,spaceId:e.pointer.spaceId||t.id})})),l()(this,"handleDeleteClick",(e=>{_t.Rn({environment:this.environment,blocks:[e]})})),l()(this,"handleSearchInputChange",(e=>{kt.Z.setState({...kt.Z.state,filter:e.target.value,limit:kt.Z.startLimit})})),l()(this,"handleClose",(()=>{Ht.Z.setState({...Ht.Z.state,open:!1})})),l()(this,"handleScrollOffsetChange",(e=>{const{requestStore:t}=this.stores,{ready:i,loading:o,result:n}=t.state,s=n;e<=kt.Z.loadMoreOffset&&s&&i&&!o&&!s.endOfResultsReached&&kt.Z.setState({...kt.Z.state,limit:kt.Z.state.limit+kt.Z.limitIncrement})})),l()(this,"performSearchRequest",(async e=>{const{currentSpaceStore:t,currentBlockStore:i}=A.Z.state;if(!t||!i)return;const{limit:o,filter:n,currentTab:s}=kt.Z.state;let r;if("in_current_page"===s)if(i.isCollectionView()){const e=i.getValue();if(!e)return;const t=(0,Wt.kW)(e);if(!t)return;r=t.id}else r=i.id;return await Ut.bI({environment:this.environment,query:n,limit:o,ancestorId:r,spaceId:t.id})}))}willMount(e){super.willMount(e),kt.Z.setState({...kt.Z.state,filter:"",limit:kt.Z.startLimit,excludePages:new Set})}renderComponent(){const{device:e}=this.environment;let t;return t=e.isMobile?{menuType:Ze.ZP.MenuType.Modal,title:n()(_._H,{defaultMessage:"Trash",id:"sidebarTrash.menu.header"}),left:this.renderMobileHelpButton(),right:n()(Vt.DoneMenuText,{}),onClickRight:this.handleClose,header:this.renderHeader()}:{menuType:Ze.ZP.MenuType.Popup,height:"50vh",width:414,header:this.renderHeader(),footer:this.renderFooter()},n()(Pt.Z,{onSwipeLeft:this.handleSwipeLeft,onSwipeRight:this.handleSwipeRight,render:e=>c().createElement(Ze.ZP,r()({},t,e,{className:re.TY}),this.renderPages())})}renderHeader(){const{device:e}=this.environment,t=kt.Z.state.currentTab,i=zt.tabs.indexOf(t);return n()(d.Fragment,{},void 0,n()(xt.Z,{tabs:[n()(_._H,{defaultMessage:"All pages",id:"sidebarTrash.allPages.tabHeader"}),n()(_._H,{defaultMessage:"In current page",id:"sidebarTrash.inCurrentPage.tabHeader"})],selectedIndex:i,onChange:this.handleTabChange}),n()("div",{style:{margin:e.isMobile?0:"10px 0"}},void 0,n()(Bt.Z,{left:n()(It.Z,{show:this.stores.requestStore.state.loading,showDelay:500,showHold:200,render:e=>e?n()(W.Z,{style:this.getSearchIconStyle()}):u.Z.searchThick(this.getSearchIconStyle())}),style:{...e.isAndroid&&{borderBottom:"none"}},showClearButton:!0,placeholder:Nt.Z.formatMessage(qt.filterByPlaceholder),focus:!e.isMobile||void 0,value:kt.Z.state.filter,onChange:this.handleSearchInputChange})))}renderFooter(){return n()(fe.Z,{topBorder:!0,disableDesktopPadding:!0},void 0,n()(Et.Z,{title:n()(_._H,{defaultMessage:"Learn about deleting and restoring pages",id:"sidebarTrash.learnMore.prompt"}),href:(0,He.UY)("guides.trash"),analyticsFrom:"trash"}))}renderMobileHelpButton(){return n()(Dt.Z,{href:(0,He.UY)("guides.trash"),analyticsFrom:"trash"})}renderPages(){if(!Ot.Z.state.online)return n()(fe.Z,{},void 0,n()(At.Z,{title:n()(_._H,{defaultMessage:"Please go online to view the Trash.",id:"sidebarTrash.goOnline.prompt"})}));{const{filter:e,limit:t,currentTab:i}=kt.Z.state,o="".concat(e,":").concat(t).concat(i);return n()(wt.Z,{requestStore:this.stores.requestStore,request:o,performRequest:this.performSearchRequest,render:this.renderTrashPages,debounce:Ut.vp})}}changeTab(e){kt.Z.setState({...kt.Z.state,currentTab:e,limit:kt.Z.startLimit}),this.stores.requestStore.setState({...this.stores.requestStore.state,result:null}),V.vqh(this.environment,{tab:e})}getSearchIconStyle(){return{width:14,height:14,marginRight:6,flexGrow:0,flexShrink:0,color:this.theme.regularIconColor}}}l()(zt,"tabs",["all_pages","in_current_page"]);const Gt=zt;var Kt=i(42858);class jt extends h.Z{constructor(...e){super(...e),l()(this,"renderOrigin",(e=>{const{onClick:t,...i}=(0,ye.Z)(e,{onClick:this.props.onClick,onMouseEnter:this.props.onMouseEnter,onMouseLeave:this.props.onMouseLeave});return n()(I.Z,{store:this.clonedStore,canDropOnto:!0,onSelectableDrop:this.handleDrop,analyticsName:"sibebar_trash",shouldShowDropZone:!0},void 0,c().createElement(j.Z,r()({},i,{onClick:t||this.handleClick,mobileFeedback:this.props.isMobile}),n()(B.Z,{left:this.renderIcon(),style:{...Ht.Z.state.open&&{background:this.theme.buttonHoveredBackground}},isMobile:this.props.isMobile,disableMobileBorder:!0},void 0,n()(_._H,{defaultMessage:"Trash",id:"sidebarTrashButton.text"}))))})),l()(this,"renderSidebarTrash",(()=>{const{currentSpaceStore:e}=A.Z.state;if(e)return n()(Gt,{spaceStore:e})})),l()(this,"handleClick",(e=>{kt.Z.setState({...kt.Z.state,currentTab:"all_pages"}),V.YFJ(this.environment)})),l()(this,"handleDrop",(e=>{const{droppedStores:t,duplicate:i}=e;i||N.H5(this.environment,(e=>{Kt.Cl({environment:this.environment,blocks:t,transaction:e})}))}))}willMount(e){super.willMount(e),this.clonedStore=e.store.clone()}renderComponent(){const{device:e}=this.environment;return n()(ve.Z,{popupType:e.isMobile?ve.Z.PopupType.SlideUp:ve.Z.PopupType.Popup,buttonPopupStore:Ht.Z,alignmentToOrigin:ve.Z.Alignment.Start,placementToOrigin:ve.Z.Placement.Right,originGap:0,onClick:this.handleClick,isFullWidthOnMobile:!0,render:this.renderSidebarTrash,preventScaleTransition:!0,renderOrigin:this.renderOrigin})}renderIcon(){const{device:e}=this.environment,t=this.theme.mediumIconColor;return e.isMobile?u.Z.sidebarTrash({fill:t,height:16}):u.Z.sidebarTrash({fill:t,width:14})}}const Yt=jt;var Qt=i(47590),Xt=i(61045),Jt=i(14786),$t=i(15311);class ei extends h.Z{constructor(...e){super(...e),l()(this,"handleClose",(()=>{Jt.Z.setState({open:!1})}))}renderComponent(){const{device:e}=this.environment,t=Jt.Z.state.open;return n()(ve.Z,{popupType:e.isMobile?ve.Z.PopupType.SlideUp:ve.Z.PopupType.Popup,buttonPopupStore:Jt.Z,renderOrigin:e=>c().createElement(j.Z,r()({mobileFeedback:this.props.isMobile},e),n()(B.Z,{left:u.Z.sidebarSettings({fill:this.theme.mediumIconColor,width:16}),style:{background:t?this.theme.buttonHoveredBackground:"none"},isMobile:this.props.isMobile,disableMobileBorder:!0},void 0,n()(_._H,{defaultMessage:"Notifications & settings",id:"notificationSettingsButton.mobileSidebar.label"}))),render:()=>{let t;return t=e.isMobile?{menuType:Ze.ZP.MenuType.Modal,title:n()(_._H,{defaultMessage:"Notifications & settings",id:"notificationSettingsButton.mobileSidebar.title"}),right:n()(_._H,{defaultMessage:"Done",id:"notificationSettingsButton.rightActionButton.done"}),onClickRight:this.handleClose,whiteBackground:!0}:{menuType:Ze.ZP.MenuType.Popup},c().createElement(Ze.ZP,t,n()($t.Z,{isMobile:!0}))}})}}const ti=ei;var ii=i(90287);class oi extends h.Z{renderComponent(){const e=n()(_._H,{defaultMessage:"Upgrade to Pro",id:"upgradeMobileButton.upgradeButton.label"});return n()(j.Z,{mobileFeedback:!0,onClick:this.showUpgradeModal(this.environment)},void 0,n()(B.Z,{left:this.renderIcon(),isMobile:!0,disableMobileBorder:!0},void 0,e))}renderIcon(){return u.Z.settingsUpgradeFilled({fill:this.theme.mediumIconColor,width:16})}showUpgradeModal(e){return()=>{(0,V.sA6)(e,{from:"mobile_sidebar",for_subscription_tier:"personal"});const{mobileNative:t}=e;t&&t.openUpgradeModal((0,ii.Bs)())}}}const ni=oi;var si=i(27386),ri=i(46951),ai=i(10118),li=i(61766);const di=new li.Z;class ci extends h.Z{constructor(...e){super(...e),l()(this,"handleClose",(()=>{di.setState({open:!1})}))}renderComponent(){if(!Oe.lw(this.environment))return;const{store:e}=this.props;return n()(ve.Z,{buttonPopupStore:di,popupType:ve.Z.PopupType.SlideUp,renderOrigin:e=>c().createElement(j.Z,r()({mobileFeedback:!0},e),n()(B.Z,{left:this.renderIcon(),isMobile:!0,disableMobileBorder:!0},void 0,n()(_._H,{defaultMessage:"Members",id:"memberSettingsButton.mobileSidebar.label"}))),render:()=>{if(Ot.Z.state.online){const t={menuType:Ze.ZP.MenuType.Modal,title:n()(_._H,{defaultMessage:"Members",id:"memberSettingsButton.mobileMemberSettings.title"}),right:n()(_._H,{defaultMessage:"Done",id:"memberSettingsButton.rightActionButton.done"}),onClickRight:this.handleClose};return c().createElement(Ze.ZP,t,n()(ai.Z,{store:e,isMobile:!0}))}this.renderOffline()}})}renderIcon(){return u.Z.teamSize({fill:this.theme.mediumIconColor,width:16})}renderOffline(){return n()(si.Z,{},void 0,n()(ri.Z,{isSmall:!0,style:{textAlign:"center"}},void 0,n()(_._H,{defaultMessage:"Please go online to manage members.",id:"memberSettingsButton.goOnline.prompt"})))}}const hi=ci;var pi=i(89206),ui=i(29477),mi=i(29337);const gi=200;class bi extends h.Z{constructor(...e){super(...e),l()(this,"handleTouchStart",(e=>{const t={x:e.touches[0].clientX,y:e.touches[0].clientY};ft.TC.state?t.x>(0,qe.qG)(this.environment)?mi.Z.setState({touching:!0,swiping:!1,start:t}):this.handleReset():(0,qe.YR)(this.environment)&&t.x<100?mi.Z.setState({touching:!0,swiping:!1,start:t}):this.handleReset()})),l()(this,"handleTouchMove",(e=>{if(Q.Z.state.isDragging)return void this.handleReset();const t=mi.Z.state;if(!t.touching)return;const i={x:e.touches[0].clientX,y:e.touches[0].clientY};if(t.swiping)mi.Z.setState({touching:!0,swiping:!0,start:t.start,speed:ft.TC.state?t.end.x-i.x:i.x-t.end.x,end:i});else{if(Math.abs(i.y-t.start.y)>=25)return void this.handleReset();(!ft.TC.state&&i.x-t.start.x>25||ft.TC.state&&t.start.x-i.x>25)&&mi.Z.setState({touching:!0,swiping:!0,start:t.start,speed:0,end:i})}this.updateTransform()})),l()(this,"handleTouchEnd",(async()=>{const{ThemeStore:e}=this.environment,t=mi.Z.state;if(!t.swiping)return;const i=(0,qe.qG)(this.environment),o=document.querySelector((0,qe.YR)(this.environment)?".".concat(re.yk):".".concat(re.Wi)),n=document.querySelector(".".concat(re.Wi)),s=Math.abs(t.speed)>=8,r=s?"ease-out":"ease-in-out",a="dark"===e.state.mode?", 1px 0 0 ".concat(this.theme.shadowColor.alpha(2*this.theme.shadowOpacity).css()):"",l="\n\t\t\t".concat(this.theme.mediumBoxShadow,"\n\t\t\t").concat(a,"\n\t\t");if(ft.TC.state){const e=t.start.x-t.end.x;if(e+25*t.speed>i/2){let t=s?(i-e)/i*gi:gi;t=Math.max(t,1),o.style.transition="transform ".concat(t,"ms ").concat(r),o.style.transform="translateZ(0)translateX(0px)",(0,qe.YR)(this.environment)&&(o.style.boxShadow=l,n.style.transition="filter ".concat(t,"ms ").concat(r),n.style.filter="brightness(1)"),await yi(o),bt.xv(),this.handleReset()}else o.style.transition="transform ".concat(gi,"ms ").concat(r),o.style.transform="translateZ(0)translateX(".concat(i,"px)"),(0,qe.YR)(this.environment)&&(o.style.boxShadow=l,n.style.transition="filter ".concat(gi,"ms ").concat(r),n.style.filter="brightness(0.7)"),await yi(o),this.handleReset()}else{const e=t.end.x-t.start.x;if(e+25*t.speed>i/2){let t=s?(i-e)/i*gi:gi;t=Math.max(t,1),o.style.transition="transform ".concat(t,"ms ").concat(r),o.style.transform="translateZ(0)translateX(".concat(i,"px)"),(0,qe.YR)(this.environment)&&(o.style.boxShadow=l,n.style.transition="filter ".concat(t,"ms ").concat(r),n.style.filter="brightness(0.7)"),await yi(o),bt.bA(),this.handleReset()}else o.style.transition="transform ".concat(gi,"ms ").concat(r),o.style.transform="translateZ(0)translateX(0px)",(0,qe.YR)(this.environment)&&(o.style.boxShadow=l,n.style.transition="filter ".concat(gi,"ms ").concat(r),n.style.filter="brightness(1)"),await yi(o),this.handleReset()}})),l()(this,"handleSidebarToggle",(()=>{this.updateTransform()})),l()(this,"updateTransform",(()=>{const e=document.querySelector((0,qe.YR)(this.environment)?".".concat(re.yk):".".concat(re.Wi)),t=document.querySelector(".".concat(re.Wi)),i=(0,qe.qG)(this.environment),o=mi.Z.state;if(o.swiping)if(ft.TC.state){const n=i-(o.start.x-o.end.x)+25,s=Math.min(Math.max(0,n),i);if(e.style.transition="none",e.style.transform="translateZ(0)translateX(".concat(s,"px)"),(0,qe.YR)(this.environment)){e.style.boxShadow=this.theme.mediumBoxShadow,t.style.transition="none";const o=(1-.3*s/i).toString();t.style.filter="brightness(".concat(o,")")}}else{const n=o.end.x-o.start.x-25,s=Math.min(Math.max(0,n),i);if(e.style.transition="none",e.style.transform="translateZ(0)translateX(".concat(s,"px)"),(0,qe.YR)(this.environment)){e.style.boxShadow=this.theme.mediumBoxShadow,t.style.transition="none";const o=(1-.3*s/i).toString();t.style.filter="brightness(".concat(o,")")}}else ft.TC.state?(e.style.transition="transform 200ms",e.style.transform="translateZ(0)translateX(".concat(i,"px)"),(0,qe.YR)(this.environment)&&(e.style.transform="translateZ(0)translateX(calc(".concat(i,"px - 1px))"),e.style.boxShadow=this.theme.mediumBoxShadow,t.style.transition="filter 200ms",t.style.filter="brightness(0.7)"),q.ZH(this.environment)):(e.style.transition="transform 200ms",e.style.transform="translateZ(0)translateX(0)",(0,qe.YR)(this.environment)&&(e.style.boxShadow="none",t.style.transition="filter 200ms",t.style.filter="brightness(1)"))}))}didMount(){const{device:e}=this.environment;e.isMobile&&(window.addEventListener("touchstart",this.handleTouchStart),window.addEventListener("touchmove",this.handleTouchMove),window.addEventListener("touchend",this.handleTouchEnd),ft.TC.addListener(this.handleSidebarToggle))}willUnmount(){const{device:e}=this.environment;e.isMobile&&(window.removeEventListener("touchstart",this.handleTouchStart),window.removeEventListener("touchmove",this.handleTouchMove),window.removeEventListener("touchend",this.handleTouchEnd),ft.TC.removeListener(this.handleSidebarToggle))}handleReset(){mi.Z.reset(),this.updateTransform()}}const vi=bi;async function yi(e){const t=ui.UZ();e.addEventListener("transitionend",t.resolve),e.addEventListener("webkitTransitionEnd",t.resolve),await t.promise,e.removeEventListener("transitionend",t.resolve),e.removeEventListener("webkitTransitionEnd",t.resolve)}var Si=i(45589),fi=i(45010),Mi=i(13548),Zi=i(41507),ki=i(37871),Ti=i(81676),wi=i(29974),Ci=i(39849),Ii=i(19757);class Bi extends h.Z{renderComponent(){const{device:e}=this.environment,{id:t,onClick:i,focused:o,isAddButton:s,title:a,caption:l,shortcut:d,tooltipMessage:h,disableTooltip:p,disabled:m,showDragHandle:g}=this.props,b=this.environment.device.isMobile,v=this.props.isCheck;return n()(x.Z,{renderTooltip:()=>h,disableTooltip:p,placement:Ii.ug.Bottom,render:t=>c().createElement(j.Z,r()({},t,{mobileFeedback:this.environment.device.isMobile,onClick:i,hovered:o,disabled:m,style:this.getStyle()}),g&&this.renderDragHandle(),s?this.renderAddIcon():this.renderIcon(),n()("div",{style:{marginLeft:12,marginRight:d||v?12:0,minWidth:0}},void 0,n()(ri.Z,{className:"notranslate",isMobile:e.isMobile},void 0,a),l&&n()(ri.Z,{isSmall:!0,isMobile:e.isMobile},void 0,l)),v&&u.Z.check({width:16,height:16,marginLeft:"auto"}),d&&!b&&!v&&n()("div",{style:this.getShortcutStyle()},void 0,d))},"sidebarswitchermenuitem-tooltip-".concat(t))}renderDragHandle(){return n()(ht.Z,{iconSize:12,style:{marginLeft:-6,marginRight:4,visibility:this.props.isAddButton?"hidden":"visible"}})}renderIcon(){const e=this.environment.device.isMobile;return n()("div",{style:{display:"flex",alignItems:"center"}},void 0,n()("div",{style:{position:"relative"}},void 0,this.props.id&&n()(C.Z,{disabled:!0,icon:this.props.icon,isEmptyPage:!1,title:this.props.title,size:e?Bi.mobileIconSize:Bi.desktopIconSize,isLarge:!0}),n()(Ci.Z,{color:Ci.Z.Color.Red,count:this.props.unreadMentions,style:{position:"absolute",top:-5,right:-5}})))}renderAddIcon(){const e=this.environment.device.isMobile?Bi.mobileIconSize:Bi.desktopIconSize;return n()("div",{style:{...this.getIconWrapStyle(),width:e,height:e}},void 0,this.getPlusIcon())}getStyle(){const e=this.environment.device.isMobile,{WindowSizeStore:t}=this.environment,{disabled:i}=this.props;return{display:"flex",alignItems:"center",lineHeight:"120%",width:"100%",paddingTop:e?8:4,paddingBottom:e?8:4,paddingLeft:e?t.getSafePaddingLeftCSS(16):14,paddingRight:e?t.getSafePaddingRightCSS(16):14,...e&&{boxShadow:"0 1px 0 ".concat(this.theme.regularDividerColor)},marginBottom:1,fontSize:e?16:14,...e&&{background:this.theme.popoverBackground},height:e?54:48,...this.props.isAddButton&&!e&&{boxShadow:"none",marginBottom:0},...i&&{opacity:.4}}}getPlusIcon(){return u.Z.plus({flexGrow:0,flexShrink:0,width:16,height:16,fill:this.theme.popoverBackground})}getIconWrapStyle(){return{width:32,height:32,display:"flex",alignItems:"center",justifyContent:"center",background:this.theme.lightIconColor,borderRadius:3,flexShrink:0}}getShortcutStyle(){return{color:this.theme.lightTextColor,fontSize:12,whiteSpace:"nowrap",marginLeft:"auto",flexShrink:0}}}l()(Bi,"contextTypes",{...Ze.ff}),l()(Bi,"mobileIconSize",36),l()(Bi,"desktopIconSize",32),l()(Bi,"dragHandleEffectiveWidth",16);const xi=Bi;var Pi=i(52858);class Ai extends h.Z{constructor(...e){super(...e),l()(this,"storeTypes",{buttonPopupStore:li.Z})}renderComponent(){const{device:e}=this.environment;let t;return t=e.isMobile?{menuType:Ze.ZP.MenuType.ActionSheet}:{menuType:Ze.ZP.MenuType.Popup},n()("div",{style:this.getContainerStyle()},void 0,n()("div",{style:this.getTextStyle()},void 0,this.props.emailAddress),n()(ve.Z,{popupType:e.isMobile?ve.Z.PopupType.SlideUp:ve.Z.PopupType.Popup,buttonPopupStore:this.stores.buttonPopupStore,renderOrigin:e=>{if(!this.props.disabled)return c().createElement(j.Z,r()({},e,{style:this.getButtonStyle()}),u.Z.dots(this.getButtonIconStyle()))},render:()=>c().createElement(Ze.ZP,t,n()(Pi.Z,{sections:[{key:"option section",render:e=>c().createElement(fe.Z,e),actions:this.props.accountActions}],context:{environment:this.environment,blocks:[],publicEditMode:void 0}}))}))}getButtonStyle(){const{device:e}=this.environment;return{display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,width:e.isMobile?24:20,height:e.isMobile?24:20,borderRadius:3}}getButtonIconStyle(){const{device:e}=this.environment;return{width:e.isMobile?18:12,height:e.isMobile?18:12}}getContainerStyle(){return{marginTop:this.environment.device.isMobile?20:8,marginLeft:12,marginRight:12,display:"flex",alignItems:"center",justifyContent:"space-between",color:this.theme.mediumTextColor}}getTextStyle(){return{fontSize:this.environment.device.isMobile?14:11,lineHeight:R.Z.lineHeight.UISmall.desktop,fontWeight:R.Z.fontWeight.medium}}}const Ri=Ai;var _i=i(98726),Li=i(62213),Ui=i(76487),Oi=i(81236),Hi=i(39153);class Fi extends h.Z{renderComponent(){return n()("div",{style:this.getPlaceholderPageStyle()},void 0,this.props.showIcon&&u.Z.templates({width:16,height:16,fill:this.theme.buttonHoveredBackground}),n()("div",{style:this.getPlaceholderTextWrapStyle()},void 0,n()("div",{style:Fi.getPlaceholderTextStyle(this.theme)})))}getPlaceholderPageStyle(){return{height:28,display:"flex",alignItems:"center",width:"100%",padding:this.props.showIcon?"0 15px":"0 0px"}}getPlaceholderTextWrapStyle(){return{flexGrow:1,marginLeft:this.props.showIcon?10:0,height:28,display:"flex",alignItems:"center"}}static getPlaceholderTextStyle(e){const t=Math.ceil(60),i=Math.floor(85),o=Math.floor(Math.random()*(i-t+1))+t,n="".concat(o,"%");return{height:4,background:e.buttonHoveredBackground,width:n}}}const Ei=Fi;var Di=i(38755);class Ni extends h.Z{willMountOrUpdate(){"store"===this.props.type&&this.props.spaceStore.getValue()}renderComponent(){const{device:e}=this.environment,{props:t}=this,{activeUserEmailAddress:i,isMobile:o,style:s,showExpand:r}=t,a="store"===t.type?(0,Di.getSpaceName)(this.environment,t.spaceStore):t.spaceName;return n()(B.Z,{style:{overflow:"hidden",width:"100%",...o&&{fontSize:14,padding:0,marginRight:12},...s||{}},left:a?this.renderRecordIcon(a,"store"===t.type?void 0:t.spaceIcon,o,"store"===t.type?t.spaceStore:void 0):this.renderPlaceholderRecordIcon(),isMobile:o,disableMobileBorder:!0},void 0,!a&&this.renderPlaceholderTitle(),a&&n()("div",{style:{display:"flex",alignItems:"center",justifyContent:i?"space-between":"start"},className:"notranslate"},void 0,n()("div",{style:{display:"flex",flexDirection:"column",marginRight:6,marginTop:e.isAndroid?3:0,...Ni.truncateStyle}},void 0,n()("div",{style:{color:this.theme.regularTextColor,fontWeight:R.Z.fontWeight.medium,...Ni.truncateStyle}},void 0,a),n()("div",{style:{color:this.theme.mediumTextColor,fontSize:11,lineHeight:"12px",fontWeight:R.Z.fontWeight.regular,...Ni.truncateStyle}},void 0,i)),r&&n()("div",{style:{flexGrow:0,flexShrink:0,width:12,height:12,fill:this.theme.mediumIconColor}},void 0,u.Z.expand())))}renderRecordIcon(e,t,i,o){const s=o?(0,Di.getSpaceIcon)(this.environment,o):t?{icon:t,pointer:{table:"space",id:"undefined"}}:void 0,r=o?(0,Di.getSpaceName)(this.environment,o):e;return n()(C.Z,{disabled:!0,icon:s,isEmptyPage:!1,title:r,size:i?24:20,style:{marginTop:1,color:this.theme.regularTextColor}})}renderPlaceholderRecordIcon(){return n()("div",{style:{opacity:.25}},void 0,n()(Hi.Z,{size:20,title:void 0}))}renderPlaceholderTitle(){return n()(Ei,{showIcon:!1})}}l()(Ni,"truncateStyle",{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"});const Vi=Ni;var Wi=i(46911),qi=i(31079),zi=i(17364);const Gi=new li.Z,Ki=new li.Z;var ji=i(64307),Yi=i(28497);class Qi extends h.Z{constructor(...e){super(...e),l()(this,"storeTypes",{loginStore:qi.Z,loginPermissionsStore:Wi.Z,loginModalStore:Yi.Z}),l()(this,"renderAccountActionModal",((e,t)=>{let i,o;switch(e){case"add-account":i=n()(_._H,{id:"sidebarSwitcherMultiAccount.addAccount.title",defaultMessage:"Add an account",description:"Title to add an account"}),o=n()(_._H,{id:"sidebarSwitcherMultiAccount.addAccount.description",defaultMessage:"Use an existing account, or sign up with a new email. Your current account will remain logged in.",description:"Description when adding an account"});break;case"create-work":i=n()(_._H,{id:"sidebarSwitcherMultiAccount.createWork.title",defaultMessage:"Create a work account",description:"Title to create a work account"}),o=n()(_._H,{id:"sidebarSwitcherMultiAccount.createWork.description",defaultMessage:"We’ll check if your teammates are already on Notion. If not, we’ll create a new home for you and your team.",description:"Description when creating a work account"});break;default:throw new Error(this.props.intl.formatMessage({defaultMessage:"Unexpected createType in SidebarSwitcherMultiAccount",id:"sidebarSwitcherMultiAccount.errorMessage"}))}return n()(ji._,{loginModalStore:this.stores.loginModalStore,title:i,description:o,disableLoginLink:this.props.disableLoginLink,className:re.zY,redirectURL:this.props.redirectURL,onDismiss:t})})),l()(this,"getAccountActionStyle",(()=>{const{device:e}=this.environment;return{display:"flex",color:this.theme.mediumTextColor,whiteSpace:"nowrap",fontSize:e.isMobile?16:12}}))}willMount(e){super.willMount(e);const{loginStore:t}=this.stores;"email"===t.state.loginType&&this.environment.device.isMobile&&t.setState({...t.state,loginType:"google"})}renderComponent(){const{online:e}=Ot.Z.state,{device:t}=this.environment,{createType:i}=this.props;return t.isMobile?n()(ve.Z,{popupType:ve.Z.PopupType.SlideUp,buttonPopupStore:"add-account"===i?Ki:Gi,alignmentToOrigin:ve.Z.Alignment.Start,placementToOrigin:ve.Z.Placement.Top,originGap:0,isFullWidthOnMobile:!0,render:e=>this.renderAccountActionModal(i,(()=>{e.close()})),preventScaleTransition:!0,renderOrigin:t=>c().createElement(Me.Z,r()({focused:!1,disabled:!e,title:this.renderMenuButtonLoginTitle(i)},t))}):n()("div",{onClick:()=>{e&&(V.D6i(this.environment,{createType:i}),zi.Z.setState({...zi.Z.getState(),createType:i}),this.stores.loginModalStore.setState({open:!0}))}},void 0,n()(Me.Z,{focused:!1,disabled:!e,title:this.renderMenuButtonLoginTitle(i)}),this.renderAccountActionModal(i))}renderMenuButtonLoginTitle(e){switch(e){case"create-work":return n()("div",{style:this.getAccountActionStyle()},void 0,n()(_._H,{defaultMessage:"Create work account",id:"sidebarSwitcherMultiAccount.menuItem.createWorkAccountButton.label"}));case"add-account":return n()("div",{style:this.getAccountActionStyle()},void 0,n()(_._H,{defaultMessage:"Add another account",id:"sidebarSwitcherMultiAccount.addAccountButton.label"}))}}}const Xi=(0,_.XN)(Qi);var Ji=i(19662),$i=i(86512),eo=i(66079),to=i(65452),io=i(16691),oo=i(45953),no=i(77858),so=i(98459),ro=i(29538),ao=i(59488);let lo;!function(e){e[e.Regular=0]="Regular",e[e.DesktopMac=1]="DesktopMac",e[e.Mobile=2]="Mobile"}(lo||(lo={}));class co extends h.Z{constructor(...e){super(...e),l()(this,"storeTypes",{loginStore:qi.Z,loginPermissionsStore:Wi.Z}),l()(this,"height",{[lo.Regular]:Ke.Z.defaultHeight,[lo.DesktopMac]:Ke.Z.desktopMacHeight,[lo.Mobile]:"auto"}),l()(this,"handleDesktopAppClick",(()=>{const{device:e}=this.environment;this.close(),e.isWindows?V.dyr(this.environment,{from:"sidebar",platform:"windows"}):V.dyr(this.environment,{from:"sidebar",platform:"mac"})})),l()(this,"handleMobileAppClick",(()=>{this.close(),V.YY6(this.environment,{from:"sidebar"})})),l()(this,"handleClick",(()=>{Li.Z.setState({...Li.Z.state,open:!0}),V.air(this.environment),zi.Z.getUserIds(this.environment).forEach((e=>{zi.Z.getSpaceViewStores(this.environment,e).forEach((t=>{const i=t.getSpaceId();i&&(0,to.hp)({environment:this.environment,spaceId:i,userId:e})}))}))})),l()(this,"logout",(()=>{const{online:e}=Ot.Z.state;e&&(Li.Z.setState({...Li.Z.state,open:!1}),V.HYP(this.environment),Ti.kS(this.environment))})),l()(this,"handleDraggableListDrop",(e=>t=>{const i=t.map(io.Vg).map((e=>oo.dr.fromSpaceShardRecordId(e,no.z))),o=new Ji.Z(this.environment,{table:eo.dx,id:e},{userId:e});N.H5(this.environment,(e=>{wi._Q({userRootStore:o,transaction:e,spaceViewIds:i.map((e=>e.id)),spaceViewPointers:i})}),e),V.Q4L(this.environment,{workspace_count:t.length})})),l()(this,"getAccountActionStyle",(()=>({display:"flex",color:this.theme.mediumTextColor,whiteSpace:"nowrap",fontSize:this.isMobile?16:12,paddingLeft:this.isMobile||this.isOnlySpace()?0:xi.dragHandleEffectiveWidth}))),l()(this,"getFooterStyle",(()=>this.environment.device.isMobile?{}:{backgroundColor:this.theme.sidebarSwitcherFooterBackground}))}renderComponent(){const{device:e}=this.environment,{shouldShowUnexpandButton:t}=this.props,{currentSpaceStore:i,currentUserStore:o}=A.Z.state,s=zi.Z.getUserIds(this.environment);if(!i||!o)return;const r=s.length>1?o.getEmail():void 0,a=this.getUnreadCountForOtherSpaces();return n()(ve.Z,{popupType:e.isMobile?ve.Z.PopupType.SlideUp:ve.Z.PopupType.Popup,buttonPopupStore:Li.Z,renderOrigin:()=>n()(j.Z,{style:{...co.buttonStyle,height:this.height[this.props.format],marginBottom:r?e.isMobile?0:8:0,...this.props.buttonStyle},mobileFeedback:e.isMobile,onClick:this.handleClick,className:re.rl},void 0,n()(Vi,{isMobile:this.isMobile,spaceStore:i,activeUserEmailAddress:r,showExpand:!0,type:"store"}),t&&n()("div",{className:re.Ji,style:{display:"flex",alignItems:"center",height:"100%",marginLeft:"auto",marginRight:a?0:12}},void 0,n()(ro.V,{})),n()(Ci.Z,{color:Ci.Z.Color.Red,count:a,style:{marginLeft:6,marginRight:14}})),originGap:0,disableMutationObserver:!0,render:t=>{let i;return i=e.isMobile?{menuType:Ze.ZP.MenuType.Modal,title:n()(_._H,{defaultMessage:"Accounts & Workspaces",id:"sidebarSwitcherMultiAccount.mobileMenu.title"}),right:n()(Vt.DoneMenuText,{}),onClickRight:t.close}:{menuType:Ze.ZP.MenuType.Popup,minWidth:270,maxWidth:360,footer:this.renderFooter()},c().createElement(Ze.ZP,i,s.map(((t,i)=>n()(d.Fragment,{},t,this.renderAccountHeader(t),n()("div",{style:e.isMobile?{paddingTop:10}:i!==s.length-1?{borderBottom:"1px solid ".concat(this.theme.lightDividerColor)}:{}},void 0,n()(Se.Z,{type:Se.Z.Type.Vertical,sections:this.getMenuListSections(t),initialFocus:void 0}))))),e.isMobile&&this.renderFooter())}})}renderAccountHeader(e){const{online:t}=Ot.Z.state,i=zi.Z.getUserEmailAddress(this.environment,e);return i&&n()(Ri,{emailAddress:i,userId:e,disabled:!t,accountActions:[(0,G.qu)(e),(0,G.pD)(e)]})}renderFooter(){const{redirectURL:e,disableLoginLink:t}=this.props,i=c().createElement(c().Fragment,null,!this.hasAtLeastOneTeamPlan()&&c().createElement(Xi,r()({createType:"create-work",redirectURL:e,disableLoginLink:t},this.stores)),!ao.wm()&&c().createElement(Xi,r()({createType:"add-account",redirectURL:e,disableLoginLink:t},this.stores)));return n()("div",{style:this.getFooterStyle()},void 0,n()(fe.Z,{topBorder:!0},void 0,ki.k(this.environment)&&i,this.renderLogoutAll()),!this.isMobile&&n()(fe.Z,{topBorder:!0},void 0,this.renderDownloadApps()))}renderDownloadApps(){const{device:e}=this.environment;return e.isElectron?n()($i.Z,{external:!0,href:Te.AR.mobile,onClick:this.handleMobileAppClick},void 0,n()(Me.Z,{focused:!1,title:n()("div",{style:{color:this.theme.mediumTextColor,fontSize:12}},void 0,n()(_._H,{defaultMessage:"Get iOS & Android app",id:"sidebarMultiSwitcher.desktopAppGetMobileApp.prompt"}))})):n()($i.Z,{external:!0,href:Te.AR.desktop,onClick:this.handleDesktopAppClick},void 0,n()(Me.Z,{focused:!1,title:n()("div",{style:{color:this.theme.mediumTextColor,fontSize:12}},void 0,e.isWindows?n()(_._H,{defaultMessage:"Get Windows app",id:"sidebarMultiSwitcher.windowsAppButton.text"}):n()(_._H,{defaultMessage:"Get Mac app",id:"sidebarMultiSwitcher.macAppButton.text"}))}))}renderLogoutAll(){const{online:e}=Ot.Z.state;return n()(Me.Z,{onClick:this.logout,focused:!1,disabled:!e,title:n()("div",{style:{...this.getAccountActionStyle(),paddingLeft:0}},void 0,n()(_._H,{defaultMessage:"Log out all",id:"sidebarSwitcherMultiAccount.menuItem.logoutAllButton.label"}))})}getMenuListSections(e){const{device:t}=this.environment,i=zi.Z.getSpaceViewStores(this.environment,e).map((e=>e.pointer)).map((e=>({id:e.id,spaceId:(0,so.CG)(e.spaceId)}))).map(io.vY);return[{key:"spaces",render:o=>c().createElement(fe.Z,r()({},o,{disableMobilePadding:!0,topBorder:t.isMobile,children:t.isMobile?o.children:n()(d.Fragment,{},void 0,n()(_i.Z,{direction:_i.K.Vertical,keys:i,renderKey:e=>o.children[i.indexOf(e)],onDrop:this.handleDraggableListDrop(e),isSidebarSwitcher:!0}))})),items:this.getSpaceMenuListItems(e)}]}renderSpaceMenuItem(e){const{device:t}=this.environment,{online:i}=Ot.Z.state,o=!this.isOnlySpace(e.userId)&&!t.isMobile;return c().createElement(xi,r()({},e.props,{id:e.id,icon:e.icon,title:e.title,caption:e.subtitle,isCheck:e.isCurrentSpace,unreadMentions:e.unreadMentions,showDragHandle:o,shortcut:void 0!==e.shortcutIndex&&e.shortcutIndex<=9?t.isElectronMac?"⌘".concat(e.shortcutIndex):"ctrl+".concat(e.shortcutIndex):void 0,disabled:!i&&this.environment.currentUser.id!==e.userId,disableTooltip:!0}))}getSpaceMenuListItems(e){const{onSpaceClick:t}=this.props,{device:i}=this.environment,o=[],{currentUserRootStore:n,currentSpaceStore:s}=A.Z.state,r=zi.Z.getSpaceViewStores(this.environment,e),a=zi.Z.getAllSpaceViewStores(this.environment);if(!n||!s)return[];for(const[l,d]of r.entries()){const r=d.getSpaceStore();if(r){const l=e===n.id&&r.id===s.id,{results:c}=Ui.Z.state,h=c.find((e=>e.spaceId===r.id)),p=(0,Di.getSpaceName)(this.environment,r);let u;const m=Oi.Z.getPublicSpaceData(this.environment,r.id);if(m){const e=m.productId?this.props.intl.formatMessage((0,qe.em)(m.productId)):this.props.intl.formatMessage("team"===r.getPlanType()?qe.js.teamTrialPlan:qe.js.personalPlan);u=this.props.intl.formatMessage("personal"===r.getPlanType()?qe.js.workspaceSubtitleWithoutMembers:qe.js.workspaceSubtitleWithMembers,{numberOfWorkspaceMembers:this.props.intl.formatNumber(m.memberCount),planType:e})}const g=me().findIndex(a,(e=>e.id===d.id))+1;o.push({key:d.id,render:t=>this.renderSpaceMenuItem({id:r.id,props:t,title:p,subtitle:u,shortcutIndex:i.isElectron?g:void 0,icon:(0,Di.getSpaceIcon)(this.environment,r),isCurrentSpace:l,userId:e,unreadMentions:h&&h.spaceId!==s.id&&h.unread.mentions>0?h.unread.mentions:void 0}),action:async({event:e})=>{this.close(),l||await t({event:e,spaceViewStore:d}),V.sos(this.environment)}})}}return o}close(){Li.Z.setState({...Li.Z.state,open:!1})}get isMobile(){return this.props.format===lo.Mobile}isOnlySpace(e){return 1===(e?zi.Z.getSpaceViewStores(this.environment,e):zi.Z.getAllSpaceViewStores(this.environment)).length}hasAtLeastOneTeamPlan(){return zi.Z.hasAtLeastOneTeamPlan(this.environment)}getUnreadCountForOtherSpaces(){return Ui.Z.getUnreadMentionsCountForOtherSpaces()}}l()(co,"Format",lo),l()(co,"buttonStyle",{display:"flex",alignItems:"center",minWidth:0,height:"100%",width:"100%"});const ho=(0,_.XN)(co);var po=i(75934),uo=i(79689),mo=i(83420),go=i(66897),bo=i(66055);function vo(e){const{actorPointer:t,timestamp:i,store:o}=e,s=(0,_.YB)(),r=(0,Re.Z)(Math.min(i,Date.now())).calendar(),a=(0,lt.VK)((()=>t?(0,mo.u)({parentStore:o,pointer:t}):void 0),[t,o]),l=a&&(0,go.$4)(s,a);return n()("div",{},void 0,l?n()(_._H,{id:"sharedWithMePage.menuItem.caption",defaultMessage:"Edited by {actorName} · {time}",values:{time:r,actorName:l},description:"Caption for a shared page that shows the time the page was last edited or the time at which the user was invited, and by whom (e.g. 'Today at 11:00am • Ivan Zhao'"}):r)}function yo(e){const{store:t,type:i}=e,[o,s]=c().useState(!1),a=(0,mt.O7)(),l=(0,mt.MO)(),d=n()(_._H,o?{defaultMessage:"Link copied",id:"sharedWithMePageMenuItem.linkCopied.tooltip",description:"Tooltip shown when user copied link to a shared page"}:{defaultMessage:"Copy link",id:"sharedWithMePageMenuItem.copylinkToPage.tooltip",description:"Shortcut for copying a link to a shared page from the 'Shared With Me' pop-up"});return n()(x.Z,{placement:x.Z.Placement.Bottom,renderTooltip:()=>d,forceVisibleState:o||void 0,render:e=>c().createElement(Ft.Z,r()({isGray:!0,style:{marginRight:2},onClick:e=>{bo.Hs({environment:a,blocks:[t],event:e}),l&&(uo.S.update((e=>({...e,[i]:!1}))),bt.xv()),V.buA(a,{type:i}),s(!0),setTimeout((()=>{s(!1)}),1e3)}},e,{onMouseLeave:t=>{s(!1),e.onMouseLeave(t)}}),u.Z.link({width:l?18:16,height:l?18:16}))})}function So(e){const{isPinned:t,store:i,spaceViewStore:o,type:s}=e,a=(0,mt.O7)(),l=(0,mt.MO)(),[{online:d}]=(0,lt.oR)(Ot.Z),[{currentUserSettingsStore:h}]=(0,lt.oR)(A.Z),p=(0,dt.y)((e=>({pinned:{width:l?18:16,height:l?18:16,fill:e.regularIconColor},unpinned:{width:l?18:16,height:l?18:16}})),[l]);return n()(x.Z,{disableTooltip:!d,placement:x.Z.Placement.Bottom,renderTooltip:()=>n()(_._H,t?{defaultMessage:"Remove from sidebar",id:"outlinerViewAllMenuList.removeFromSidebar.tooltip",description:"Tooltip displayed when user can remove a pinned page from the sidebar"}:{defaultMessage:"Add to sidebar",id:"outlinerViewAllMenuList.addToSidebar.tooltip",description:"Tooltip displayed when user can pin a page to the sidebar"}),render:e=>c().createElement(Ft.Z,r()({},e,{isGray:!0,onClick:()=>{h&&(0,N.H5)(a,(e=>{t?(bt.tP({environment:a,store:i,spaceViewStore:o,userSettingsStore:h,transaction:e}),V.An9(a,{type:s,from:"sidebar_dropdown_menu"})):(bt.kJ({environment:a,store:i,spaceViewStore:o,userSettingsStore:h,transaction:e}),V.qYb(a,{type:s}))}))},disabled:!d,style:d?void 0:{cursor:"default"}}),t?u.Z.pinFilled(p.unpinned):u.Z.pin(p.pinned))})}const fo=c().forwardRef(((e,t)=>{const{store:i,timestamp:o,actorPointer:s,type:a,...l}=e,d=(0,lt.VK)((()=>i.getIcon()),[i]),h=(0,lt.VK)((()=>i.isEmptyPage()),[i]);return c().createElement(Me.Z,r()({},l,{ref:t,title:n()(P.Z,{store:i}),icon:n()(C.Z,{disabled:!0,icon:d,isEmptyPage:h,size:19}),caption:n()(vo,{actorPointer:s,store:i,timestamp:o}),right:n()("div",{style:{display:"flex"}},void 0,n()(yo,{store:i,type:a}),c().createElement(So,e))}))}));function Mo(e){const{sections:t}=e,i=1===t.length;return t.map((({key:t,pages:o},n)=>({key:t,items:Zo({...e,pages:o}),render:e=>c().createElement(fe.Z,r()({},e,{topBorder:0!==n,title:i?void 0:ko(t)}))})))}function Zo(e){const{environment:t,spaceStore:i,pages:o,visiblePageIds:n,closePopover:s,type:a,query:l,sortBy:d}=e,h=n.length;return o.map((({blockId:o,timestamp:p,authorId:u,authorTable:m,index:b})=>{const v=g.Z.createChildStore(i,{table:ae.iU,id:o}),y=u&&m?{table:m,id:u}:void 0,S=n.includes(o);return{key:o,action:({event:e})=>{s(),$._c({environment:t,store:v,metaClick:e.metaKey}),t.device.isPhone&&bt.xv(),V._fo(t,{type:a,sortBy:d,queryStringLength:l.length,selectedItemIndex:b})},render:t=>c().createElement(fo,r()({},t,e,{store:v,timestamp:p,actorPointer:y,isPinned:S,spaceId:i.id,pinnedAmount:h}))}}))}function ko(e){switch(e){case"today":return n()(_._H,{id:"sharedWithMePopover.todaySection.label",defaultMessage:"Today"});case"past-week":return n()(_._H,{id:"sharedWithMePopover.pastWeekSection.label",defaultMessage:"Past week"});case"earlier":return n()(_._H,{id:"sharedWithMePopover.earlierSection.label",defaultMessage:"Earlier"});default:throw rt.t1(e)}}const To=function(e){const t=(0,mt.O7)(),[i,o]=(0,lt.oR)(uo.S);return n()(Se.Z,{type:Se.Z.Type.Vertical,initialFocus:void 0,sections:Mo({...e,environment:t,closePopover:()=>{o({...i,[e.type]:!1})}})})};var wo=i(78092);const Co=(0,_.vU)({searchPlaceholder:{id:"outlinerViewAllPopover.search.placeholder",defaultMessage:"Search for shared pages",description:"Search placeholder text in 'Shared' overflow popover menu"}});function Io(e){const t=(0,mt.Fy)(),{isMobile:i}=t,{isLoading:o,query:s,onInputChange:r}=e,a=(0,dt.y)((e=>({iconStyle:{width:14,height:14,marginRight:6,flexGrow:0,flexShrink:0,color:e.regularIconColor},headerContainer:{marginTop:i?0:14,backgroundColor:e.popoverBackground,borderBottom:"1px solid ".concat(e.regularDividerColor)},sortContainer:{margin:i?"4px 14px":"4px 14px 0"}})),[i]);return c().createElement(c().Fragment,null,n()("div",{style:a.headerContainer},void 0,n()(Bt.Z,{style:{...t.isAndroid&&{borderBottom:"none"}},left:n()(It.Z,{show:o,showDelay:500,showHold:300,render:e=>e?n()(W.Z,{style:a.iconStyle}):u.Z.searchThick(a.iconStyle)}),showClearButton:!0,placeholder:Nt.Z.formatMessage(Co.searchPlaceholder),focus:!t.isMobile||void 0,value:s,onChange:e=>{r(e.target.value)}}),n()("div",{style:a.sortContainer},void 0,n()(wo.Z,{currentSortBy:e.sortBy,setSortBy:e.setSortBy,sortOptions:Ro}))))}function Bo(){return n()(fe.Z,{topBorder:!0,disableDesktopPadding:!0},void 0,n()(Et.Z,{title:n()(_._H,{defaultMessage:"Learn about shared pages",id:"sharedWithMePopover.learnMore.prompt",description:"Link to a guide to learn more about 'Shared with Me' in popover menu"}),href:(0,He.UY)("guides.sharing"),analyticsFrom:"sharing"}))}function xo(){return n()(Dt.Z,{href:(0,He.UY)("guides.sharing"),analyticsFrom:"sharing"})}function Po(e){const{pages:t,sortBy:i}=e,o=(0,po.vs)(t,i);return 0===o.length?n()(Ao,{}):c().createElement(To,r()({},e,{sections:o}))}function Ao(){const e=(0,mt.Fy)(),{isMobile:t}=e,i=(0,dt.y)((e=>({placeHolderStyle:{textAlign:"center",padding:"".concat(t?64:0,"px 20px 0"),display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:t?void 0:"100%",minHeight:t?void 0:200},iconStyle:{width:36,fill:e.lightIconColor},contentStyle:{fontSize:14,color:e.mediumTextColor,maxWidth:260}})),[t]),o=n()(_._H,{defaultMessage:"No pages found",id:"outlinerViewAllPopover.search.noMatchesPrompt",description:"Message when 'View all' popover query results are empty"});return n()("div",{style:i.placeHolderStyle},void 0,n()("div",{style:{paddingBottom:12}},void 0,u.Z.paperAirplane(i.iconStyle)),n()("div",{style:{...i.contentStyle,fontWeight:500}},void 0,o))}const Ro=[{key:po.As.Relevance,formattedName:n()(_._H,{id:"sharedWithMePopover.sortOrder.relevance",defaultMessage:"Relevance"})},{key:po.As.LastEditedNewest,formattedName:n()(_._H,{id:"sharedWithMePopover.sortOrder.lastEditedNewest",defaultMessage:"Last edited"})}],_o=function(e){const t=(0,mt.O7)(),{device:i}=t,[o,s]=(0,lt.oR)(uo.S),a=c().createElement(Io,e);let l;return l=i.isMobile?{menuType:Ze.ZP.MenuType.Modal,title:n()(_._H,{defaultMessage:"Shared",id:"outlinerViewAllPopover.menu.header",description:"Label for mobile popover menu that displays overflow of shared pages"}),left:n()(xo,{}),right:n()(Vt.DoneMenuText,{}),onClickRight:()=>{s({...o,[e.type]:!1})},header:a}:{menuType:Ze.ZP.MenuType.Popup,width:400,header:a,footer:n()(Bo,{})},c().createElement(Ze.ZP,l,c().createElement(Po,r()({},e,{pages:e.sharedPages})))};var Lo=i(39302),Uo=i(63143),Oo=i(59054);function Ho(e){const{isPopoverOpen:t,isMobile:i,onClick:o,total:s}=e,r=(0,dt.y)((e=>({item:{background:t?e.buttonHoveredBackground:void 0,marginBottom:i?16:void 0},flexRow:{display:"flex",alignItems:"center",fontSize:i?16:12}})),[t,i]);return n()(j.Z,{mobileFeedback:i,onClick:o},void 0,n()(B.Z,{style:r.item,isMobile:i,disableMobileBorder:!0},void 0,n()("div",{style:r.flexRow},void 0,n()(_._H,{defaultMessage:"View all ({total})",id:"viewMoreOutlinerButton.label",description:"Label for popover menu that displays all pages for an overflowing section in the sidebar. The count represents total number of pages  (e.g. View all (8))",values:{total:s}}))))}const Fo=function(e){const{isMobile:t,allSharedPages:i,type:o,originRef:s,userSettingsStore:a,spaceStore:l}=e,d=(0,mt.O7)(),h=(0,_.YB)(),p=l.id,u=a.id,[m,g]=c().useState(void 0),[b,v]=(0,lt.oR)(uo.S),y=Boolean(b[o]),[{status:S}]=(0,Oo.r5)((async()=>{await(0,to.lO)({environment:d,spaceId:p,userId:u})}),[d,p,u],{debounce:Ut.vp,interval:y?30*Uo.C0:5*Uo.hM}),f=c().useCallback((()=>{v((e=>({...e,[o]:!0}))),g(s.current?s.current.getBoundingClientRect():void 0),V.kVp(d,{type:o,from:t?"sidebar_mobile":"sidebar"})}),[d,v,o,s,t]),M=c().useCallback((()=>{v((e=>({...e,[o]:!1})))}),[v,o]),[Z,k]=c().useState(""),T=c().useRef(void 0);c().useEffect((()=>(y?T.current&&(clearTimeout(T.current),T.current=void 0):T.current=setTimeout((()=>{k("")}),2*Uo.hM),()=>{T.current&&(clearTimeout(T.current),T.current=void 0)})),[y]);const w=c().useMemo((()=>(0,po.gD)({spaceId:p,type:o})),[p,o]),[C,I]=c().useState((()=>X.Z.get({userId:u,key:w})||po.As.Relevance)),B=(0,lt.VK)((()=>{const e=(0,le.l6)({allSharedPages:i,query:Z,intl:h});return(0,le.vs)({sharedPageItems:e,sortBy:C,currentUserId:u})}),[i,u,Z,C,h]);return n()(Lo.ZP,{popupType:t?Lo.ZP.PopupType.SlideUp:Lo.ZP.PopupType.Popup,originRect:m,alignmentToOrigin:Lo.ZP.Alignment.Start,placementToOrigin:Lo.ZP.Placement.Right,originGap:0,isFullWidthOnMobile:!0,preventScaleTransition:!0,open:y,onDismiss:M,render:()=>c().createElement(_o,r()({},e,{isLoading:"pending"===S,query:Z,onInputChange:k,sortBy:C,setSortBy:e=>{X.Z.set({userId:u,key:w,value:e}),I(e),V.Sz4(d,{type:o,from:C,to:e})},sharedPages:B,allSharedPageIds:i.map((({id:e})=>e))})),origin:n()(Ho,{isPopoverOpen:y,isMobile:t,onClick:f,total:i.length})})};var Eo=i(78291),Do=i(52533),No=i(70951);function Vo({isMobile:e}){const t=(0,mt.O7)(),i=(0,dt.y)((t=>({button:e||"local"===be.Z.env?{}:{opacity:0},buttonHover:{opacity:1},icon:{height:e?16:14,fill:t.mediumIconColor}})),[e]),o=(0,d.useCallback)((()=>{$.c4({environment:t,url:"/design/"})}),[t]);return n()(x.Z,{renderTooltip:()=>n()(_._H,{defaultMessage:"Development-only design and engineering tools.",id:"sidebar.developmentOnly.uidoc.tooltip",description:"Only shown in development."}),originGap:6,placement:Ii.ug.Right,render:t=>c().createElement(j.Z,r()({},t,{mobileFeedback:e,onClick:o,style:i.button,hoveredStyle:i.buttonHover}),n()(B.Z,{left:u.Z.gift(i.icon),isMobile:e,disableMobileBorder:!0},void 0,n()(_._H,{defaultMessage:"UI Docs",id:"sidebar.developmentOnly.uidoc.button",description:"Only shown in development. Links to /design, a documentation route."})))})}class Wo extends h.Z{constructor(...e){super(...e),l()(this,"sidebarState",this.createComputedStore((()=>(0,Ge.vK)(this.environment)))),l()(this,"storeTypes",{scrollerStore:Si.Z}),l()(this,"handleScrollerMount",(e=>{fi.Z.SidebarMobileScroller=e})),l()(this,"handleCloseSidebar",(()=>{bt.xv()})),l()(this,"handleClickFind",(()=>he.Kf({environment:this.environment,analyticsFrom:"sidebar-mobile"}))),l()(this,"handleOrientationChange",(()=>{bt.xv()})),l()(this,"isScrolledToTop",this.createComputedStore((()=>0===this.stores.scrollerStore.state.scrollTop))),l()(this,"isCurrentIAPSubscriber",(()=>{const{currentUserRootStore:e}=A.Z.state,t=(0,Oe.xR)({environment:this.environment,userRootStore:e});return!(!t||!t.includes(be.Z.revenueCat.productIDs.personal.monthly)&&!t.includes(be.Z.revenueCat.productIDs.personal.yearly))}))}willMount(){window.addEventListener("resize",this.handleOrientationChange)}willUnmount(){window.removeEventListener("resize",this.handleOrientationChange)}renderComponent(){if(ao.wm()&&"on"!==Ue.Z.getGroup("mobile-home-tab-allow-web-sidebar"))return n()("div",{className:re.al},void 0,c().createElement(Xi,r()({createType:"add-account"},this.stores)));const e=qe.Jr(this.environment);return e?n()(Mi.Z,{render:()=>n()("div",{className:re.yk,style:this.getWrapStyle()},void 0,!e&&n()(vi,{}),this.renderSidebar()),isVisible:!0,animationStyle:{width:e?qe.Wk(this.environment):"100vw"}}):n()("div",{className:re.yk,style:{...this.getWrapStyle(),width:"100vw"}},void 0,!e&&n()(vi,{}),this.renderSidebar())}renderSidebar(){return n()(pi.Z,{capture:!qe.Jr(this.environment)&&ft.TC.get(),onBackButton:this.handleCloseSidebar},void 0,n()("div",{style:this.getStyle()},void 0,this.renderTopbar(),this.renderOutliner()),ao.wm()&&n()("div",{className:re.al},void 0,c().createElement(Xi,r()({createType:"add-account"},this.stores))))}renderTopbar(){const{device:e}=this.environment,t=e.isMobileNative&&e.isTablet&&qe.Jr(this.environment);return n()("div",{style:this.getTopbarStyle()},void 0,n()(ho,{shouldShowUnexpandButton:t,format:lo.Mobile,onSpaceClick:async({event:e,spaceViewStore:t})=>{await wi.y3({environment:this.environment,spaceViewStore:t,userSettingsStore:A.Z.state.currentUserSettingsStore,userRootStore:A.Z.state.currentUserRootStore,metaClick:e.ctrlKey||e.metaKey})}}),!e.isMobileNative&&n()(No.Z,{format:No.Z.Format.TopbarMobile}),!e.isMobileNative&&n()(j.Z,{onClick:this.handleClickFind,mobileFeedback:!0,style:Wo.actionButtonStyle},void 0,u.Z.mobileBottomBarSearch({width:26})))}renderOutliner(){const{currentSpaceStore:e,currentSpaceViewStore:t,currentUserRootStore:i,currentUserStore:o,currentUserSettingsStore:s,currentBlockStore:r}=A.Z.state,a=this.sidebarState.state;if(!(a&&r&&t&&i&&e&&o&&s))return;const l=e.canEdit(),d=(0,Do.S)({environment:this.environment})&&"personal_free"===(0,Oe.CM)(this.environment)&&Eo.Z.state.data&&"unsubscribed_admin"===Eo.Z.state.data.type&&Eo.Z.state.data.revenueCatEnabled&&!this.isCurrentIAPSubscriber();return n()(Qt.Z,{store:e,disableEditNearestBlock:!0,render:i=>c().createElement(pe.ZP,{store:this.stores.scrollerStore,ref:this.handleScrollerMount,style:Wo.outlinerStyle,disableScroll:Xt.H6(this.environment),type:pe.xm.Y},a.showBookmarksSection&&n()(Zt,{isMobile:!0,type:"bookmarks",spaceStore:e,spaceViewStore:t,showAddPageButton:!1,renderSidebar:()=>n()(ce,{isMobile:!0,type:"bookmarks",isTopLevel:!0,spaceStore:e,spaceViewStore:t,parentStore:t.getBookmarkedPagesStore(),childStores:t.getBookmarkedPages(),showAddPageButton:!1,onNavigate:this.handleCloseSidebar,onCreatePage:this.handleCloseSidebar,disabled:!l})}),a.showTeamSection&&n()(Zt,{isMobile:!0,type:"team_section",spaceStore:e,spaceViewStore:t,showAddPageButton:!1,showAddTeamButton:!1,labelTooltip:n()(_._H,{defaultMessage:"A list of your teams.",id:"sidebar.workspacePagesSection.tooltip"}),renderSidebar:()=>{const i=t.getTeamsStores().reduce(((e,t)=>(e[t.id]=t,e)),{});return n()(_i.Z,{direction:_i.K.Vertical,keys:Object.keys(i),onDraggingKeyChanged:e=>{ft.Z3.set(e)},renderKey:o=>{const s=i[o],r=s.getValue();if(r)return n()(Zt,{isMobile:!0,type:"team",teamHeaderLabel:r.name,teamStore:s,spaceStore:e,spaceViewStore:t,showAddPageButton:!1,showAddTeamButton:!1,showDragHandle:o===ft.Z3.get(),labelTooltip:n()(_._H,{defaultMessage:"One of your teams",id:"sidebar.teamSection.tooltip"}),renderSidebar:()=>n()(ce,{isMobile:!0,type:"team",isTopLevel:!1,spaceStore:e,spaceViewStore:t,onNavigate:this.handleCloseSidebar,parentStore:s.getTeamPagesStore(),childStores:s.getTeamPagesStores(),showAddPageButton:!1,disabled:!l})})},onDragEnd:()=>{ft.Z3.set(null)},onDrop:e=>{ft.Z3.set(null),N.H5(this.environment,(i=>{D.sW({store:t,data:{joined_teams:e},transaction:i})}))}})}}),a.showWorkspaceSection&&!a.showTeamSection&&n()(Zt,{isMobile:!0,type:"workspace",spaceStore:e,spaceViewStore:t,showAddPageButton:!1,renderSidebar:()=>n()(ce,{isMobile:!0,type:"workspace",isTopLevel:!0,spaceStore:e,spaceViewStore:t,parentStore:e.getPagesStore(),childStores:t.getWorkspacePages(),addPageTitle:n()(_._H,{defaultMessage:"Add a page",id:"sidebarMobile.addPageToWorkspace.title"}),onNavigate:this.handleCloseSidebar,onCreatePage:this.handleCloseSidebar,showAddPageButton:!0,disabled:!l})}),a.showSharedSection&&n()(Zt,{isMobile:!0,type:"shared",spaceStore:e,spaceViewStore:t,showAddPageButton:!1,renderSidebar:i=>c().createElement(c().Fragment,null,n()(ce,{isMobile:!0,type:"shared",isTopLevel:!0,spaceStore:e,spaceViewStore:t,parentStore:t.getSharedPagesStore(),childStores:a.visibleSharedPagesStores,showAddPageButton:!1,onNavigate:this.handleCloseSidebar,onCreatePage:this.handleCloseSidebar,disabled:!l}),a.showSharedOverflowButton&&n()(Fo,{originRef:i,isMobile:!0,type:"shared",spaceStore:e,spaceViewStore:t,userSettingsStore:s,allSharedPages:a.allSharedPagesStores,visiblePageIds:a.visibleSharedPagesStores.map((({id:e})=>e))}))}),a.showPrivateSection&&!a.showOnlyPrivateSection&&n()(Zt,{isMobile:!0,type:"private",spaceStore:e,spaceViewStore:t,showAddPageButton:!1,renderSidebar:()=>n()(ce,{isMobile:!0,type:"private",isTopLevel:!0,spaceStore:e,spaceViewStore:t,parentStore:e.getPagesStore(),childStores:t.getPrivatePages(this.environment),addPageTitle:n()(_._H,{defaultMessage:"Add a page",id:"sidebarMobile.addAPrivatePage.title"}),showAddPageButton:!0,onNavigate:this.handleCloseSidebar,onCreatePage:this.handleCloseSidebar,disabled:!l})}),a.showOnlyPrivateSection&&n()(ce,{isMobile:!0,type:"private",isTopLevel:!0,spaceStore:e,spaceViewStore:t,parentStore:e.getPagesStore(),childStores:t.getPrivatePages(this.environment),addPageTitle:n()(_._H,{defaultMessage:"Add a page",id:"sidebarMobile.addAPageToOnlyPrivateSection.title"}),showAddPageButton:!0,onNavigate:this.handleCloseSidebar,onCreatePage:this.handleCloseSidebar,disabled:!l}),a.showOnlyPrivateSection&&n()("div",{style:{height:20}}),n()(hi,{store:e}),n()(ti,{isMobile:!0}),e.canEdit()&&n()(Yt,{store:r,isMobile:!0}),d&&n()(ni,{}),n()(ot,{isMobile:!0}),"production"!=={NODE_ENV:void 0,VERSION:"0.2.7",EXTENSION_CONFIG:{env:"production",isAdminMode:!1,isLocalhost:!1,offline:!0,version:"23.10.16.9",domainBaseUrl:"https://www.notion.so",adminUrl:"https://admin.notion.so",publicDomainName:"notion.site",protocol:"notion",staticS3:{url:"https://prod-notion-assets.s3-us-west-2.amazonaws.com",bucket:"prod-notion-assets"},lastUpdatedTime:1640201354381,api:{http:"/api/v3"},googleOAuth:{clientId:"905154081809-858sm3f0qnalqd9d44d9gecjtrdji9tf.apps.googleusercontent.com"},messageStore:{url:"https://msgstore.www.notion.so",api:"/api/v1"},stripe:{key:"pk_live_vuNO27XGTCbXjVwneiECILjT"},revenueCat:{apiResponseMaxAge:6048e5,entitlementIDs:{personal:"notion.id.personal_pro"},productIDs:{personal:{monthly:"notion.id.personal_pro_monthly",yearly:"notion.id.personal_pro_yearly"}}},intercom:{appId:"gpfdrxfd",adminId:"3483686"},mutiny:{personalKey:"1149e901f65fc47c"},segment:{writeKey:"g1mMn2qquRcv7exBIVDivoKl9cOrdxLA"},amplitude:{apiKey:"64ac42fd5a4a1db6ac5cf007fe57a3d5"},pricing:{invoiceDaysUntilDue:30,team_free:{spaceBlockLimit:1e3,fileUploadMaxBytes:5e6},personal_free:{fileUploadMaxBytes:5e6},student:{productId:"prod_FhChFoDp7gS1Ba"},personal:{productId:"prod_CpavZFCbxF2YGx",monthlyPrice:500,yearlyPrice:4800},team:{productId:"prod_CpawK4ih14xs4t",monthlyPricePerMember:1e3,yearlyPricePerMember:9600},enterprise:{productId:"prod_Cpb8M1AFEFhdy1",monthlyPricePerMember:2500,yearlyPricePerMember:24e3}},desktopS3:{url:"https://s3-us-west-2.amazonaws.com/desktop-release.notion-static.com"},publicFileS3:{url:"https://s3-us-west-2.amazonaws.com/public.notion-static.com",bucket:"public.notion-static.com"},temporaryFileS3:{url:"https://s3-us-west-2.amazonaws.com/temporary.notion-static.com",bucket:"temporary.notion-static.com"},secureFileS3:{url:"https://s3-us-west-2.amazonaws.com/secure.notion-static.com",bucket:"secure.notion-static.com"},loggly:{token:"edcca201-4028-4ef1-bbb1-c78b430dd74e"},datadog:{applicationId:"3a3add4b-112a-483d-8b3d-b4f61bc7bf39",clientToken:"f6d456ce-3a61-4e69-9880-54d0ba3d76d7"},embedly:{key:"421626497c5d4fc2ae6b075189d602a2"},aif:{url:"https://aif.notion.so/aif-production.html"},contentful:{spaceId:"spoqsaf9291f",contentDeliveryToken:"AGqteRpWD8aE_kxy_s7_hSFAlKCh5qf-RctSU6vV6u0",contentPreviewToken:"uR2ZVAs-9TMKDq0YKYVtczFplx6P9p06huCibZDJZKA"},iOSAppId:1232780281,facebook:{pixelId:"499229960464487"},statsig:{apiKey:"client-Tgza5wNFa8dVt9BdeUfG6Vkm29bHxX10MhoztTMzLBB"}}}.ENV&&"staging"!=={NODE_ENV:void 0,VERSION:"0.2.7",EXTENSION_CONFIG:{env:"production",isAdminMode:!1,isLocalhost:!1,offline:!0,version:"23.10.16.9",domainBaseUrl:"https://www.notion.so",adminUrl:"https://admin.notion.so",publicDomainName:"notion.site",protocol:"notion",staticS3:{url:"https://prod-notion-assets.s3-us-west-2.amazonaws.com",bucket:"prod-notion-assets"},lastUpdatedTime:1640201354381,api:{http:"/api/v3"},googleOAuth:{clientId:"905154081809-858sm3f0qnalqd9d44d9gecjtrdji9tf.apps.googleusercontent.com"},messageStore:{url:"https://msgstore.www.notion.so",api:"/api/v1"},stripe:{key:"pk_live_vuNO27XGTCbXjVwneiECILjT"},revenueCat:{apiResponseMaxAge:6048e5,entitlementIDs:{personal:"notion.id.personal_pro"},productIDs:{personal:{monthly:"notion.id.personal_pro_monthly",yearly:"notion.id.personal_pro_yearly"}}},intercom:{appId:"gpfdrxfd",adminId:"3483686"},mutiny:{personalKey:"1149e901f65fc47c"},segment:{writeKey:"g1mMn2qquRcv7exBIVDivoKl9cOrdxLA"},amplitude:{apiKey:"64ac42fd5a4a1db6ac5cf007fe57a3d5"},pricing:{invoiceDaysUntilDue:30,team_free:{spaceBlockLimit:1e3,fileUploadMaxBytes:5e6},personal_free:{fileUploadMaxBytes:5e6},student:{productId:"prod_FhChFoDp7gS1Ba"},personal:{productId:"prod_CpavZFCbxF2YGx",monthlyPrice:500,yearlyPrice:4800},team:{productId:"prod_CpawK4ih14xs4t",monthlyPricePerMember:1e3,yearlyPricePerMember:9600},enterprise:{productId:"prod_Cpb8M1AFEFhdy1",monthlyPricePerMember:2500,yearlyPricePerMember:24e3}},desktopS3:{url:"https://s3-us-west-2.amazonaws.com/desktop-release.notion-static.com"},publicFileS3:{url:"https://s3-us-west-2.amazonaws.com/public.notion-static.com",bucket:"public.notion-static.com"},temporaryFileS3:{url:"https://s3-us-west-2.amazonaws.com/temporary.notion-static.com",bucket:"temporary.notion-static.com"},secureFileS3:{url:"https://s3-us-west-2.amazonaws.com/secure.notion-static.com",bucket:"secure.notion-static.com"},loggly:{token:"edcca201-4028-4ef1-bbb1-c78b430dd74e"},datadog:{applicationId:"3a3add4b-112a-483d-8b3d-b4f61bc7bf39",clientToken:"f6d456ce-3a61-4e69-9880-54d0ba3d76d7"},embedly:{key:"421626497c5d4fc2ae6b075189d602a2"},aif:{url:"https://aif.notion.so/aif-production.html"},contentful:{spaceId:"spoqsaf9291f",contentDeliveryToken:"AGqteRpWD8aE_kxy_s7_hSFAlKCh5qf-RctSU6vV6u0",contentPreviewToken:"uR2ZVAs-9TMKDq0YKYVtczFplx6P9p06huCibZDJZKA"},iOSAppId:1232780281,facebook:{pixelId:"499229960464487"},statsig:{apiKey:"client-Tgza5wNFa8dVt9BdeUfG6Vkm29bHxX10MhoztTMzLBB"}}}.ENV&&n()(Vo,{isMobile:!0}),n()("div",{style:{height:148}}))})}getWrapStyle(){return qe.Jr(this.environment)?{display:"block",height:"100vh",position:"relative",zIndex:3}:qe.YR(this.environment)?{display:"block",height:"100vh",position:"fixed",top:0,right:"100%",zIndex:3}:{display:"block",height:"100vh",position:"fixed",top:0,left:0}}getStyle(){return{display:"flex",flexDirection:"column",width:qe.qG(this.environment),height:"100%",background:qe.YR(this.environment)?this.theme.mobileSidebarAndroidBackground:this.theme.mobileSidebarIOSBackground,willChange:"transform",color:this.theme.mediumTextColor,...qe.YR(this.environment)&&{marginLeft:"auto"},...qe.Jr(this.environment)&&{position:"absolute",right:0},cursor:"pointer"}}getTopbarStyle(){const{WindowSizeStore:e}=this.environment;return{display:"flex",alignItems:"center",justifyContent:"space-between",flex:"none",height:Zi.g,marginTop:e.state.paddingTopCSS,paddingLeft:12,boxShadow:qe.YR(this.environment)&&!qe.Jr(this.environment)&&ft.TC.state?this.isScrolledToTop.state?this.theme.topbarAndroidShadowCollapsed:this.theme.topbarAndroidShadow:"0 1px 0 ".concat(this.theme.darkDividerColor),background:qe.YR(this.environment)?this.theme.androidSidebarBackground:$e.ZP.transparent,transition:"box-shadow 300ms",width:"100%",zIndex:1}}}l()(Wo,"outlinerStyle",{flexGrow:1,paddingTop:12,userSelect:"none",WebkitUserSelect:"none"}),l()(Wo,"actionButtonStyle",{display:"flex",alignItems:"center",justifyContent:"center",flex:"none",height:"100%",width:44,paddingRight:6});const qo=Wo},51134:(e,t,i)=>{i.r(t),i.d(t,{default:()=>ut});var o=i(67154),n=i.n(o),s=i(98135),r=i.n(s),a=i(59713),l=i.n(a),d=(i(33948),i(67294)),c=i.n(d),h=i(51454),p=i(50906),u=i(3779),m=i(9714),g=i(64442),b=i(61766),v=i(1449),y=i(46167),S=i(66832),f=i(48601),M=i(43803),Z=i(87953),k=i(53786),T=i(39849),w=i(21325),C=i(76668),I=i(24677),B=i(22789),x=i(52258),P=i(76487),A=i(14947),R=i(43250),_=i(67669),L=i(42001),U=i(13612),O=i(87531),H=i(27832),F=i(29974),E=i(82990),D=i(11302),N=i(40039),V=i(79029),W=i(65870),q=i(8848),z=i(2107),G=i(39865),K=i(8646),j=i(20088),Y=i(21202),Q=i(42330),X=i(84882),J=i(71802),$=i(7755),ee=i(45094),te=i(11819),ie=i(5366),oe=i(62442),ne=i(41507),se=i(38755),re=i(84122),ae=i(77907),le=i(24666),de=i(98104),ce=i(69454),he=i(3750),pe=i(30366),ue=i(19757),me=i(80527),ge=(i(65069),i(99244),i(96486)),be=i(78089),ve=i(33929),ye=i(58879),Se=i(89940),fe=i(64215),Me=i(24229),Ze=i(25584),ke=i(592),Te=i(32918),we=i(57269),Ce=i(17256),Ie=i(69326),Be=i(35973),xe=i(86646),Pe=i(96514);const Ae=c().forwardRef(((e,t)=>{const{currentBlockStore:i,discussion:o,showAllRepliesAfterTimestamp:n,focused:s,isLast:a,location:l}=e,h=(0,Se.VK)((()=>Me.Z.state.open&&Me.Z.state.discussionIds||[]),[]),p=(0,ye.O7)();(0,d.useEffect)((()=>{var e,t;if(s){Be.Z.setState({source:"update_sidebar",discussionIds:[o.id]});const e=setTimeout((()=>{var e,t;(null===(e=Be.Z.state)||void 0===e||null===(t=e.discussionIds)||void 0===t?void 0:t[0])===o.id&&((0,Pe.AM)([o.id]),(0,Pe.yM)(p,[o]))}),1500);return()=>{clearTimeout(e)}}(null===(e=Be.Z.state)||void 0===e||null===(t=e.discussionIds)||void 0===t?void 0:t[0])===o.id&&Be.Z.setState({discussionIds:[]})}),[s,o,p]);const u=(0,Se.VK)((()=>{var e;return(null===(e=Be.Z.state)||void 0===e?void 0:e.discussionIds)||[]}),[]),g=o.id,{parentId:b,currentSpaceId:v}=(0,Se.VK)((()=>{var e,t;return{parentId:null===(e=o.getValue())||void 0===e?void 0:e.parent_id,currentSpaceId:null===(t=o.getValue())||void 0===t?void 0:t.space_id}}),[o]),y=b?m.Z.createChildStore(o,{table:Y.iU,id:b}):void 0,S=h.includes(g),f=u.includes(g),M=(0,fe.y)((e=>({discussionContainer:{paddingTop:p.device.isMobile?4:10,borderBottom:a||p.device.isMobile?void 0:"1px solid ".concat(e.regularDividerColor),transition:"background 300ms ease"},replyButton:{color:e.blueColor,marginLeft:23,fontSize:14},hoveredStyle:{background:"sidebar"===l?e.hoveredDiscussionBackground:void 0},pressedStyle:{background:"sidebar"===l?e.focusDiscussionBackground:void 0}})),[l,a,p]);if(!y||!v)return null;const Z=c().createElement("div",{className:"sidebar-discussion-".concat(g," ").concat(R.s$),onClick:e.onClick,onMouseEnter:e.onMouseEnter,ref:t,style:{...M.discussionContainer,...s||f?M.hoveredStyle:{},...S?M.pressedStyle:{}}},r()(Ie.Z,{store:o,blockStore:i,format:Ie.Z.Format.Sidebar,isFirst:!1,isOnly:!1,showResolveButtonByDefaultIfPossible:!1,discussionLocation:"updates_sidebar",showAllRepliesAfterTimestamp:n}));return r()(xe.Z,{allowTextSelection:!0,title:Z,style:{marginLeft:-14,marginRight:-14,width:"calc(100% + 28px)",lineHeight:void 0,cursor:"pointer"}})}));var Re=i(54564),_e=i(29798),Le=i(7011),Ue=i(65598),Oe=i(48762),He=i(39302),Fe=i(83071);function Ee(){const e=(0,Se.VK)((()=>Le.ZP.state.commentsMode),[]),t=(0,fe.y)((e=>({container:{background:e.buttonHoveredBackground,width:"calc(100% - 32px)",height:30,borderRadius:6,display:"flex",margin:"10px 16px 6px 16px",marginTop:20,pointerEvents:"auto"},defaultButton:{fontSize:14,fontWeight:E.Z.fontWeight.medium,textAlign:"center",flex:1,margin:2,lineHeight:1.8,color:e.regularTextColor},selectedButton:{borderRadius:5,background:e.whiteButtonBackground,boxShadow:e.buttonBoxShadow},hoveredStyle:{borderRadius:5}})),[]);return r()("div",{style:t.container,className:R.rG},void 0,r()(A.Z,{style:{...t.defaultButton,...e===Le.F7.Unresolved?t.selectedButton:{}},hoveredStyle:t.hoveredStyle,onClick:()=>{(0,C.HZ)(Le.F7.Unresolved)}},void 0,r()("span",{},void 0,r()(ie._H,{id:"updateSidebarTabCommentsSegmentedControl.option.open",defaultMessage:"Open"}))),r()(A.Z,{style:{...t.defaultButton,...e===Le.F7.Resolved?t.selectedButton:{}},hoveredStyle:t.hoveredStyle,onClick:()=>{(0,C.HZ)(Le.F7.Resolved)}},void 0,r()("span",{},void 0,r()(ie._H,{id:"updateSidebarTabCommentsSegmentedControl.option.resolved",defaultMessage:"Resolved"}))))}const De=[Le.F7.Unresolved,Le.F7.Resolved],Ne={[Le.F7.Unresolved]:R.oc,[Le.F7.Resolved]:R.Y7},Ve=(0,ie.vU)({[Le.F7.Unresolved]:{id:"updateSidebar.comments.mode.unresolvedOption",defaultMessage:"Open comments"},[Le.F7.Resolved]:{id:"updateSidebar.comments.mode.resolvedOption",defaultMessage:"Resolved comments"}}),We=(0,ie.vU)({[Le.F7.Unresolved]:{id:"updateSidebar.comments.filter.button.unresolvedMode",defaultMessage:"Open"},[Le.F7.Resolved]:{id:"updateSidebar.comments.filter.button.resolvedMode",defaultMessage:"Resolved"}});function qe(){return(0,ye.O7)().device.isMobile?r()(Ee,{}):r()(ze,{})}function ze(){const[e,t]=(0,d.useState)(!1),{commentsMode:i}=(0,Se.Kw)(Le.ZP),o=(0,fe.y)((e=>({commentsHeader:{display:"flex",justifyContent:"space-between",borderBottom:"1px solid ".concat(e.regularDividerColor),alignItems:"center",pointerEvents:"auto"},label:{fontSize:14,color:e.regularTextColor,fontWeight:E.Z.fontWeight.medium,display:"flex",alignItems:"center",padding:"12px 12px 12px 16px"},toggleButton:{justifyContent:"center",display:"flex",color:e.mediumTextColor},toggleButtonContainer:{paddingLeft:12,paddingRight:8,display:"flex"},chevronIcon:{width:10,marginLeft:4,fill:e.lightIconColor}})),[]),s=(0,d.useCallback)((()=>r()(Ze.Z,{type:Ze.Z.Type.Vertical,initialFocus:void 0,sections:[{key:"commentFilter",render:e=>c().createElement(Fe.Z,e),items:De.map((e=>({key:e,render:t=>c().createElement(Oe.Z,n()({},t,{className:Ne[e],title:ve.Z.formatMessage(Ve[e]),right:r()("div",{style:{width:14,opacity:i===e?1:0}},void 0,u.Z.check())})),action:()=>{(0,C.HZ)(e),t(!1)}})))}]})),[i]);return r()("div",{style:o.commentsHeader,className:R.I9},void 0,r()("div",{style:o.label},void 0,r()(ie._H,{id:"updateSidebar.header.commentsLabel",defaultMessage:"Comments"})),r()("div",{style:o.toggleButtonContainer,className:R.CB},void 0,r()(He.ZP,{popupType:He.ZP.PopupType.Popup,open:e,origin:r()(L.Z,{style:o.toggleButton,onClick:()=>{t(!0)}},void 0,ve.Z.formatMessage(We[i]),u.Z.chevronDown(o.chevronIcon)),placementToOrigin:He.ZP.Placement.Bottom,alignmentToOrigin:He.ZP.Alignment.Center,originGap:4,render:s,onDismiss:()=>{t(!1)}})))}var Ge=i(38697);function Ke(e){const{firstItemId:t}=e,i=(0,Se.VK)((()=>{var e;return null===(e=Be.Z.state)||void 0===e?void 0:e.discussionIds.some((e=>e===t))}),[t]),o=(0,Se.VK)((()=>Me.Z.state.open&&Me.Z.state.discussionIds&&Me.Z.state.discussionIds.some((e=>e===t))),[t]),s=(0,fe.y)((t=>({hoveredStyle:{background:"sidebar"===e.location?t.hoveredDiscussionBackground:void 0},pressedStyle:{background:"sidebar"===e.location?t.focusDiscussionBackground:void 0},basicDesktopTitleStyle:{paddingLeft:16,paddingTop:16,marginBottom:0,marginTop:0,fontSize:12.5,transition:"background 300ms ease"},mobileTitleStyle:{fontSize:13,fontWeight:E.Z.fontWeight.medium,paddingBottom:0,textTransform:"unset",marginTop:-12}})),[e.location]);return c().createElement(Fe.Z,n()({desktopTitleStyle:{...s.basicDesktopTitleStyle,...i?s.hoveredStyle:{},...o?s.pressedStyle:{}},mobileTitleStyle:s.mobileTitleStyle,disableDesktopPadding:!0,disableMobileBorders:!0},e))}var je=i(70268),Ye=i(77546),Qe=i(76248);const Xe=new _e.Z;function Je(e){const{timeMounted:t,location:i}=e,o=(0,ye.O7)(),[s,a]=(0,d.useState)(!1),l=(0,Se.VK)((()=>H.Z.state.currentBlockStore),[]),h=(0,Se.VK)((()=>o.currentUser.id),[o]),p=(0,Se.VK)((()=>(0,be.DF)({blockStore:l,ignoreAfterTime:t,currentUserId:h})),[l,t,h]),[m]=(0,Se.oR)(Le.ZP),g=(0,Se.VK)((()=>(0,ee._c)(o)),[o]),b=(0,Se.VK)((()=>Me.Z.state.open&&Me.Z.state.discussionIds||[]),[]),{resolved:v,unresolved:y}=(0,Se.VK)((()=>(0,Ue.bB)(p)),[p]),S=m.commentsMode===Le.F7.Unresolved,f=S?y:v,M=f.map((e=>e.id));(0,d.useEffect)((()=>{if("popup"===i&&s)return()=>{(0,Pe.AM)(M)}}),[i,M,s]);const Z=(0,fe.y)((e=>({commentsEmptyStyle:{flex:1,display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",textAlign:"center",color:e.mediumTextColor,fontSize:14,position:"relative",background:e.contentBackground,marginRight:g?2:0,pointerEvents:"auto",paddingTop:10},commentsContentStyle:{position:"relative",minHeight:0,display:"flex",flexDirection:"column",background:e.contentBackground,marginRight:g?2:0,pointerEvents:"auto",height:"100%"},commentsIconStyle:{height:54,width:54,marginBottom:12,fill:e.mediumIconColor}})),[g]),k=(0,d.useRef)(null),T=(0,Se.VK)((()=>(0,ee.Sx)(o)),[o]);(0,Ge.O)({active:T,closeHandler:Re.LZ,ref:k});const w=(0,Se.VK)((()=>ge.groupBy(f,(e=>{const t=(0,be.Qg)({recordStore:e,currentUserId:h});return(0,Ce.Z)(null==t?void 0:t.created_time).format("YYYY-MM-DD")}))),[f,h]),C=(0,Se.VK)((()=>(0,be.W5)(f)),[f]);if((0,d.useEffect)((()=>{s||C||a(!0)}),[s,C]),!l||!w||!s)return r()(je.B,{areaHeight:window.innerHeight});if(0===f.length)return r()("div",{style:Z.commentsContentStyle},void 0,r()(qe,{}),r()("div",{style:Z.commentsEmptyStyle},void 0,u.Z.commentSidebarZero(Z.commentsIconStyle),r()("div",{style:{fontWeight:E.Z.fontWeight.semibold,marginBottom:4}},void 0,r()(ie._H,S?{id:"updateSidebar.commentContainer.emptyTitleUnresolved",defaultMessage:"No open comments yet"}:{id:"updateSidebar.commentContainer.emptyTitleResolved",defaultMessage:"No resolved comments yet"})),r()("div",{style:{width:200,alignSelf:"center"}},void 0,r()(ie._H,S?{id:"updateSidebar.commentContainer.emptyUnresolved",defaultMessage:"Open comments on this page will appear here"}:{id:"updateSidebar.commentContainer.emptyResolved",defaultMessage:"Resolved comments on this page will appear here"}))));const I=Object.keys(w).sort().reverse(),B=I.map(((e,s)=>{const r=we.ZV({value:{type:"date",start_date:e},date_format:"relative",userTimeZone:Te.x7,intl:ve.Z.getIntl(),allowRelativeDates:!0}),a=w[e];return{key:e,render:e=>c().createElement(Ke,n()({title:r,firstItemId:a[0].id,location:i},e)),items:a.map(((e,r)=>({key:e.id,render:o=>c().createElement(Ae,n()({},o,{currentBlockStore:l,discussion:e,isFirstInSection:0===r,location:i,isLast:r===a.length-1&&s===I.length-1,showAllRepliesAfterTimestamp:t})),action:()=>{(0,Pe.en)({discussionId:e.id,currentBlockStore:l,environment:o,analyticsFrom:"updates_sidebar",currentEl:k.current})}})))}})),x=B.flatMap((e=>e.items)).findIndex((e=>b.includes(e.key.toString())));return c().createElement("div",{style:Z.commentsContentStyle,ref:k},r()(qe,{}),r()(ke.ZP,{type:ke.xm.Y,style:{flexGrow:1,minHeight:0,transform:"translateZ(0px)",zIndex:1,overflow:"hidden auto",marginBottom:0},className:R.Xs},void 0,r()(Ze.Z,{disableKeyboard:!0,store:Xe,type:Ze.Z.Type.Vertical,initialFocus:x>=0?x:void 0,scrollElIntoView:e=>{if(e instanceof Element){const t=e.getBoundingClientRect(),i=Qe.Z.getTopbarHeight(o),n=window.innerHeight,s=i+50,r=n-s;if(t.height>=r)return;const a=t.top>=s&&t.top<=n,l=a&&t.bottom>=n,d=t.bottom>=s&&t.bottom<=n,c=d&&t.top-s<0,h=a||d,p=.4*t.height;l&&Math.abs(t.top-n)<p?(0,Ye.Wr)(e,{edgeDist:n-t.height-s,animate:!0}):c&&Math.abs(t.bottom-s)<p?(0,Ye.Wr)(e,{edgeDist:0,animate:!0}):h||(0,Ye.Wr)(e,{edgeDist:0,animate:!0})}},sections:B})))}var $e=i(15282),et=i(95009),tt=i(30496),it=i(17215),ot=i(67598),nt=i(61208);function st(){const e=(0,d.useCallback)((()=>r()(nt.Z,{message:r()(ie._H,{defaultMessage:"Any changes to this page will show up here.",id:"updatesModal.currentPageTab.emptyPrompt"}),title:r()(ie._H,{defaultMessage:"No page updates",id:"updatesModal.currentPageTab.emptyPromptTitle"})})),[]),[{currentSpaceStore:t,currentBlockStore:i}]=(0,Se.oR)(H.Z),o=(0,Se.VK)((()=>null==i?void 0:i.getValue()),[i]);if(!t||!o)return null;let n;if(o&&it.YG(o)){const e=(0,it.kW)(o);e&&(n=e.id)}return r()(ot.Z,{navigableBlockId:o.id,collectionId:n,spaceId:t.id,empty:e,analyticsContext:"click_all_updates",isTopbarUpdatesMenu:!0,source:"notifications"},"current-page")}var rt=i(53412),at=i(29368),lt=i(92547),dt=i(17503),ct=i(59488),ht=i(95155);class pt extends S.Z{constructor(...e){super(...e),l()(this,"storeTypes",{shareButtonPopupStore:b.Z}),l()(this,"hasUnreadCommentsStore",this.createComputedStore((()=>(0,be.DF)({blockStore:this.props.store,currentUserId:this.environment.currentUser.id}).some((e=>{var t;return!(null!==(t=e.getValue())&&void 0!==t&&t.resolved)&&(0,be.NI)(e).some((t=>(0,dt.t)({discussionStore:e,commentValue:t.getValue()})))}))),!1)),l()(this,"handleOpenQuickFind",(()=>{O.UT({environment:this.environment,analyticsFrom:"public-page-topbar"})})),l()(this,"handleShareClick",(()=>{p.DB2(this.environment),w.bi(this.environment)})),l()(this,"handleTopbarClick",(()=>{I.ZH(this.environment)})),l()(this,"navigateToFirstSpace",(()=>{const{currentUserRootStore:e,currentUserSettingsStore:t}=H.Z.state;e&&t&&F.L5({environment:this.environment,userRootStore:e,userSettingsStore:t})})),l()(this,"handleMoveToClick",(e=>{D.bA({blocks:[this.props.store],analyticsFrom:"quick_add",onAccept:this.handleMoveToAccept,isAddTo:!0})})),l()(this,"handleMoveToAccept",(e=>{const{currentSpaceStore:t}=H.Z.state;t&&this.props.saveParent&&W.rq({currentUserId:this.environment.currentUser.id,spaceId:t.id,value:e}),p.xx2(this.environment)})),l()(this,"handleCancelQuickAdd",(e=>{const t=H.Z.state.currentBlockStore,i=Q.Z.state.lastPageId;t&&i&&(z._c({environment:this.environment,store:m.Z.createChildStore(t,{table:Y.iU,id:i}),showMoveTo:!1,saveParent:!1}),K.H5(this.environment,(e=>{G.y8({environment:this.environment,blocks:[t],transaction:e})})))}))}renderComponent(){const{store:e}=this.props,{WindowSizeStore:t,device:i}=this.environment,o=(0,_.IJ)(this.environment,this.props.store),s=new lt.Z,a=(e.isLocked()||s.state.justUnlocked)&&e.canEdit(),l=(!o||e.canEdit())&&i.isPhone&&(e.isRestricted()||a);return r()(Z.Z,{capture:!0,render:i=>c().createElement("div",n()({},i,{style:this.getWrapStyle()}),o?this.renderPublicPageTopbar():this.renderNormalTopbar(),l&&r()(j.Z,{type:j.$.White,isMobile:!0,style:{justifyContent:"unset"}},void 0,r()(B.Z,{store:this.props.store,isMobile:!0,lockStore:s},this.props.store.id),e.isRestricted()&&c().createElement(c().Fragment,null,a&&r()(at.Z,{vertical:!0,size:10,style:{height:"50%"}}),r()(re.Z,{style:{marginRight:8},onClick:()=>{this.stores.shareButtonPopupStore.setState({open:!0})}}))),this.props.isOffline&&r()(j.Z,{type:j.$.White,isMobile:!0},void 0,r()("div",{style:{display:"flex",alignItems:"center",width:"100%",paddingLeft:t.getSafePaddingLeftCSS(10),paddingRight:t.getSafePaddingRightCSS(14)}},void 0,u.Z.mobileOffline({width:26,marginRight:12}),r()("div",{},void 0,r()(ie._H,{defaultMessage:"You're offline",id:"topbarMobile.offline.message"})))),r()(f.Z,{banners:this.props.banners,isMobile:!0}))})}renderPublicPageTopbar(){const{store:e}=this.props;return r()("div",{onClick:this.handleTopbarClick,style:this.getStyle(),className:R.ZH},void 0,this.environment.currentUser.isLoggedIn()&&r()(d.Fragment,{},void 0,r()(A.Z,{style:{display:"flex",alignItems:"center",height:"100%",paddingLeft:14,paddingRight:14,fontWeight:E.Z.fontWeight.medium,color:this.theme.regularTextColor,whiteSpace:"nowrap"},mobileFeedback:!0,onClick:this.navigateToFirstSpace},void 0,r()(ie._H,{defaultMessage:"Back",id:"topbarMobile.backButton.label"})),r()("div",{style:{height:18,width:1,flexShrink:0,marginRight:6,background:this.theme.darkDividerColor}})),r()(v.Z,{store:this.props.store,style:this.getBreadcrumbsStyle(),maxAncestorCount:1,showCurrentPageControls:!1,ancestorMaxWidth:100,currentPageMaxWidth:220,isMobile:!0}),r()("div",{style:{flexGrow:1,flexShrink:1}}),r()(L.Z,{onClick:this.handleOpenQuickFind},void 0,u.Z.searchThick({width:20,height:20})),r()(U.Z,{store:e,buttonPopupStore:x.Z}))}renderNormalTopbar(){const{store:e,pageVisitStore:t,presenceStore:i}=this.props,{isTablet:o}=this.environment.device,n=this.props.isInvalidPage;return r()("div",{onClick:this.handleTopbarClick,style:this.getStyle(),className:R.ZH},void 0,(!ct.wm()||"on"===ht.Z.getGroup("mobile-home-tab-allow-web-sidebar"))&&this.renderHamburgerButton(),o&&r()(oe.Z,{}),!n&&this.renderBreadcrumbs(),e.canEdit()&&o&&r()(B.Z,{store:e,isMobile:!1},e.id),r()(k.Z,{}),e.isRestricted()&&o&&r()(re.Z,{style:{marginRight:8},onClick:()=>{this.stores.shareButtonPopupStore.setState({open:!0})}}),o&&e.canEdit()&&t&&i&&r()(te.Z,{rootStore:e,pageVisitStore:t,presenceStore:i}),this.props.shouldShowMoveTo?this.renderCancelQuickAdd():this.renderRightButtons())}renderHamburgerButton(){const e=P.Z.getUnreadMentionsCountForOtherSpaces()+(this.environment.device.isMobileBrowser?P.Z.getUnreadCountForCurrentSpace().mentions+P.Z.getUnreadCountForCurrentSpace().following:0);return r()(A.Z,{mobileFeedback:!0,style:{position:"relative",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,height:"100%",width:36,marginLeft:4},onClick:()=>{if((0,ee.Jr)(this.environment))C.lE({environment:this.environment,isExpanded:!$.gV.get()});else{const{NativeMobileActionBarStore:e}=this.environment,t=e?e.state.menuType:null;"editing"===le.Z.state.mode||null!==t?(de.ZH(this.environment),null==e||e.clear(!1),ce.Z.onHide((()=>{he.Z.afterNextFlush((()=>C.bA()))}))):C.bA()}p.jDo(this.environment)}},void 0,u.Z.hamburgerMenu({width:18,height:18}),r()(T.Z,{color:T.Z.Color.Red,count:e,style:{position:"absolute",top:9,right:1}}))}renderBreadcrumbs(){const{isTablet:e}=this.environment.device;return this.props.shouldShowMoveTo?this.renderMoveTo():r()(v.Z,{store:this.props.store,style:this.getBreadcrumbsStyle(),maxAncestorCount:e?2:1,showCurrentPageControls:!1,ancestorMaxWidth:e?160:100,currentPageMaxWidth:e?240:220,isMobile:!0})}renderMoveTo(){const{store:e}=this.props,t=e.getParentStore(),{currentSpaceStore:i}=H.Z.state,o=t instanceof g.Z&&i&&t.id===i.id;if(!(t instanceof pe.Z)&&t){if(o)return r()(A.Z,{mobileFeedback:!0,style:pt.moveToButtonStyle,onClick:this.handleMoveToClick},void 0,r()(ie._H,{defaultMessage:"<mediumcolor>Add to</mediumcolor>{userAvatar}<mediumweight>Private pages</mediumweight>",id:"topbarMobile.addToPrivateSectionButton.label",values:{mediumcolor:(...e)=>r()("span",{style:{color:this.theme.mediumTextColor,marginRight:8}},void 0,e),mediumweight:(...e)=>r()("span",{style:{fontWeight:E.Z.fontWeight.medium,marginLeft:4}},void 0,e),userAvatar:r()(X.Z,{size:22,avatarShouldShowShadow:!0,userValue:(0,J.S4)(this.environment)})}}),this.renderChevron());{const i=e instanceof g.Z?(0,se.getSpaceIcon)(this.environment,e):e.getIcon();return r()(A.Z,{mobileFeedback:!0,style:pt.moveToButtonStyle,onClick:this.handleMoveToClick},void 0,r()("span",{style:{color:this.theme.mediumTextColor}},void 0,r()(ie._H,{defaultMessage:"Add to",id:"topbarMobile.addToPageOrWorkspaceSectionButton.label",description:"Displayed to the user in front of a page or space, like 'Add to Page', where 'Page' is an existing page."})," "),r()(N.Z,{disabled:!0,icon:i,isEmptyPage:t.table===Y.iU&&t.isEmptyPage(),title:t instanceof g.Z?(0,se.getSpaceName)(this.environment,t):void 0,size:24,style:{marginLeft:8,marginRight:4}}),r()(V.Z,{style:{fontWeight:E.Z.fontWeight.semibold},store:t}),this.renderChevron())}}}renderChevron(){return u.Z.chevronDown({marginLeft:4,width:10,fill:this.theme.lightTextColor})}renderRightButtons(){if(!this.props.isInvalidPage)return r()(d.Fragment,{},void 0,this.renderPageUpdatesPopupOrigin(),this.renderShare(),this.renderCommentsButton(),this.renderShowMore())}renderCancelQuickAdd(){return r()(A.Z,{mobileFeedback:!0,style:{display:"flex",alignItems:"center",height:"100%",paddingLeft:16,paddingRight:16,fontWeight:E.Z.fontWeight.medium,color:q.ZP.blue},onClick:this.handleCancelQuickAdd},void 0,r()(ie._H,{defaultMessage:"Cancel",id:"topbarMobile.cancelQuickAddButton.label"}))}renderShowMore(){return r()(M.Z,{store:this.props.store,collectionViewStore:this.props.collectionViewStore,buttonPopupStore:x.Z})}renderShare(){const{device:e}=this.environment;return r()(y.Z,{popupType:e.isMobile?y.Z.PopupType.SlideUp:y.Z.PopupType.Popup,style:{width:460},buttonPopupStore:this.stores.shareButtonPopupStore,onClick:this.handleShareClick,renderOrigin:t=>c().createElement(A.Z,n()({mobileFeedback:!0,style:pt.actionButtonStyle},t),e.isAndroid?u.Z.androidShare({width:16,height:16}):u.Z.iOSShare({width:26})),render:()=>r()(ae.L_,{buttonPopupStore:this.stores.shareButtonPopupStore,store:this.props.store,onClose:()=>{this.stores.shareButtonPopupStore.setState({...this.stores.shareButtonPopupStore.state,open:!1})}})})}renderPageUpdatesPopupOrigin(){const e={menuType:et.ZP.MenuType.Modal,title:r()(ie._H,{defaultMessage:"Page Updates",id:"pageUpdatesModal.mobileMenu.title"}),right:r()($e.DoneMenuText,{}),onClickRight:()=>tt.Z.setState({open:!1}),whiteBackground:!0};return r()(He.ZP,{open:tt.Z.state.open,popupType:y.Z.PopupType.SlideUp,alignmentToOrigin:ue.v2.Start,placementToOrigin:ue.ug.Right,originGap:0,isWideTabletWidth:!0,render:()=>c().createElement(et.ZP,e,r()(st,{})),isFullWidthOnMobile:!0,preventScaleTransition:!0})}renderCommentsButton(){return r()(y.Z,{buttonPopupStore:rt.Z,popupType:y.Z.PopupType.SlideUp,alignmentToOrigin:ue.v2.Start,placementToOrigin:ue.ug.Right,originGap:0,isWideTabletWidth:!0,render:e=>r()(et.ZP,{menuType:et.og.Modal,scrollerStyle:{paddingBottom:0},title:r()(ie._H,{defaultMessage:"Comments",id:"topbarMobile.commentsMenu.title"}),right:r()($e.DoneMenuText,{}),onClickRight:e.close},void 0,r()(Je,{timeMounted:Date.now(),location:"popup"})),isFullWidthOnMobile:!0,preventScaleTransition:!0,renderOrigin:e=>r()("div",{style:{position:"relative",height:"100%"}},void 0,c().createElement(me.Z,n()({icon:u.Z.mobileTopbarComments,iconStyle:{width:26,height:26,fill:"inherit"},isDarkIconColor:!0,style:{marginLeft:6,marginRight:6,height:"100%"},mobileFeedback:!0},e)),this.hasUnreadCommentsStore.state&&r()("div",{style:{position:"absolute",top:9,right:5,height:8,width:8,borderRadius:4,background:q.ZP.red}}))})}getWrapStyle(){return{width:"100%",maxWidth:"100vw",zIndex:h.lI}}getStyle(){const{WindowSizeStore:e}=this.environment;return{display:"flex",justifyContent:"space-between",alignItems:"center",width:"100%",maxWidth:"100vw",height:ne.g,marginTop:e.state.paddingTopCSS,paddingLeft:e.getSafePaddingLeftCSS(0),paddingRight:this.props.shouldShowMoveTo?e.getSafePaddingRightCSS(0):e.getSafePaddingRightCSS(7),boxShadow:"0 1px 0 ".concat(this.theme.darkDividerColor),background:this.theme.contentBackground,transition:"box-shadow 300ms",WebkitUserSelect:"none",cursor:"pointer"}}getBreadcrumbsStyle(){const{isTablet:e}=this.environment.device;return{flexGrow:0,marginLeft:2,overflow:"auto",WebkitOverflowScrolling:"touch",marginRight:e?16:8,height:"100%"}}}l()(pt,"actionButtonStyle",{display:"flex",alignItems:"center",height:"100%",paddingLeft:8,paddingRight:8}),l()(pt,"moveToButtonStyle",{display:"flex",alignItems:"center",paddingLeft:8,paddingRight:12,fontSize:E.Z.fontSize.UIRegular.mobile,lineHeight:E.Z.lineHeight.UIRegular.mobile,whiteSpace:"nowrap",minWidth:0});const ut=pt},70951:(e,t,i)=>{i.d(t,{Z:()=>he});var o=i(67154),n=i.n(o),s=i(98135),r=i.n(s),a=i(59713),l=i.n(a),d=(i(33948),i(67294)),c=i.n(d),h=i(19757),p=i(46167),u=i(66832),m=i(14694),g=i(98742),b=i(37235),v=i(82990),y=i(3779),S=i(96486),f=i.n(S),M=i(8522),Z=i(63143),k=i(7765),T=i(32935),w=i(12318),C=i(12235),I=i(65598),B=i(90031),x=i(27832),P=i(88632),A=i(6650),R=i(44615),_=i(65311),L=i(4761),U=i(5366),O=i(70268);const H={mentions:!0,following:!0,archive:!1};class F extends u.Z{constructor(...e){super(...e),l()(this,"storeTypes",{size:w.Z.of(20),checkpoint:w.Z.of(Math.random())}),l()(this,"renderRequest",((e,t,i)=>{const o=x.Z.state.currentSpaceStore;if(!o||e)return r()("div",{style:this.getPlaceholderContentStyle()},void 0,r()(U._H,{defaultMessage:"Something went wrong.",id:"notificationUpdates.unknownErrorMessage"}));if(!t)return r()("div",{style:this.getContentStyle()},void 0,r()(O.B,{areaHeight:window.innerHeight}));const n=t.map((e=>(0,B.Kv)(o,{table:_.uX,id:e}))),s=f().compact(n.map((e=>{const t=e.getValue();if(!t)return;if(t.invalid)return;if(t.visited&&H[this.props.type]||!t.visited&&"archive"===this.props.type)return;const i=I.sl(e);if(!i)return;const o=i.getValue();return o&&!o.invalid?{activity:o,notification:t}:void 0}))),a=this.stores.size.get(),l=0===s.length;return L.Z.setState({...L.Z.state,isCurrentTabEmpty:l}),r()("div",{style:l?this.getPlaceholderContentStyle():this.getContentStyle()},void 0,l&&this.props.empty,r()("div",{className:"notranslate"},void 0,s.map((({activity:e,notification:t},i,n)=>{const s=n.length-1===i;return r()(M.Z,{activity:e,rootStore:o,isLast:s,notification:t,analyticsContext:this.props.analyticsContext,isTopbarUpdatesMenu:!1,source:"notifications"},e.id)}))),r()(C.Z,{onChange:e=>{e<200&&i&&t&&t.length>=a&&this.stores.size.set(t.length+20)}},void 0,!i&&r()(O.B,{areaHeight:window.innerHeight})))})),l()(this,"handleActivityEmit",(()=>{this.stores.checkpoint.set(Math.random())})),l()(this,"handleActivityEmitThrottled",f().throttle(this.handleActivityEmit,1e3)),l()(this,"handleNotificationEmit",Z.YX(this.handleActivityEmitThrottled)),l()(this,"notificationListenerReference",void 0)}willMount(){this.startMessageListeners()}willUnmount(){this.stopMessageListeners()}renderComponent(){return P.Z.state.online?this.renderOnline():this.renderOffline()}renderOffline(){return r()("div",{style:this.getPlaceholderContentStyle()},void 0,r()("div",{},void 0,r()(U._H,{defaultMessage:"Please go online to view updates.",id:"notificationUpdates.offline.message"})))}renderOnline(){const{currentUserStore:e,currentSpaceStore:t}=x.Z.state;if(!e||!t)return;const i=t.id,o=this.stores.size.get(),n=this.stores.checkpoint.get(),s=this.props.type;return r()(k.Z,{throttle:1e3,request:{spaceId:i,size:o,type:s,checkpoint:n},performRequest:async({spaceId:e,size:t,type:i})=>{const o=await T.BOq(this.environment,{spaceId:e,size:t,type:i});if("failed"===o.type)throw o.error;return o.data.notificationIds},render:this.renderRequest})}startMessageListeners(){const{currentUserStore:e}=x.Z.state;if(e){const t=(0,R.Lp)(e.id);this.notificationListenerReference=A.Z.addListener(t,this.handleNotificationEmit,void 0,this.environment)}}stopMessageListeners(){this.notificationListenerReference&&(A.Z.removeListener(this.notificationListenerReference,this.environment),this.notificationListenerReference=void 0)}getContentStyle(){const{device:e}=this.environment;return{minHeight:e.isMobile||"mentions"===this.props.type?void 0:"75vh",paddingBottom:e.isMobile?44:0}}getPlaceholderContentStyle(){const{device:e}=this.environment;return{...this.getContentStyle(),paddingTop:e.isMobile?64:void 0,minHeight:e.isMobile?void 0:220,display:"flex",textAlign:"center",alignItems:"center",justifyContent:"center",fontSize:14,color:this.theme.mediumTextColor,overflow:"hidden"}}getSpinnerStyle(e){return{...this.getPlaceholderContentStyle(),minHeight:e?64:220}}}const E=F;var D,N=i(67598),V=i(39849),W=i(95009),q=i(17659),z=i(50906),G=i(17215),K=i(66957),j=i(46034),Y=i(62820),Q=i(14786),X=i(54153),J=i(92083),$=i(76487),ee=i(8848),te=i(80527),ie=i(14947),oe=i(43250),ne=i(42001),se=i(15282),re=i(67669),ae=i(97880),le=i(69972),de=i(61208);!function(e){e[e.Sidebar=0]="Sidebar",e[e.SidebarMobile=1]="SidebarMobile",e[e.MobileBottomBarPhone=2]="MobileBottomBarPhone",e[e.MobileBottomBarTablet=3]="MobileBottomBarTablet",e[e.TopbarMobile=4]="TopbarMobile"}(D||(D={}));class ce extends u.Z{constructor(...e){super(...e),l()(this,"renderSpaceUpdates",(()=>{const{device:e}=this.environment;let t;return t=e.isMobile?{menuType:W.ZP.MenuType.Modal,title:r()(U._H,{defaultMessage:"All Updates",id:"updatesModal.mobileMenu.title"}),right:r()(se.DoneMenuText,{}),onClickRight:this.closeMenu,left:y.Z.settings({fill:ee.ZP.blue,width:18,height:18}),onClickLeft:this.handleOpenSettings,header:this.renderHeader(),whiteBackground:!0,footer:this.renderFooter()}:{menuType:W.ZP.MenuType.Popup,header:this.renderHeader(),maxHeight:"80vh",height:"auto",footer:this.renderFooter()},r()(j.Z,{onSwipeLeft:this.handleSwipeLeft,onSwipeRight:this.handleSwipeRight,render:e=>c().createElement(W.ZP,n()({},t,e,{className:oe.C1}),r()(le.Z,{capture:!0,allowUndo:!0,allowEsc:!0,render:()=>this.renderContent()}))})})),l()(this,"closeMenu",(()=>{Y.Z.setState({...Y.Z.state,open:!1}),this.setCurrentTabAsRead()})),l()(this,"handleDismiss",(()=>{this.setCurrentTabAsRead()})),l()(this,"handleClick",(()=>{this.handleTrackTab()})),l()(this,"handleSwipeLeft",(()=>{const e=this.tabs.indexOf(L.Z.state.currentTab)+1,t=this.tabs[e];void 0!==t&&this.changeTab(t)})),l()(this,"handleSwipeRight",(()=>{const e=this.tabs.indexOf(L.Z.state.currentTab)-1,t=this.tabs[e];void 0!==t&&this.changeTab(t)})),l()(this,"handleTabClick",(e=>{const t=this.tabs[e];L.Z.state.currentTab!==t&&this.changeTab(t)})),l()(this,"handleOpenSettings",(()=>{const{device:e}=this.environment;z.FRk(this.environment),e.isMobile?Q.Z.setState({open:!0}):(Y.Z.setState({...Y.Z.state,open:!1}),J.ZP.setState({...J.ZP.state,currentTab:"notifications_and_settings"}),J.ZP.setState({...J.ZP.state,open:!0}))})),l()(this,"handleArchiveAll",(()=>{const e=L.Z.state.currentTab;(0,L.g)(e)&&q.rG(this.environment,e)})),l()(this,"setCurrentTabAsRead",(()=>{q.go(this.environment)}))}willMount(){const e=X.Z.get(ce.lastUpdatesTabKey);e&&this.tabs.includes(e)&&this.setTabState(e)}renderComponent(){const{device:e}=this.environment;return r()(b.Z,{renderTooltip:()=>r()(U._H,{defaultMessage:"Updates for all pages in this space",id:"updatesButton.tooltip"}),originGap:6,placement:h.ug.Right,render:t=>r()(p.Z,{popupType:e.isMobile?p.Z.PopupType.SlideUp:p.Z.PopupType.Popup,alignmentToOrigin:h.v2.Start,placementToOrigin:h.ug.Right,onClick:this.handleClick,originGap:0,style:{...!e.isMobile&&{width:500,overflow:"hidden"}},isWideTabletWidth:!0,render:this.renderSpaceUpdates,onClose:this.handleDismiss,isFullWidthOnMobile:!0,preventScaleTransition:!0,buttonPopupStore:Y.Z,renderOrigin:e=>this.renderButton(t,e)})})}renderButton(e,t){const i=this.props.format,o=$.Z.getUnreadCountForCurrentSpace(),s=o.mentions>0||o.following>0,a=Y.Z.state.open,l=o.mentions;return i===D.MobileBottomBarPhone?c().createElement(ie.Z,n()({style:ce.mobileBottomBarPhoneButtonStyle,mobileFeedback:!0},t),r()("div",{style:{position:"relative"}},void 0,y.Z.mobileBottomBarUpdates({width:26,fill:this.theme.regularTextColor}),r()(V.Z,{color:V.Z.Color.Red,count:l,style:{position:"absolute",top:-3,right:l<99?-5:-8}}))):i===D.MobileBottomBarTablet?c().createElement(ie.Z,n()({style:ce.mobileBottomBarTabletButtonStyle,mobileFeedback:!0},t),r()("div",{style:{position:"relative"}},void 0,y.Z.mobileBottomBarUpdates({width:26,fill:this.theme.regularTextColor}),r()(V.Z,{color:V.Z.Color.Red,count:l,style:{position:"absolute",top:-3,right:l<99?-5:-8}}))):i===D.TopbarMobile?c().createElement(ie.Z,n()({style:{...ce.actionButtonStyle,marginLeft:2,marginRight:2},mobileFeedback:!0},t),y.Z.mobileBottomBarUpdates({width:26}),r()(V.Z,{color:V.Z.Color.Red,count:l,style:{position:"absolute",top:8,right:0}})):i===D.SidebarMobile?c().createElement(ie.Z,n()({style:ce.actionButtonStyle,mobileFeedback:!0},t),y.Z.mobileBottomBarUpdates({width:26}),r()(V.Z,{color:V.Z.Color.Red,count:l,style:{position:"absolute",top:8,right:0}})):i===D.Sidebar?c().createElement(ie.Z,n()({style:{...s&&{fontWeight:v.Z.fontWeight.medium,color:this.theme.regularTextColor}}},(0,g.Z)(e,t)),r()(m.Z,{isMobile:!1,left:r()("div",{style:{color:s?this.theme.regularTextColor:"inherit"}},void 0,y.Z.typesCreatedAt({fill:s?this.theme.regularIconColor:this.theme.mediumIconColor,width:14})),right:r()(V.Z,{color:V.Z.Color.Red,count:l,style:{marginBottom:2,marginLeft:6}}),style:{background:a?this.theme.buttonHoveredBackground:"none"}},void 0,r()(U._H,{defaultMessage:"All Updates",id:"updatesButton.allUpdates.sidebarButton"}))):void 0}renderHeader(){const{device:e}=this.environment,{currentTab:t}=L.Z.state,i=this.tabs.indexOf(t),o=$.Z.getUnreadCountForCurrentSpace(),n={mentions:r()("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",fontWeight:o.mentions>0?v.Z.fontWeight.medium:void 0},className:oe.I2},void 0,r()("div",{},void 0,r()(U._H,{defaultMessage:"Inbox",id:"updatesModal.mentionsTab.title"})),r()(V.Z,{color:V.Z.Color.Red,count:o.mentions,style:{marginLeft:6},numberStyle:{marginBottom:e.isMobile?0:2}})),following:r()("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",fontWeight:o.following>0?v.Z.fontWeight.medium:void 0}},void 0,r()("div",{},void 0,r()(U._H,{defaultMessage:"Following",id:"updatesModal.followedUpdatesTab.title"})),r()(V.Z,{color:V.Z.Color.Gray,count:o.following,style:{marginLeft:6},numberStyle:{marginBottom:e.isMobile?0:2}})),allPages:r()("div",{className:oe.gj},void 0,r()(U._H,{defaultMessage:"All",id:"updatesModal.allUpdatesTab.title"})),archive:r()("div",{className:oe.HK},void 0,r()(U._H,{defaultMessage:"Archived",id:"updatesModal.archiveTab.title"})),currentPage:e.isMobile&&r()("div",{},void 0,r()(U._H,{defaultMessage:"This page",id:"updatesModal.mobileThisPage.title"}))},s=this.tabs.map((e=>n[e]));return r()(d.Fragment,{},void 0,r()(K.Z,{tabs:s,selectedIndex:i,onChange:this.handleTabClick,separatorIndexes:[this.tabs.indexOf("archive")-1],right:!e.isMobile&&this.renderNotificationSettingsButton()}))}renderNotificationSettingsButton(){return r()(b.Z,{renderTooltip:()=>r()(U._H,{defaultMessage:"Open notifications settings",id:"updatesModal.openNotifications.tooltip"}),render:e=>c().createElement(te.Z,n()({icon:y.Z.sidebarSettings,onClick:this.handleOpenSettings},e))})}renderContent(){const e=L.Z.state.currentTab;if("following"===e)return r()(E,{type:"following",empty:r()(de.Z,{message:r()(U._H,{defaultMessage:"Turn on “Follow this page” in the Updates menu on any page to receive updates here.",id:"updatesModal.followedUpdatesTab.allArchived"}),title:r()(U._H,{defaultMessage:"No new updates",id:"updatesModal.followedUpdatesTab.allArchivedTitle"})}),analyticsContext:"click_followed_pages"},"following");if("allPages"===e){const{currentSpaceStore:e}=x.Z.state;return e?r()(N.Z,{spaceId:e.id,empty:()=>r()(de.Z,{message:r()(U._H,{defaultMessage:"Updates on pages in your workspace will appear here.",id:"updatesModal.allPagesTab.emptyPrompt"}),title:r()(U._H,{defaultMessage:"No new updates",id:"updatesModal.allPagesTab.emptyPromptTitle"})}),source:"all_updates",analyticsContext:"click_all_updates",isTopbarUpdatesMenu:!1},"all-pages"):null}if("mentions"===e)return r()(E,{type:"mentions",empty:r()(de.Z,{message:(0,re.uT)(this.environment)?r()(U._H,{defaultMessage:"When someone @mentions you, replies to your comments, sends you a request, or invites you to a page, you’ll be notified here.",id:"updatesModal.spaceUpdatesTab.allArchivedRequests"}):r()(U._H,{defaultMessage:"When someone @mentions you, replies to your comments, or invites you to a page, you’ll be notified here.",id:"updatesModal.spaceUpdatesTab.allArchived"}),title:r()(U._H,{defaultMessage:"You're all caught up",id:"updatesModal.spaceUpdatesTab.allArchivedTitle"})}),analyticsContext:"click_comments_and_mentions"},"mentions");if("archive"===e)return r()(E,{type:"archive",empty:r()(de.Z,{message:r()(U._H,{defaultMessage:"Any Inbox updates you archived will show up here.",id:"updatesModal.archiveTab.emptyPrompt"}),title:r()(U._H,{defaultMessage:"No archived updates",id:"updatesModal.archiveTab.emptyPromptTitle"})}),analyticsContext:"click_followed_pages"},"archive");if("currentPage"===e){const{currentSpaceStore:e,currentBlockStore:t}=x.Z.state;if(!e||!t)return null;const i=t.getValue();let o;if(i&&G.YG(i)){const e=(0,G.kW)(i);e&&(o=e.id)}return r()(N.Z,{navigableBlockId:t.id,collectionId:o,spaceId:e.id,empty:()=>r()(de.Z,{message:r()(U._H,{defaultMessage:"Any changes to this page will show up here.",id:"updatesModal.currentPageTab.emptyPrompt"}),title:r()(U._H,{defaultMessage:"No page updates",id:"updatesModal.currentPageTab.emptyPromptTitle"})}),analyticsContext:"click_all_updates",isTopbarUpdatesMenu:!0,source:"notifications"},"current-page")}(0,ae.t1)(e)}renderFooter(){const{currentTab:e,isCurrentTabEmpty:t}=L.Z.state;if("mentions"!==e)return;if(t)return;const{device:i}=this.environment;return r()("div",{style:this.getInboxActionsStyle()},void 0,r()(ne.Z,{onClick:this.handleArchiveAll,style:this.getArchiveButtonStyle(),mobileFeedback:i.isMobile},void 0,y.Z.archive({width:i.isMobile?16:14,fill:"inherit",marginLeft:i.isMobile?6:0,marginRight:i.isMobile?8:6}),r()(U._H,{defaultMessage:"Archive all",id:"updatesModal.spaceUpdatesTab.archiveAllButtonTitle"})))}setTabState(e){X.Z.get(ce.lastUpdatesTabKey)!==e&&X.Z.set(ce.lastUpdatesTabKey,e),L.Z.state.currentTab!==e&&L.Z.setState({...L.Z.state,currentTab:e})}handleTrackTab(){let e;switch(L.Z.state.currentTab){case"mentions":e="mentions_comments";break;case"following":e="followed_pages";break;default:e="all_updates"}z.tmQ(this.environment,{tab:e}),z.nBz(this.environment,{itemName:"updates"})}changeTab(e){this.setCurrentTabAsRead(),this.setTabState(e),this.handleTrackTab()}get tabs(){return this.environment.device.isMobile?["mentions","following","allPages","currentPage","archive"]:["mentions","following","allPages","archive"]}getInboxActionsStyle(){const{device:e}=this.environment;return{display:"flex",alignItems:e.isMobile?"flex-start":"center",background:e.isMobile?this.theme.contentBackground:this.theme.sidebarBackground,boxShadow:"0 -1px 0 ".concat(this.theme.regularDividerColor),marginTop:1,position:e.isMobile?"relative":"sticky",left:0,right:0,bottom:0}}getArchiveButtonStyle(){const{device:e}=this.environment;return{paddingLeft:e.isMobile?0:14,paddingRight:e.isMobile?8:12,marginRight:"auto",width:"100%",color:e.isMobile?this.theme.blueColor:this.theme.mediumTextColor,fill:e.isMobile?this.theme.blueColor:this.theme.mediumTextColor,height:e.isMobile?44:36,borderRadius:0,fontSize:e.isMobile?16:12,fontWeight:e.isMobile?500:400,justifyContent:e.isMobile?"center":void 0}}}l()(ce,"Format",D),l()(ce,"lastUpdatesTabKey","LastUpdatesTab"),l()(ce,"actionButtonStyle",{display:"flex",alignItems:"center",justifyContent:"center",flexGrow:0,flexShrink:0,height:"100%",minWidth:34,position:"relative"}),l()(ce,"mobileBottomBarPhoneButtonStyle",{display:"flex",alignItems:"center",justifyContent:"center",flex:1}),l()(ce,"mobileBottomBarTabletButtonStyle",{display:"flex",alignItems:"center",justifyContent:"center",width:62,flex:"none"});const he=ce},2768:(e,t,i)=>{i.r(t),i.d(t,{default:()=>ae});var o=i(98135),n=i.n(o),s=i(59713),r=i.n(s),a=(i(33948),i(58879)),l=i(96486),d=i.n(l),c=i(67294),h=i.n(c);function p(e,t){const i=(0,c.useRef)(Math.random().toString(36).substr(2,9)),o=t,n=(0,c.useRef)();return(0,c.useEffect)((()=>{if(n&&n.current&&d().isEqual(n.current,o))return;const t=i.current;e&&(e({type:"mount",id:t,props:o}),n.current=o)}),[e,o]),e?i.current:void 0}var u=i(66832),m=i(5366),g=(i(85827),i(74487)),b=i(36054);function v(e,t,i){const{content:o,apiRequestValue:n}=i;return{id:e,content:o,action:{type:t,apiRequestValue:n}}}const y=["insertBlock","turnInto","textColor","textSelectionColor"],S=["textFormatting"];function f(e,t){return{type:e,apiRequestValue:t}}function M(e,t){const i={type:e,data:t};return JSON.stringify(i)}const Z={showActionBarMenu:g.Ry({required:{type:g.i0("showActionBarMenu"),data:g.Ry({required:{actionBarMenuId:g.eR("textColor","insertBlock","turnInto","template")},optional:{}})},optional:{}}),blockAction:g.Ry({required:{type:g.eR("blockAction"),data:g.Ry({required:{action:g.eR("bold","italic","underline","strikethrough","link","code","equation","mention","trash","comment","filePicker","indent","unindent","moveUp","moveDown","undo","redo","dismissKeyboard","more")},optional:{}})},optional:{}})},k=Object.keys(Z);let T;!function(e){e[e.InvalidActionType=0]="InvalidActionType",e[e.MissingPayload=1]="MissingPayload",e[e.InvalidRequestType=2]="InvalidRequestType",e[e.InvalidData=3]="InvalidData"}(T||(T={}));class w{constructor(e,t){this.type=e,this.message=t}}function C(e){return 0===e.reduce(((e,t)=>e+t.items.length),0)}function I(e){const{disableBlockActions:t,disableCommentAction:i,disableMentionAction:o,selectedMenuType:n,disableInsertBlockAction:s,disableTurnIntoAction:r,disableTextFormatting:a,disableDeleteBlock:l,accessibilityTexts:d}=e;return{id:"mab.buttonSection.main",buttons:[v("mab.button.insert","nativeAction_setMenuType",{content:{type:"icon",imageReference:{sfProGlyphName:"plus",localImageIdentifier:"insertBlock"},accessibilityText:d.insert,disabled:t||s,selected:"insertBlock"===n},apiRequestValue:{menuType:"insertBlock"}}),v("mab.button.turnInto","nativeAction_setMenuType",{content:{type:"icon",imageReference:{sfProGlyphName:"arrow.2.squarepath",localImageIdentifier:"turnInto"},disabled:t||r,selected:"turnInto"===n,accessibilityText:d.turnInto},apiRequestValue:{menuType:"turnInto"}}),v("mab.button.filePicker","webAction_generic",{content:{type:"icon",imageReference:{sfProGlyphName:"photo.on.rectangle.angled",localImageIdentifier:"filePicker"},disabled:t,accessibilityText:d.filePicker},apiRequestValue:{jsonPayload:M("blockAction",{action:"filePicker"})}}),v("mab.button.mention","webAction_generic",{content:{type:"icon",imageReference:{sfProGlyphName:"at",localImageIdentifier:"mention"},disabled:o,accessibilityText:d.mention},apiRequestValue:{jsonPayload:M("blockAction",{action:"mention"})}}),v("mab.button.comment","webAction_generic",{content:{type:"icon",imageReference:{sfProGlyphName:"bubble.left",localImageIdentifier:"comment"},disabled:i,accessibilityText:d.comment},apiRequestValue:{jsonPayload:M("blockAction",{action:"comment"})}}),v("bold.italic.underline","nativeAction_setSubMenuType",{content:{type:"icon",imageReference:{sfProGlyphName:"bold.italic.underline",localImageIdentifier:"boldItalicUnderline"},disabled:a,accessibilityText:d.textFormatting},apiRequestValue:{subMenuType:"textFormatting"}}),v("mab.button.delete","webAction_generic",{content:{type:"icon",imageReference:{sfProGlyphName:"trash",localImageIdentifier:"trash"},disabled:l,accessibilityText:d.trash},apiRequestValue:{jsonPayload:M("blockAction",{action:"trash"})}})]}}function B(e){return[v("mab.button.moveUp","webAction_generic",{content:{type:"icon",imageReference:{sfProGlyphName:"arrow.up.to.line.alt",localImageIdentifier:"moveUp"},accessibilityText:e.accessibilityTexts.moveUp,disabled:e.disableBlockActions},apiRequestValue:{jsonPayload:M("blockAction",{action:"moveUp"})}}),v("mab.button.moveDown","webAction_generic",{content:{type:"icon",imageReference:{sfProGlyphName:"arrow.down.to.line.alt",localImageIdentifier:"moveDown"},accessibilityText:e.accessibilityTexts.moveDown,disabled:e.disableBlockActions},apiRequestValue:{jsonPayload:M("blockAction",{action:"moveDown"})}})]}function x(e){const{id:t,disableBlockActions:i,disableIndent:o,disableUnindent:n,shouldFadeIn:s,includeUpAndDown:r,accessibilityTexts:a}=e;if(!(i||o&&n)){var l={id:t,shouldFadeIn:s,buttons:[v("mab.button.indent","webAction_generic",{content:{type:"icon",imageReference:{sfProGlyphName:"decrease.indent",localImageIdentifier:"unindent"},accessibilityText:a.dedent,disabled:i||n},apiRequestValue:{jsonPayload:M("blockAction",{action:"unindent"})}}),v("mab.button.unindent","webAction_generic",{content:{type:"icon",imageReference:{sfProGlyphName:"increase.indent",localImageIdentifier:"indent"},accessibilityText:a.indent,disabled:i||o},apiRequestValue:{jsonPayload:M("blockAction",{action:"indent"})}})]};if(r){var d=B({disableBlockActions:i,accessibilityTexts:{moveUp:a.moveUp,moveDown:a.moveDown}});l.buttons=l.buttons.concat(d)}return l}}function P(e){const{disableUndo:t,disableRedo:i,disableTextActions:o,disableTextColorAction:n,textColorImageReference:s,selectedMenuType:r,accessibilityTexts:a}=e;return{id:"mab.buttonSection.block",buttons:[v("mab.button.undo","webAction_generic",{content:{type:"icon",imageReference:{sfProGlyphName:"arrow.uturn.backward",localImageIdentifier:"undo"},accessibilityText:a.undo,disabled:t},apiRequestValue:{jsonPayload:M("blockAction",{action:"undo"})}}),v("mab.button.redo","webAction_generic",{content:{type:"icon",imageReference:{sfProGlyphName:"arrow.uturn.forward",localImageIdentifier:"redo"},accessibilityText:a.redo,disabled:i},apiRequestValue:{jsonPayload:M("blockAction",{action:"redo"})}}),v("mab.button.textColor.native","nativeAction_setMenuType",{content:{type:"icon",imageReference:s,disabled:o||n,selected:"textColor"===r,accessibilityText:a.blockColor},apiRequestValue:{menuType:"textColor"}}),v("mab.button.more","webAction_generic",{content:{type:"icon",imageReference:{sfProGlyphName:"ellipsis",localImageIdentifier:"more"},accessibilityText:a.more},apiRequestValue:{jsonPayload:M("blockAction",{action:"more"})}})]}}var A=i(67074),R=i(27724);function _(e){const{disableTextActions:t,boldSelected:i,italicSelected:o,underlineSelected:n,strikeSelected:s,codeSelected:r,linkSelected:a,equationSelected:l,selectedMenuType:d,disableTextColorAction:c,disableCommentAction:h,disableLinkAction:p,disableEquationAction:u,textColorImageReference:m,accessibilityTexts:g}=e;return{id:"mab.buttonSection.textFormatting",shouldFadeIn:!0,buttons:[v("mab.button.back","nativeAction_setSubMenuType",{content:{type:"icon",imageReference:{sfProGlyphName:"chevron.backward.2",localImageIdentifier:"back"},accessibilityText:g.close},apiRequestValue:{subMenuType:null}}),v("mab.button.bold","webAction_generic",{content:{type:"icon",imageReference:{sfProGlyphName:"bold",localImageIdentifier:"bold"},accessibilityText:g.bold,disabled:t,selected:i},apiRequestValue:{jsonPayload:M("blockAction",{action:"bold"})}}),v("mab.button.italic","webAction_generic",{content:{type:"icon",imageReference:{sfProGlyphName:"italic",localImageIdentifier:"italic"},disabled:t,selected:o,accessibilityText:g.italics},apiRequestValue:{jsonPayload:M("blockAction",{action:"italic"})}}),v("mab.button.underline","webAction_generic",{content:{type:"icon",imageReference:{sfProGlyphName:"underline",localImageIdentifier:"underline"},disabled:t,selected:n,accessibilityText:g.underline},apiRequestValue:{jsonPayload:M("blockAction",{action:"underline"})}}),v("mab.button.strikethrough","webAction_generic",{content:{type:"icon",imageReference:{sfProGlyphName:"strikethrough",localImageIdentifier:"strikethrough"},disabled:t,selected:s,accessibilityText:g.strikethrough},apiRequestValue:{jsonPayload:M("blockAction",{action:"strikethrough"})}}),v("mab.button.textFormatting.textSelectionColor.native","nativeAction_setMenuType",{content:{type:"icon",imageReference:m,disabled:t||c,selected:"textSelectionColor"===d,accessibilityText:g.textColor},apiRequestValue:{menuType:"textSelectionColor"}}),v("mab.button.textFormatting.comment","webAction_generic",{content:{type:"icon",imageReference:{sfProGlyphName:"bubble.left",localImageIdentifier:"comment"},disabled:t||h,accessibilityText:g.comment},apiRequestValue:{jsonPayload:M("blockAction",{action:"comment"})}}),v("mab.button.link","webAction_generic",{content:{type:"icon",imageReference:{sfProGlyphName:"link",localImageIdentifier:"link"},accessibilityText:g.link,disabled:t||p,selected:a},apiRequestValue:{jsonPayload:M("blockAction",{action:"link"})}}),v("mab.button.code","webAction_generic",{content:{type:"icon",imageReference:{sfProGlyphName:"chevron.left.slash.chevron.right",localImageIdentifier:"code"},accessibilityText:g.code,disabled:t,selected:r},apiRequestValue:{jsonPayload:M("blockAction",{action:"code"})}}),v("mab.button.equation","webAction_generic",{content:{type:"icon",imageReference:{sfProGlyphName:"x.squareroot",localImageIdentifier:"equation"},accessibilityText:g.equation,disabled:t||u,selected:l},apiRequestValue:{jsonPayload:M("blockAction",{action:"equation"})}}),v("mab.button.cancel","nativeAction_setSubMenuType",{content:{type:"icon",imageReference:{sfProGlyphName:"xmark.circle.fill",localImageIdentifier:"cancel",imageTintColor:"#72706B64"},accessibilityText:g.close},apiRequestValue:{subMenuType:null}})]}}var L=i(17215),U=i(44886),O=i(60165),H=i(89086),F=i(70203),E=i(24677),D=i(98104),N=i(8848),V=i(34277),W=i(33929),q=i(95477),z=i(68204),G=i(47853),K=i(25666);function j(e){const{type:t,actionSections:i,closeParentMenu:o,context:n}=e,s={},r=[];for(const a of i){const e={id:"".concat(a.key),title:a.title,items:a.actions.map((e=>{const i="".concat(e.key,"-").concat(e.displayName||""),r=e.nativeRender&&e.nativeRender(n),a=null!=r&&r.thumbnail?(0,G.D)(null==r?void 0:r.thumbnail):K.T;return s[i]={...e,thumbnail:a,closeParentMenu:o},{id:i,title:e.displayName||"",icon:{...r,remoteImageUrl:a?"".concat(q.Z.domainBaseUrl).concat(a):void 0,localAssetBundleImagePath:a},action:f("webAction_genericAction",{menuType:t,actionId:i}),checked:!1}}))};r.push(e)}return{actions:s,sections:r}}function Y(e){const{key:t,displayName:i,thumbnail:o,analyticsName:n,closeParentMenu:s,action:r}=e,a=i?W.Z.formatMessage(i):void 0,l=i,d=l?"".concat(W.Z.formatMessage(l)," ").concat(l.defaultMessage):void 0;return{key:"action ".concat(t),displayName:a,thumbnail:o,analyticsName:n||"textformatting_action_".concat(t),searchName:d,validators:[],action:r,closeParentMenu:Boolean(s)}}const Q={bold:Y({key:"bold",closeParentMenu:!1,action:({environment:e})=>{A.pk(e,["b"])}}),italic:Y({key:"italic",closeParentMenu:!1,action:({environment:e})=>{A.pk(e,["i"])}}),underline:Y({key:"underline",closeParentMenu:!1,action:({environment:e})=>{A.pk(e,["_"])}}),strikethrough:Y({key:"strikethrough",closeParentMenu:!1,action:({environment:e})=>{A.pk(e,["s"])}}),code:Y({key:"code",closeParentMenu:!1,action:({environment:e})=>{A.pk(e,["c"])}}),comment:Y({key:"comment",closeParentMenu:!0,action:async({environment:e})=>{var t;await(null===(t=e.NativeMobileActionBarStore)||void 0===t?void 0:t.clearNativeActionMenuAndRestoreSelectionIfNecessary()),A.ol(e,!0)}}),equation:Y({key:"equation",closeParentMenu:!0,action:async({environment:e})=>{var t;await(null===(t=e.NativeMobileActionBarStore)||void 0===t?void 0:t.clearNativeActionMenuAndRestoreSelectionIfNecessary()),A._W(e)}}),filePicker:Y({key:"filePicker",closeParentMenu:!0,action:async({environment:e})=>{var t;await(null===(t=e.NativeMobileActionBarStore)||void 0===t?void 0:t.clearNativeActionMenuAndRestoreSelectionIfNecessary()),A.vs(e)}}),indent:Y({key:"indent",closeParentMenu:!1,action:({environment:e})=>{A.O2(e)}}),unindent:Y({key:"unindent",closeParentMenu:!1,action:({environment:e})=>{A.$$(e)}}),moveDown:Y({key:"moveDown",closeParentMenu:!1,action:({environment:e})=>{A.rZ(e)}}),moveUp:Y({key:"moveUp",closeParentMenu:!1,action:({environment:e})=>{A.s0(e)}}),undo:Y({key:"undo",closeParentMenu:!1,action:({environment:e})=>{A.i2(e)}}),redo:Y({key:"redo",closeParentMenu:!1,action:({environment:e})=>{A.GH(e)}}),trash:Y({key:"trash",closeParentMenu:!1,action:({environment:e})=>{A.fn(e)}}),mention:Y({key:"mention",closeParentMenu:!0,action:async({environment:e})=>{var t;await(null===(t=e.NativeMobileActionBarStore)||void 0===t?void 0:t.clearNativeActionMenuAndRestoreSelectionIfNecessary()),A.Z3(e)}}),link:Y({key:"link",closeParentMenu:!0,action:async({environment:e})=>{var t;await(null===(t=e.NativeMobileActionBarStore)||void 0===t?void 0:t.clearNativeActionMenuAndRestoreSelectionIfNecessary()),A.UF(e)}}),more:Y({key:"more",closeParentMenu:!1,action:({environment:e})=>{A.w1(e,void 0,void 0)}}),dismissKeyboard:Y({key:"dismissKeyboard",closeParentMenu:!0,action:({environment:e})=>{}})};var X=i(27832),J=i(24666),$=i(68056),ee=i(45162),te=i(71802),ie=i(8713);const oe=(0,m.vU)({templatesButtonTitle:{defaultMessage:"Choose a template...",id:"mobileActionBar.templateButtonTitle"},actionMenuInsertBlockTitle:{defaultMessage:"Insert Block",id:"mobileActionBar.actionMenuTitle.insertBlock"},actionMenuTurnIntoTitle:{defaultMessage:"Turn Into",id:"mobileActionBar.actionMenuTitle.turnInto"},actionMenuColorTitle:{defaultMessage:"Color",id:"mobileActionBar.actionMenuTitle.blockColor"},accessibilityInsert:{defaultMessage:"Add block",id:"mobileActionBar.accessibility.insertBlock",description:"Accessibility text, this will be read aloud by the screen reader"},accessibilityTurnInto:{defaultMessage:"Turn into block",id:"mobileActionBar.accessibility.turnInto",description:"Accessibility text, this will be read aloud by the screen reader"},accessibilityFilePicker:{defaultMessage:"Add image",id:"mobileActionBar.accessibility.filePicker",description:"Accessibility text, this will be read aloud by the screen reader"},accessibilityMention:{defaultMessage:"Add mention",id:"mobileActionBar.accessibility.mention",description:"Accessibility text, this will be read aloud by the screen reader"},accessibilityBlockColor:{defaultMessage:"Change block color",id:"mobileActionBar.accessibility.blockColor",description:"Accessibility text, this will be read aloud by the screen reader"},accessibilityTextFormatting:{defaultMessage:"Open text formatting menu",id:"mobileActionBar.accessibility.textFormatting",description:"Accessibility text, this will be read aloud by the screen reader"},accessibilityComment:{defaultMessage:"Add comment",id:"mobileActionBar.accessibility.comment",description:"Accessibility text, this will be read aloud by the screen reader"},accessibilityTrash:{defaultMessage:"Delete block",id:"mobileActionBar.accessibility.trash",description:"Accessibility text, this will be read aloud by the screen reader"},accessibilityIndent:{defaultMessage:"Indent block",id:"mobileActionBar.accessibility.indent",description:"Accessibility text, this will be read aloud by the screen reader"},accessibilityDedent:{defaultMessage:"Unindent block",id:"mobileActionBar.accessibility.unindent",description:"Accessibility text, this will be read aloud by the screen reader"},accessibilityMoveUp:{defaultMessage:"Move a block up",id:"mobileActionBar.accessibility.moveUp",description:"Accessibility text, this will be read aloud by the screen reader"},accessibilityMoveDown:{defaultMessage:"Move a block down",id:"mobileActionBar.accessibility.moveDown",description:"Accessibility text, this will be read aloud by the screen reader"},accessibilityUndo:{defaultMessage:"Undo edit",id:"mobileActionBar.accessibility.udno",description:"Accessibility text, this will be read aloud by the screen reader"},accessibilityRedo:{defaultMessage:"Redo edit",id:"mobileActionBar.accessibility.redo",description:"Accessibility text, this will be read aloud by the screen reader"},accessibilityMore:{defaultMessage:"More block actions",id:"mobileActionBar.accessibility.more",description:"Accessibility text, this will be read aloud by the screen reader"},accessibilityBold:{defaultMessage:"Bold",id:"mobileActionBar.accessibility.bold",description:"Accessibility text, this will be read aloud by the screen reader"},accessibilityItalics:{defaultMessage:"Italicize",id:"mobileActionBar.accessibility.italics",description:"Accessibility text, this will be read aloud by the screen reader"},accessibilityUnderline:{defaultMessage:"Underline",id:"mobileActionBar.accessibility.underline",description:"Accessibility text, this will be read aloud by the screen reader"},accessibilityStrikethrough:{defaultMessage:"Strikethrough",id:"mobileActionBar.accessibility.strikethrough",description:"Accessibility text, this will be read aloud by the screen reader"},accessibilityTextColor:{defaultMessage:"Text color",id:"mobileActionBar.accessibility.textColor",description:"Accessibility text, this will be read aloud by the screen reader"},accessibilityCode:{defaultMessage:"Code",id:"mobileActionBar.accessibility.code",description:"Accessibility text, this will be read aloud by the screen reader"},accessibilityLink:{defaultMessage:"Add link",id:"mobileActionBar.accessibility.link",description:"Accessibility text, this will be read aloud by the screen reader"},accessibilityEquation:{defaultMessage:"Add equation",id:"mobileActionBar.accessibility.equation",description:"Accessibility text, this will be read aloud by the screen reader"},accessibilityCloseTextFormattingMenu:{defaultMessage:"Close text formatting menu",id:"mobileActionBar.accessibility.close",description:"Accessibility text, this will be read aloud by the screen reader"},accessibilityDismissKeyboard:{defaultMessage:"End editing",id:"mobileActionBar.accessibility.endEditing",description:"Accessibility text, this will be read aloud by the screen reader"},accessibilityCloseActionMenu:{defaultMessage:"Close menu",id:"mobileActionBar.accessibility.closeMenu",description:"Accessibility text, this will be read aloud by the screen reader"}}),ne={text:!1,to_do:!0,bulleted_list:!0,numbered_list:!0,toggle:!0,column:!1,transclusion_container:!1,callout:!1,quote:!1};function se(e){var t;const{onAction:i,fallbackRenderer:o,...n}=e,s=p(null===(t=(0,a.O7)().mobileNative)||void 0===t?void 0:t.api.renderMobileActionBar,n);return function(e,t,i,o){var n;const s=null===(n=(0,a.O7)().mobileNative)||void 0===n?void 0:n.componentEvents;(0,c.useEffect)((()=>{if(s&&o&&t)return s.addListener(e,t,i,o)}),[e,t,i,o,s])}("MobileActionBar",s,"onAction",i),!s&&o?h().createElement(h().Fragment,null,o()):null}class re extends u.Z{constructor(...e){super(...e),r()(this,"handleTextSelectionCompositeStoreChanged",(()=>{if(!this.textSelectionCompositeStore.state)return;const{source:e}=this.textSelectionCompositeStore.state,{NativeMobileActionBarStore:t,device:i}=this.environment;"TextSelectionStore"!==e||null===(null==t?void 0:t.state.menuType)||i.isTablet||this.setCurrentMenuType(null,!0)})),r()(this,"handleTextSelectionStoreChanged",(()=>{if(!this.textSelectionPositionsStore.state)return;const{NativeMobileActionBarStore:e}=this.environment;e&&null===e.state.subMenuType&&e.state.isSubMenuOverridden&&this.setCurrentSubMenuType(null,!1)})),r()(this,"getCurrentActionBarSchema",this.createComputedStore((()=>{const{NativeMobileActionBarStore:e}=this.environment,t=Boolean(this.renderStore.state.disableAnnotation),i=e?e.state.menuType:null;var o=null;const n=A.Tz({environment:this.environment,store:this.props.currentBlockStore}),s=!!e&&e.state.isSubMenuOverridden,r=this.shouldShowTextActions.state,a=e?e.state.subMenuType:null;s?o=a:r&&!t&&(o="textFormatting",null==e||e.update((e=>({...e,isSubMenuOverridden:!1,subMenuType:null}))));const l="editing"===J.Z.state.mode&&J.Z.state.multiSelection,d=this.props.stores.ignoreSelectionAreaStore.state.savedTextSelectionStoreState,c=d&&"editing"===d.mode&&d.multiSelection,h=l||c,p=Boolean(h&&(0,$.qS)(h)),u=!this.canTriggerTextActions.state,m=!this.canTriggerBlockActions.state,g=this.props.currentBlockStore.getValue(),b=this.commentActionDisabled(g)||Boolean(this.renderStore.state.disableComment),y=!p,S=!p||this.mentionActionDisabled(g),f=!p,Z=R.Z.state.stores,k=!Z.every(U.nt),T=!Z.every(U.gq),w=!O.L0(),L=!O.AZ(),H=(0,te.JE)(),F=this.memoizedNativeMenus({environment:this.environment,blocks:R.Z.state.stores}),E=C(F.textColor.sections);var D,N,V;if(n)D=[(V=W.Z.formatMessage(oe.templatesButtonTitle),{id:"mab.buttonSection.template",buttons:[v("mab.button.choose_template","webAction_generic",{content:{type:"text_and_icon",imageReference:{localImageIdentifier:"template"},text:V},apiRequestValue:{jsonPayload:M("showActionBarMenu",{actionBarMenuId:"template"})}})]})];else{var q;const e={main:I({disableBlockActions:m,disableCommentAction:b,disableMentionAction:S,selectedMenuType:i,disableInsertBlockAction:C(F.insertBlock.sections),disableTurnIntoAction:C(F.turnInto.sections),disableTextFormatting:t,disableDeleteBlock:H,accessibilityTexts:{insert:W.Z.formatMessage(oe.accessibilityInsert),turnInto:W.Z.formatMessage(oe.accessibilityTurnInto),filePicker:W.Z.formatMessage(oe.accessibilityFilePicker),mention:W.Z.formatMessage(oe.accessibilityMention),comment:W.Z.formatMessage(oe.accessibilityComment),textFormatting:W.Z.formatMessage(oe.accessibilityTextFormatting),trash:W.Z.formatMessage(oe.accessibilityTrash)}}),listPrioritized:x({id:"mab.list.prioritized",disableBlockActions:m,disableIndent:k,disableUnindent:T,shouldFadeIn:!1,includeUpAndDown:!1,accessibilityTexts:{indent:W.Z.formatMessage(oe.accessibilityIndent),dedent:W.Z.formatMessage(oe.accessibilityDedent),moveUp:W.Z.formatMessage(oe.accessibilityMoveUp),moveDown:W.Z.formatMessage(oe.accessibilityMoveDown)}}),listDeprioritized:x({id:"mab.list.deprioritized",disableBlockActions:m,disableIndent:k,disableUnindent:T,shouldFadeIn:!0,includeUpAndDown:!0,accessibilityTexts:{indent:W.Z.formatMessage(oe.accessibilityIndent),dedent:W.Z.formatMessage(oe.accessibilityDedent),moveUp:W.Z.formatMessage(oe.accessibilityMoveUp),moveDown:W.Z.formatMessage(oe.accessibilityMoveDown)}}),block:P({disableUndo:w,disableRedo:L,textColorImageReference:this.textColorImageReference(),disableTextActions:u,disableTextColorAction:E,selectedMenuType:i,accessibilityTexts:{undo:W.Z.formatMessage(oe.accessibilityUndo),redo:W.Z.formatMessage(oe.accessibilityRedo),blockColor:W.Z.formatMessage(oe.accessibilityBlockColor),more:W.Z.formatMessage(oe.accessibilityMore)}}),moveUpAndDown:(N={disableBlockActions:m,accessibilityTexts:{moveUp:W.Z.formatMessage(oe.accessibilityMoveUp),moveDown:W.Z.formatMessage(oe.accessibilityMoveDown)}},{id:"mab.buttonSection.last",shouldFadeIn:!0,buttons:B(N)})},o=h&&(null===(q=(0,ee.tp)({multiSelection:h,focus:void 0,filterCommonAncestors:!1}))||void 0===q?void 0:q.stores),n=o&&o.some((e=>{const t=e.getType();return t&&ne[t]}));D=e.listPrioritized&&n?[e.listPrioritized,e.main,e.block,e.moveUpAndDown]:e.listDeprioritized&&o&&o.every((e=>U.nt(e)||U.gq(e)))?[e.main,e.block,e.listDeprioritized]:H?[e.main,e.block]:[e.main,e.block,e.moveUpAndDown]}const z=[_({disableTextActions:u,disableCommentAction:b,disableLinkAction:y,disableEquationAction:f,selectedMenuType:i,disableTextColorAction:E,textColorImageReference:this.textSelectionColorImageReference(),accessibilityTexts:{bold:W.Z.formatMessage(oe.accessibilityBold),italics:W.Z.formatMessage(oe.accessibilityItalics),underline:W.Z.formatMessage(oe.accessibilityUnderline),strikethrough:W.Z.formatMessage(oe.accessibilityStrikethrough),textColor:W.Z.formatMessage(oe.accessibilityTextColor),comment:W.Z.formatMessage(oe.accessibilityComment),code:W.Z.formatMessage(oe.accessibilityCode),link:W.Z.formatMessage(oe.accessibilityLink),equation:W.Z.formatMessage(oe.accessibilityEquation),close:W.Z.formatMessage(oe.accessibilityCloseTextFormattingMenu)},...this.getTextFormattingSelections()})];return function(e){const{selectedMenu:t,selectedSubMenu:i,nativeMenus:o,buttonSections:n,nativeSubMenus:s,accessibilityTexts:r}=e;return{nativeMenus:o,nativeSubMenus:s,state:{buttonSections:n,selectedMenu:t,selectedSubMenu:i,dismissKeyboardButton:null!==t?v("mab.dismissKeyboard","nativeAction_setMenuType",{content:{type:"icon",imageReference:{sfProGlyphName:"xmark.circle.fill",localImageIdentifier:"cancel",imageTintColor:"#72706B64"},accessibilityText:r.closeActionMenu},apiRequestValue:{menuType:null}}):v("mab.dismissKeyboard","webAction_generic",{content:{type:"icon",imageReference:{sfProGlyphName:"keyboard.chevron.compact.down",localImageIdentifier:"keyboardDown"},accessibilityText:r.dismissKeyboard},apiRequestValue:{jsonPayload:M("blockAction",{action:"dismissKeyboard"})}}),mutatedNativeMenus:{},localizedMessages:{}}}}({selectedMenu:i,selectedSubMenu:o,nativeMenus:{textColor:{id:"textColor",title:W.Z.formatMessage(oe.actionMenuColorTitle),sections:F.textColor.sections},textSelectionColor:{id:"textSelectionColor",title:W.Z.formatMessage(oe.actionMenuColorTitle),sections:F.textSelectionColor.sections},insertBlock:{id:"insertBlock",title:W.Z.formatMessage(oe.actionMenuInsertBlockTitle),sections:F.insertBlock.sections},turnInto:{id:"turnInto",title:W.Z.formatMessage(oe.actionMenuTurnIntoTitle),sections:F.turnInto.sections}},nativeSubMenus:{textFormatting:z},buttonSections:D,accessibilityTexts:{dismissKeyboard:W.Z.formatMessage(oe.accessibilityDismissKeyboard),closeActionMenu:W.Z.formatMessage(oe.accessibilityCloseActionMenu)}})}))),r()(this,"textSelectionPositionsStore",this.createComputedStore((()=>{const e=this.textSelectionCompositeStore.state;if(!e)return;const{source:t,...i}=e;return i}),!0)),r()(this,"textSelectionCompositeStore",this.createComputedStore((()=>{const e=(e,t)=>{if(!e||"editing"!==e.mode)return;const{multiSelection:i}=e;return{startRecord:i.start.store.pointer,startIndex:i.start.index,endRecord:i.end.store.pointer,endIndex:i.end.index,source:t}};return e(J.Z.state,"TextSelectionStore")||e(this.props.stores.ignoreSelectionAreaStore.state.savedTextSelectionStoreState,"IgnoreSelectionAreaStore")}),!0)),r()(this,"renderStore",this.createComputedStore((()=>{var e;const t=A.$3(this.environment,this.props.currentBlockStore,null===(e=this.pageContext)||void 0===e?void 0:e.publicEditModeStore.state);if(!t){const e=this.environment.NativeMobileActionBarStore;null!==(null==e?void 0:e.state.menuType)&&d().delay((()=>{var e;A.$3(this.environment,this.props.currentBlockStore,null===(e=this.pageContext)||void 0===e?void 0:e.publicEditModeStore.state)||this.setCurrentMenuType(null,!1)}),500),null!==(null==e?void 0:e.state.subMenuType)&&d().delay((()=>{var e;A.$3(this.environment,this.props.currentBlockStore,null===(e=this.pageContext)||void 0===e?void 0:e.publicEditModeStore.state)||this.setCurrentSubMenuType(null,!1)}),500)}return t}))),r()(this,"shouldShowTextActions",this.createComputedStore((()=>A.oQ(this.props.stores.ignoreSelectionAreaStore,this.environment.TextSelectionCompositionStore)))),r()(this,"canTriggerBlockActions",this.createComputedStore((()=>A.Bo(this.pageContext&&this.pageContext.publicEditModeStore.state)))),r()(this,"canTriggerTextActions",this.createComputedStore((()=>A.eQ(this.pageContext&&this.pageContext.publicEditModeStore.state,this.props.currentBlockStore)))),r()(this,"memoizedNativeMenus",d().memoize((e=>{const{blocks:t,environment:i}=e;return o={environment:i,blocks:t,publicEditMode:void 0},{insertBlock:j({type:"insertBlock",actionSections:z.L1(V.kR,o),context:o,closeParentMenu:!0}),turnInto:j({type:"turnInto",actionSections:z.L1([V.gH],o),context:o,closeParentMenu:!0}),textColor:j({type:"textColor",actionSections:z.L1([V.rz,V.Vm],o),context:o,closeParentMenu:!1}),textSelectionColor:j({type:"textSelectionColor",actionSections:z.L1([V.b4,V.Sw],o),context:o,closeParentMenu:!1})};var o})))}didMount(){this.textSelectionCompositeStore.addListener(this.handleTextSelectionCompositeStoreChanged),this.textSelectionPositionsStore.addListener(this.handleTextSelectionStoreChanged)}willUnmount(){this.textSelectionCompositeStore.removeListener(this.handleTextSelectionCompositeStoreChanged),this.textSelectionPositionsStore.removeListener(this.handleTextSelectionStoreChanged),this.props.renderApi&&this.props.renderApi({type:"unmount",id:""})}renderComponent(){return n()(se,{isOpen:this.renderStore.state.shouldShow,canShow:this.renderStore.state.canShowNativeBar,schema:this.getCurrentActionBarSchema.state,onAction:e=>{const{action:t}=e;switch(t.type){case"nativeAction_hideKeyboard":break;case"nativeAction_setMenuType":this.handleSetMenuTypeAction(t);break;case"nativeAction_setSubMenuType":this.handleSetSubMenuTypeAction(t);break;case"webAction_generic":this.handleGenericWebAction(t);break;case"webAction_genericAction":this.handleActionRegistryAction(t)}},fallbackRenderer:this.props.fallbackRenderer})}commentActionDisabled(e){return!(!e||!(0,L._T)(e))}mentionActionDisabled(e){return!(!e||!(0,L.lQ)(e))}handleSetMenuTypeAction(e){const t=function(e){if("nativeAction_setMenuType"!==e.type)return new w(T.InvalidActionType,void 0);const t=e.apiRequestValue;if(!t||!("menuType"in t))return new w(T.MissingPayload,void 0);const i=g.Ry({required:{menuType:g.eR(...y,null)},optional:{}}),o=(0,b.Gu)(i,t);return o?new w(T.InvalidRequestType,JSON.stringify(o)):t.menuType}(e);if(t instanceof w)return void console.error(JSON.stringify(t));if((this.environment.NativeMobileActionBarStore?this.environment.NativeMobileActionBarStore.state.menuType:null)===t)this.setCurrentMenuType(null,!0);else switch(this.setCurrentMenuType(t,!0),t){case"insertBlock":A.Oh(this.environment,"insert");break;case"turnInto":A.Oh(this.environment,"turn_into");break;case"textColor":case"textSelectionColor":A.Oh(this.environment,"color")}}handleSetSubMenuTypeAction(e){const t=function(e){if("nativeAction_setSubMenuType"!==e.type)return new w(T.InvalidActionType,void 0);const t=e.apiRequestValue;if(!t||!("subMenuType"in t))return new w(T.MissingPayload,void 0);const i=g.Ry({required:{subMenuType:g.eR(...S,null)},optional:{}}),o=(0,b.Gu)(i,t);return o?new w(T.InvalidRequestType,JSON.stringify(o)):t.subMenuType}(e);t instanceof w?console.error(JSON.stringify(t)):this.setCurrentSubMenuType(t,!0)}handleGenericWebAction(e){const t=function(e){if("webAction_generic"!==e.type)return new w(T.InvalidActionType,void 0);const t=e.apiRequestValue;if(!t||!("jsonPayload"in t))return new w(T.MissingPayload,void 0);const i=JSON.parse(t.jsonPayload),o=g.Ry({required:{type:g.eR(...k)},optional:{}}),n=(0,b.Gu)(o,i);if(n)return new w(T.InvalidRequestType,JSON.stringify(n));const s=i,r=Z[s.type],a=(0,b.Gu)(r,s);return a?new w(T.InvalidData,JSON.stringify(a)):s}(e);if(t instanceof w)console.error(JSON.stringify(t));else switch(t.type){case"blockAction":if("dismissKeyboard"===t.data.action){this.handleDismissKeyboard();break}const e=Q[t.data.action];if(!e)break;const i=e.action;if(i){const{currentBlockStore:t}=X.Z.state;if(!t)break;const{device:o}=this.environment;e.closeParentMenu&&!o.isTablet&&this.setCurrentMenuType(null,!0),i({environment:this.environment,blocks:[t],publicEditMode:void 0})}break;case"showActionBarMenu":switch(t.data.actionBarMenuId){case"insertBlock":this.handleInsert();break;case"textColor":this.handleTextColor();break;case"turnInto":this.handleTurnInto();break;case"template":this.handleTemplate()}}}handleActionRegistryAction(e){var t,i;const o=null===(t=e.apiRequestValue)||void 0===t?void 0:t.menuType,n=null===(i=e.apiRequestValue)||void 0===i?void 0:i.actionId;if(!o||!n)return;const s=this.memoizedNativeMenus({environment:this.environment,blocks:R.Z.state.stores})[o].actions[n];if(!s)return;const r=s.action;r&&(s.closeParentMenu&&this.setCurrentMenuType(null,!0),r({environment:this.environment,blocks:R.Z.state.stores,publicEditMode:void 0}))}handleDismissKeyboard(){E.ZH(this.environment),ie.MO(),this.props.stores.store.update((e=>({...e,isInsertOpen:!1}))),this.setCurrentMenuType(null,!1),this.setCurrentSubMenuType(null,!1),A.Oh(this.environment,"hide_keyboard"),D.sD()}getTextFormattingSelections(){return{boldSelected:Boolean((0,H.Ld)(F.GK.Bold)),italicSelected:Boolean((0,H.Ld)(F.GK.Italic)),underlineSelected:Boolean((0,H.Ld)(F.GK.Underline)),strikeSelected:Boolean((0,H.Ld)(F.GK.Strike)),codeSelected:Boolean((0,H.Ld)(F.GK.Code)),linkSelected:Boolean((0,H.Ld)(F.GK.Link)),equationSelected:Boolean((0,H.Ld)(F.GK.Equation))}}imageReferenceForBlockColor(e){let t="textColor";const i=N.E_.find((t=>t===e));let o;"default"===e||i&&(i.includes("background")?(o="background",t="textBackgroundColor"):o="color");const n=o&&i?(0,N.fi)(i,this.theme)[o]:void 0;return{localImageIdentifier:t,imageTintColor:n?(0,N.J1)(n):void 0}}textSelectionColorImageReference(){const{NativeMobileActionBarStore:e}=this.environment,t=e&&null!==e.state.menuType?this.props.stores.ignoreSelectionAreaStore.state.savedTextSelectionStoreState:void 0,i=(0,H.a6)("h",t||J.Z.state),o=i?(0,F.zI)(i):void 0;return this.imageReferenceForBlockColor(o)}textColorImageReference(){const e=R.Z.state.stores.length>0?R.Z.state.stores[0].getFormat().block_color:void 0;return this.imageReferenceForBlockColor(e)}handleInsert(){this.props.stores.store.update((e=>({...e,isInsertOpen:!0}))),A.Oh(this.environment,"insert")}handleTurnInto(){this.props.stores.store.update((e=>({...e,isTurnIntoOpen:!0}))),A.Oh(this.environment,"turn_into")}handleTemplate(){this.props.stores.store.update((e=>({...e,isTemplatesOpen:!0}))),A.Oh(this.environment,"templates")}handleTextColor(){this.props.stores.store.update((e=>({...e,isColorOpen:!0}))),A.Oh(this.environment,"color")}setCurrentMenuType(e,t){var i;null===(i=this.environment.NativeMobileActionBarStore)||void 0===i||i.update((i=>({...i,menuType:e,shouldRestoreSelectionForMenu:t})))}setCurrentSubMenuType(e,t){const{NativeMobileActionBarStore:i}=this.environment;null==i||i.update((i=>({...i,isSubMenuOverridden:t,subMenuType:e})))}}const ae=(0,m.XN)(re)},72653:(e,t,i)=>{i.d(t,{Z:()=>a});var o=i(59488),n=i(49164),s=i(69454),r=i(55320);const a=new n.Z((()=>{const{phase:e}=s.Z.state;if(r.Z.state.open)return!0;return(0,o.de)()&&!s.Z.state.shouldResizeWebView||e===s.i.hidden||e===s.i.willHide}))}}]);